<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.apih5.mybatis.dao.ZjTzInvXmtzqkMapper" >
  <resultMap id="BaseResultMap" type="com.apih5.mybatis.pojo.ZjTzInvXmtzqk" >
    <id column="id" property="id" jdbcType="CHAR" />
    <result column="inv_pro_id" property="invProId" jdbcType="CHAR" />
    <result column="ztze" property="ztze" jdbcType="DECIMAL" />
    <result column="zjaf" property="zjaf" jdbcType="DECIMAL" />
    <result column="zzcf" property="zzcf" jdbcType="DECIMAL" />
    <result column="tzwcbq" property="tzwcbq" jdbcType="DECIMAL" />
    <result column="tzwcbn" property="tzwcbn" jdbcType="DECIMAL" />
    <result column="tzwckl" property="tzwckl" jdbcType="DECIMAL" />
    <result column="tzwcbl" property="tzwcbl" jdbcType="DECIMAL" />
    <result column="wcjafbq" property="wcjafbq" jdbcType="DECIMAL" />
    <result column="wcjafbn" property="wcjafbn" jdbcType="DECIMAL" />
    <result column="wcjafkl" property="wcjafkl" jdbcType="DECIMAL" />
    <result column="wcjafbl" property="wcjafbl" jdbcType="DECIMAL" />
    <result column="zcjafbq" property="zcjafbq" jdbcType="DECIMAL" />
    <result column="zcjafbn" property="zcjafbn" jdbcType="DECIMAL" />
    <result column="zcjafkl" property="zcjafkl" jdbcType="DECIMAL" />
    <result column="zcjafbl" property="zcjafbl" jdbcType="DECIMAL" />
    <result column="wczcfbq" property="wczcfbq" jdbcType="DECIMAL" />
    <result column="wczcfbn" property="wczcfbn" jdbcType="DECIMAL" />
    <result column="wczcfkl" property="wczcfkl" jdbcType="DECIMAL" />
    <result column="wczcfbl" property="wczcfbl" jdbcType="DECIMAL" />
    <result column="zczcfbq" property="zczcfbq" jdbcType="DECIMAL" />
    <result column="zczcfbn" property="zczcfbn" jdbcType="DECIMAL" />
    <result column="zczcfkl" property="zczcfkl" jdbcType="DECIMAL" />
    <result column="zczcfbl" property="zczcfbl" jdbcType="DECIMAL" />
    <result column="period_type" property="periodType" jdbcType="VARCHAR" />
    <result column="period_value" property="periodValue" jdbcType="VARCHAR" />
    <result column="org" property="org" jdbcType="CHAR" />
    <result column="currency" property="currency" jdbcType="VARCHAR" />
    <result column="sort" property="sort" jdbcType="DECIMAL" />
    <result column="create_by" property="createBy" jdbcType="CHAR" />
    <result column="create_org" property="createOrg" jdbcType="CHAR" />
    <result column="create_date" property="createDate" jdbcType="TIMESTAMP" />
    <result column="update_by" property="updateBy" jdbcType="CHAR" />
    <result column="update_org" property="updateOrg" jdbcType="CHAR" />
    <result column="update_date" property="updateDate" jdbcType="TIMESTAMP" />
    <result column="remarks" property="remarks" jdbcType="VARCHAR" />
    <result column="del_flag" property="delFlag" jdbcType="CHAR" />
    <result column="ygjjtjaf" property="ygjjtjaf" jdbcType="DECIMAL" />
    <result column="xmztwcjlbq" property="xmztwcjlbq" jdbcType="DECIMAL" />
    <result column="xmztwcjlbn" property="xmztwcjlbn" jdbcType="DECIMAL" />
    <result column="xmztwcjlkl" property="xmztwcjlkl" jdbcType="DECIMAL" />
    <result column="xmztwcjlbl" property="xmztwcjlbl" jdbcType="DECIMAL" />
    <result column="ygjjtwcjafbq" property="ygjjtwcjafbq" jdbcType="DECIMAL" />
    <result column="ygjjtwcjafbn" property="ygjjtwcjafbn" jdbcType="DECIMAL" />
    <result column="ygjjtwcjafkl" property="ygjjtwcjafkl" jdbcType="DECIMAL" />
    <result column="ygjjtwcjafbl" property="ygjjtwcjafbl" jdbcType="DECIMAL" />
    <result column="ygjjtwcjlbq" property="ygjjtwcjlbq" jdbcType="DECIMAL" />
    <result column="ygjjtwcjlbn" property="ygjjtwcjlbn" jdbcType="DECIMAL" />
    <result column="ygjjtwcjlkl" property="ygjjtwcjlkl" jdbcType="DECIMAL" />
    <result column="ygjjtwcjlbl" property="ygjjtwcjlbl" jdbcType="DECIMAL" />
    <result column="ygjjtzcjafbq" property="ygjjtzcjafbq" jdbcType="DECIMAL" />
    <result column="ygjjtzcjafbn" property="ygjjtzcjafbn" jdbcType="DECIMAL" />
    <result column="ygjjtzcjafkl" property="ygjjtzcjafkl" jdbcType="DECIMAL" />
    <result column="ygjjtzcjafbl" property="ygjjtzcjafbl" jdbcType="DECIMAL" />
    <result column="bz" property="bz" jdbcType="VARCHAR" />
    <result column="yesOrNoJGC" property="yesOrNoJGC" jdbcType="VARCHAR" />
    <result column="wcjafbqJGC" property="wcjafbqJGC" jdbcType="DECIMAL" />
    <result column="wcjafbnJGC" property="wcjafbnJGC" jdbcType="DECIMAL" />
    <result column="wcjafklJGC" property="wcjafklJGC" jdbcType="DECIMAL" />
    <result column="wcjafblJGC" property="wcjafblJGC" jdbcType="DECIMAL" />
    <result column="xmztwcjlbqJGC" property="xmztwcjlbqJGC" jdbcType="DECIMAL" />
    <result column="xmztwcjlbnJGC" property="xmztwcjlbnJGC" jdbcType="DECIMAL" />
    <result column="xmztwcjlklJGC" property="xmztwcjlklJGC" jdbcType="DECIMAL" />
    <result column="xmztwcjlblJGC" property="xmztwcjlblJGC" jdbcType="DECIMAL" />
    <result column="zcjafbqJGC" property="zcjafbqJGC" jdbcType="DECIMAL" />
    <result column="zcjafbnJGC" property="zcjafbnJGC" jdbcType="DECIMAL" />
    <result column="zcjafklJGC" property="zcjafklJGC" jdbcType="DECIMAL" />
    <result column="zcjafblJGC" property="zcjafblJGC" jdbcType="DECIMAL" />
    <result column="ygjwcbqJGC" property="ygjwcbqJGC" jdbcType="DECIMAL" />
    <result column="ygjwcbnJGC" property="ygjwcbnJGC" jdbcType="DECIMAL" />
    <result column="ygjwcklJGC" property="ygjwcklJGC" jdbcType="DECIMAL" />
    <result column="ygjwcblJGC" property="ygjwcblJGC" jdbcType="DECIMAL" />
    <result column="ygjjlbqJGC" property="ygjjlbqJGC" jdbcType="DECIMAL" />
    <result column="ygjjlbnJGC" property="ygjjlbnJGC" jdbcType="DECIMAL" />
    <result column="ygjjlklJGC" property="ygjjlklJGC" jdbcType="DECIMAL" />
    <result column="ygjjlblJGC" property="ygjjlblJGC" jdbcType="DECIMAL" />
    <result column="qytzwcbq" property="qytzwcbq" jdbcType="DECIMAL" />
    <result column="qytzwcbn" property="qytzwcbn" jdbcType="DECIMAL" />
    <result column="qytzwckl" property="qytzwckl" jdbcType="DECIMAL" />
    <result column="qytzwcbl" property="qytzwcbl" jdbcType="DECIMAL" />
  	<result column="qytzwcbj" property="qytzwcbj" jdbcType="DECIMAL" />
  	<result column="pro_num" property="proNum" jdbcType="VARCHAR" />
    <result column="comname" property="comname" jdbcType="VARCHAR" />
    <result column="pro_name" property="proName" jdbcType="VARCHAR" />
    <result column="jaf_money" property="jafMoney" jdbcType="DECIMAL" />
    <result column="zcf_money" property="zcfMoney" jdbcType="DECIMAL" />
    <result column="ygjjaf" property="ygjjaf" jdbcType="DECIMAL" />
    <result column="ygjsgfe" property="ygjsgfe" jdbcType="DECIMAL" />
    <result column="pfname" property="pfname" jdbcType="VARCHAR" />
    <result column="category_name" property="categoryName" jdbcType="VARCHAR" />
    <result column="type_name" property="typeName" jdbcType="VARCHAR" />
    <result column="project_id" property="projectId" jdbcType="VARCHAR" />
    <result column="gqbl" property="gqbl" jdbcType="DECIMAL" />
    <result column="proId" property="proId" jdbcType="VARCHAR" />
    <result column="short_name" property="shortName" jdbcType="VARCHAR" />
    <result column="bnqytzbfb" property="bnqytzbfb" jdbcType="DECIMAL" />
    <result column="bnjjafbfb" property="bnjjafbfb" jdbcType="DECIMAL" />
    <result column="total1" property="total1" jdbcType="DECIMAL" />
    <result column="total2" property="total2" jdbcType="DECIMAL" />
    <result column="total3" property="total3" jdbcType="DECIMAL" />
    <result column="total4" property="total4" jdbcType="DECIMAL" />
    <result column="bjqytzbfb" property="bjqytzbfb" jdbcType="DECIMAL" />
    <result column="bjjjafbfb" property="bjjjafbfb" jdbcType="DECIMAL" />
  	<result column="jhwcqytzbn" property="jhwcqytzbn" jdbcType="DECIMAL" />
    <result column="jhwcjjafbn" property="jhwcjjafbn" jdbcType="DECIMAL" />
    <result column="jhwcztzbn" property="jhwcztzbn" jdbcType="DECIMAL" />
    <result column="jhwcjafbn" property="jhwcjafbn" jdbcType="DECIMAL" />
    <result column="jhwcqytzbj" property="jhwcqytzbj" jdbcType="DECIMAL" />
    <result column="jhwcjjafbj" property="jhwcjjafbj" jdbcType="DECIMAL" />
    <result column="jhwcztzbj" property="jhwcztzbj" jdbcType="DECIMAL" />
    <result column="jhwcjafbj" property="jhwcjafbj" jdbcType="DECIMAL" />
    <result column="bnztzbfb" property="bnztzbfb" jdbcType="DECIMAL" />
    <result column="count" property="count" jdbcType="DECIMAL" />
    <result column="xmzht" property="xmzht" jdbcType="DECIMAL" />
    <result column="xmzja" property="xmzja" jdbcType="DECIMAL" />
    <result column="zht" property="zht" jdbcType="DECIMAL" />
    <result column="zja" property="zja" jdbcType="DECIMAL" />
    <result column="ztzwcbn" property="ztzwcbn" jdbcType="DECIMAL" />
    <result column="tzwcbhl" property="tzwcbhl" jdbcType="DECIMAL" />
    <result column="zwcjafbn" property="zwcjafbn" jdbcType="DECIMAL" />
    <result column="wcjafbhl" property="wcjafbhl" jdbcType="DECIMAL" />
    <result column="wtzwckl" property="wtzwckl" jdbcType="DECIMAL" />
    <result column="wwcjafkl" property="wwcjafkl" jdbcType="DECIMAL" />
    <result column="wtzwcbn" property="wtzwcbn" jdbcType="DECIMAL" />
    <result column="wwcjafbn" property="wwcjafbn" jdbcType="DECIMAL" />
    <result column="wtzwcbj" property="wtzwcbj" jdbcType="DECIMAL" />
    <result column="wwcjafbj" property="wwcjafbj" jdbcType="DECIMAL" />
    <result column="amount1" property="amount1" jdbcType="DECIMAL" />
    <result column="amount3" property="amount3" jdbcType="DECIMAL" />
    <result column="n" property="n" jdbcType="VARCHAR" />
    <result column="jidu" property="jidu" jdbcType="VARCHAR" />
    <result column="area_name" property="areaName" jdbcType="VARCHAR" />
    <result column="sjqytzbfb" property="sjqytzbfb" jdbcType="DECIMAL" />
    <result column="sjjjafbfb" property="sjjjafbfb" jdbcType="DECIMAL" />
    <result column="bnjhwcztz" property="bnjhwcztz" jdbcType="DECIMAL" />
    <result column="bnjhwcjaf" property="bnjhwcjaf" jdbcType="DECIMAL" />
    <result column="bnamount1" property="bnamount1" jdbcType="DECIMAL" />
    <result column="klamount1" property="klamount1" jdbcType="DECIMAL" />
    <result column="bnamount2" property="bnamount2" jdbcType="DECIMAL" />
    <result column="klamount2" property="klamount2" jdbcType="DECIMAL" />
    <result column="tbamount" property="tbamount" jdbcType="DECIMAL" />
    <result column="tbqyamount" property="tbqyamount" jdbcType="DECIMAL" />
    <result column="tbtzwc" property="tbtzwc" jdbcType="DECIMAL" />
    <result column="tbqytzwc" property="tbqytzwc" jdbcType="DECIMAL" />
    <result column="invCount" property="invCount" jdbcType="DECIMAL" />
    <result column="dataType" property="dataType" jdbcType="VARCHAR" />
    <result column="sjztzbfb" property="sjztzbfb" jdbcType="DECIMAL" />
    <result column="sjjafbfb" property="sjjafbfb" jdbcType="DECIMAL" />
    <result column="snztzbfb" property="snztzbfb" jdbcType="DECIMAL" />
    <result column="bnjhwcqytz" property="bnjhwcqytz" jdbcType="DECIMAL" />
    <result column="ygjbnjhwcja" property="ygjbnjhwcja" jdbcType="DECIMAL" />
    <result column="bjqytzpm" property="bjqytzpm" jdbcType="INTEGER" />
    <result column="sjqytzpm" property="sjqytzpm" jdbcType="INTEGER" />
    <result column="bjjjafpm" property="bjjjafpm" jdbcType="INTEGER" />
    <result column="sjjjafpm" property="sjjjafpm" jdbcType="INTEGER" />
    <result column="pmztz" property="pmztz" jdbcType="INTEGER" />
  </resultMap>
  <sql id="Base_Column_List" >
    id, inv_pro_id, ztze, zjaf, zzcf, 
    tzwcbq, tzwcbn, tzwckl, tzwcbl, wcjafbq, 
    wcjafbn, wcjafkl, wcjafbl, zcjafbq, zcjafbn, 
    zcjafkl, zcjafbl, wczcfbq, wczcfbn, wczcfkl, 
    wczcfbl, zczcfbq, zczcfbn, zczcfkl, zczcfbl, 
    period_type, period_value, org, currency, sort, 
    create_by, create_org, create_date, update_by, update_org, 
    update_date, remarks, del_flag, ygjjtjaf, xmztwcjlbq, 
    xmztwcjlbn, xmztwcjlkl, xmztwcjlbl, ygjjtwcjafbq, ygjjtwcjafbn, 
    ygjjtwcjafkl, ygjjtwcjafbl, ygjjtwcjlbq, ygjjtwcjlbn, ygjjtwcjlkl, 
    ygjjtwcjlbl, ygjjtzcjafbq, ygjjtzcjafbn, ygjjtzcjafkl, ygjjtzcjafbl, 
    bz, yesOrNoJGC, wcjafbqJGC, wcjafbnJGC, wcjafklJGC, 
    wcjafblJGC, xmztwcjlbqJGC, xmztwcjlbnJGC, xmztwcjlklJGC, xmztwcjlblJGC, 
    zcjafbqJGC, zcjafbnJGC, zcjafklJGC, zcjafblJGC, ygjwcbqJGC, 
    ygjwcbnJGC, ygjwcklJGC, ygjwcblJGC, ygjjlbqJGC, ygjjlbnJGC, 
    ygjjlklJGC, ygjjlblJGC, qytzwcbq, qytzwcbn, qytzwckl, 
    qytzwcbl

  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select 
    <include refid="Base_Column_List" />
    from del_flag = '0' and zj_tz_inv_xmtzqk
    where id = #{id,jdbcType=CHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    delete from zj_tz_inv_xmtzqk
    where id = #{id,jdbcType=CHAR}
  </delete>
  <insert id="insert" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk" >
    insert into zj_tz_inv_xmtzqk (id, inv_pro_id, ztze, 
      zjaf, zzcf, tzwcbq, 
      tzwcbn, tzwckl, tzwcbl, 
      wcjafbq, wcjafbn, wcjafkl, 
      wcjafbl, zcjafbq, zcjafbn, 
      zcjafkl, zcjafbl, wczcfbq, 
      wczcfbn, wczcfkl, wczcfbl, 
      zczcfbq, zczcfbn, zczcfkl, 
      zczcfbl, period_type, period_value, 
      org, currency, sort, 
      create_by, create_org, create_date, 
      update_by, update_org, update_date, 
      remarks, del_flag, ygjjtjaf, 
      xmztwcjlbq, xmztwcjlbn, xmztwcjlkl, 
      xmztwcjlbl, ygjjtwcjafbq, ygjjtwcjafbn, 
      ygjjtwcjafkl, ygjjtwcjafbl, ygjjtwcjlbq, 
      ygjjtwcjlbn, ygjjtwcjlkl, ygjjtwcjlbl, 
      ygjjtzcjafbq, ygjjtzcjafbn, ygjjtzcjafkl, 
      ygjjtzcjafbl, bz, yesOrNoJGC, 
      wcjafbqJGC, wcjafbnJGC, wcjafklJGC, 
      wcjafblJGC, xmztwcjlbqJGC, xmztwcjlbnJGC, 
      xmztwcjlklJGC, xmztwcjlblJGC, zcjafbqJGC, 
      zcjafbnJGC, zcjafklJGC, zcjafblJGC, 
      ygjwcbqJGC, ygjwcbnJGC, ygjwcklJGC, 
      ygjwcblJGC, ygjjlbqJGC, ygjjlbnJGC, 
      ygjjlklJGC, ygjjlblJGC, qytzwcbq, 
      qytzwcbn, qytzwckl, qytzwcbl
      )
    values (#{id,jdbcType=CHAR}, #{invProId,jdbcType=CHAR}, #{ztze,jdbcType=DECIMAL}, 
      #{zjaf,jdbcType=DECIMAL}, #{zzcf,jdbcType=DECIMAL}, #{tzwcbq,jdbcType=DECIMAL}, 
      #{tzwcbn,jdbcType=DECIMAL}, #{tzwckl,jdbcType=DECIMAL}, #{tzwcbl,jdbcType=DECIMAL}, 
      #{wcjafbq,jdbcType=DECIMAL}, #{wcjafbn,jdbcType=DECIMAL}, #{wcjafkl,jdbcType=DECIMAL}, 
      #{wcjafbl,jdbcType=DECIMAL}, #{zcjafbq,jdbcType=DECIMAL}, #{zcjafbn,jdbcType=DECIMAL}, 
      #{zcjafkl,jdbcType=DECIMAL}, #{zcjafbl,jdbcType=DECIMAL}, #{wczcfbq,jdbcType=DECIMAL}, 
      #{wczcfbn,jdbcType=DECIMAL}, #{wczcfkl,jdbcType=DECIMAL}, #{wczcfbl,jdbcType=DECIMAL}, 
      #{zczcfbq,jdbcType=DECIMAL}, #{zczcfbn,jdbcType=DECIMAL}, #{zczcfkl,jdbcType=DECIMAL}, 
      #{zczcfbl,jdbcType=DECIMAL}, #{periodType,jdbcType=VARCHAR}, #{periodValue,jdbcType=VARCHAR}, 
      #{org,jdbcType=CHAR}, #{currency,jdbcType=VARCHAR}, #{sort,jdbcType=DECIMAL}, 
      #{createBy,jdbcType=CHAR}, #{createOrg,jdbcType=CHAR}, #{createDate,jdbcType=TIMESTAMP}, 
      #{updateBy,jdbcType=CHAR}, #{updateOrg,jdbcType=CHAR}, #{updateDate,jdbcType=TIMESTAMP}, 
      #{remarks,jdbcType=VARCHAR}, #{delFlag,jdbcType=CHAR}, #{ygjjtjaf,jdbcType=DECIMAL}, 
      #{xmztwcjlbq,jdbcType=DECIMAL}, #{xmztwcjlbn,jdbcType=DECIMAL}, #{xmztwcjlkl,jdbcType=DECIMAL}, 
      #{xmztwcjlbl,jdbcType=DECIMAL}, #{ygjjtwcjafbq,jdbcType=DECIMAL}, #{ygjjtwcjafbn,jdbcType=DECIMAL}, 
      #{ygjjtwcjafkl,jdbcType=DECIMAL}, #{ygjjtwcjafbl,jdbcType=DECIMAL}, #{ygjjtwcjlbq,jdbcType=DECIMAL}, 
      #{ygjjtwcjlbn,jdbcType=DECIMAL}, #{ygjjtwcjlkl,jdbcType=DECIMAL}, #{ygjjtwcjlbl,jdbcType=DECIMAL}, 
      #{ygjjtzcjafbq,jdbcType=DECIMAL}, #{ygjjtzcjafbn,jdbcType=DECIMAL}, #{ygjjtzcjafkl,jdbcType=DECIMAL}, 
      #{ygjjtzcjafbl,jdbcType=DECIMAL}, #{bz,jdbcType=VARCHAR}, #{yesOrNoJGC,jdbcType=VARCHAR}, 
      #{wcjafbqJGC,jdbcType=DECIMAL}, #{wcjafbnJGC,jdbcType=DECIMAL}, #{wcjafklJGC,jdbcType=DECIMAL}, 
      #{wcjafblJGC,jdbcType=DECIMAL}, #{xmztwcjlbqJGC,jdbcType=DECIMAL}, #{xmztwcjlbnJGC,jdbcType=DECIMAL}, 
      #{xmztwcjlklJGC,jdbcType=DECIMAL}, #{xmztwcjlblJGC,jdbcType=DECIMAL}, #{zcjafbqJGC,jdbcType=DECIMAL}, 
      #{zcjafbnJGC,jdbcType=DECIMAL}, #{zcjafklJGC,jdbcType=DECIMAL}, #{zcjafblJGC,jdbcType=DECIMAL}, 
      #{ygjwcbqJGC,jdbcType=DECIMAL}, #{ygjwcbnJGC,jdbcType=DECIMAL}, #{ygjwcklJGC,jdbcType=DECIMAL}, 
      #{ygjwcblJGC,jdbcType=DECIMAL}, #{ygjjlbqJGC,jdbcType=DECIMAL}, #{ygjjlbnJGC,jdbcType=DECIMAL}, 
      #{ygjjlklJGC,jdbcType=DECIMAL}, #{ygjjlblJGC,jdbcType=DECIMAL}, #{qytzwcbq,jdbcType=DECIMAL}, 
      #{qytzwcbn,jdbcType=DECIMAL}, #{qytzwckl,jdbcType=DECIMAL}, #{qytzwcbl,jdbcType=DECIMAL}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk" >
    insert into zj_tz_inv_xmtzqk
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="invProId != null" >
        inv_pro_id,
      </if>
      <if test="ztze != null" >
        ztze,
      </if>
      <if test="zjaf != null" >
        zjaf,
      </if>
      <if test="zzcf != null" >
        zzcf,
      </if>
      <if test="tzwcbq != null" >
        tzwcbq,
      </if>
      <if test="tzwcbn != null" >
        tzwcbn,
      </if>
      <if test="tzwckl != null" >
        tzwckl,
      </if>
      <if test="tzwcbl != null" >
        tzwcbl,
      </if>
      <if test="wcjafbq != null" >
        wcjafbq,
      </if>
      <if test="wcjafbn != null" >
        wcjafbn,
      </if>
      <if test="wcjafkl != null" >
        wcjafkl,
      </if>
      <if test="wcjafbl != null" >
        wcjafbl,
      </if>
      <if test="zcjafbq != null" >
        zcjafbq,
      </if>
      <if test="zcjafbn != null" >
        zcjafbn,
      </if>
      <if test="zcjafkl != null" >
        zcjafkl,
      </if>
      <if test="zcjafbl != null" >
        zcjafbl,
      </if>
      <if test="wczcfbq != null" >
        wczcfbq,
      </if>
      <if test="wczcfbn != null" >
        wczcfbn,
      </if>
      <if test="wczcfkl != null" >
        wczcfkl,
      </if>
      <if test="wczcfbl != null" >
        wczcfbl,
      </if>
      <if test="zczcfbq != null" >
        zczcfbq,
      </if>
      <if test="zczcfbn != null" >
        zczcfbn,
      </if>
      <if test="zczcfkl != null" >
        zczcfkl,
      </if>
      <if test="zczcfbl != null" >
        zczcfbl,
      </if>
      <if test="periodType != null" >
        period_type,
      </if>
      <if test="periodValue != null" >
        period_value,
      </if>
      <if test="org != null" >
        org,
      </if>
      <if test="currency != null" >
        currency,
      </if>
      <if test="sort != null" >
        sort,
      </if>
      <if test="createBy != null" >
        create_by,
      </if>
      <if test="createOrg != null" >
        create_org,
      </if>
      <if test="createDate != null" >
        create_date,
      </if>
      <if test="updateBy != null" >
        update_by,
      </if>
      <if test="updateOrg != null" >
        update_org,
      </if>
      <if test="updateDate != null" >
        update_date,
      </if>
      <if test="remarks != null" >
        remarks,
      </if>
      <if test="delFlag != null" >
        del_flag,
      </if>
      <if test="ygjjtjaf != null" >
        ygjjtjaf,
      </if>
      <if test="xmztwcjlbq != null" >
        xmztwcjlbq,
      </if>
      <if test="xmztwcjlbn != null" >
        xmztwcjlbn,
      </if>
      <if test="xmztwcjlkl != null" >
        xmztwcjlkl,
      </if>
      <if test="xmztwcjlbl != null" >
        xmztwcjlbl,
      </if>
      <if test="ygjjtwcjafbq != null" >
        ygjjtwcjafbq,
      </if>
      <if test="ygjjtwcjafbn != null" >
        ygjjtwcjafbn,
      </if>
      <if test="ygjjtwcjafkl != null" >
        ygjjtwcjafkl,
      </if>
      <if test="ygjjtwcjafbl != null" >
        ygjjtwcjafbl,
      </if>
      <if test="ygjjtwcjlbq != null" >
        ygjjtwcjlbq,
      </if>
      <if test="ygjjtwcjlbn != null" >
        ygjjtwcjlbn,
      </if>
      <if test="ygjjtwcjlkl != null" >
        ygjjtwcjlkl,
      </if>
      <if test="ygjjtwcjlbl != null" >
        ygjjtwcjlbl,
      </if>
      <if test="ygjjtzcjafbq != null" >
        ygjjtzcjafbq,
      </if>
      <if test="ygjjtzcjafbn != null" >
        ygjjtzcjafbn,
      </if>
      <if test="ygjjtzcjafkl != null" >
        ygjjtzcjafkl,
      </if>
      <if test="ygjjtzcjafbl != null" >
        ygjjtzcjafbl,
      </if>
      <if test="bz != null" >
        bz,
      </if>
      <if test="yesOrNoJGC != null" >
        yesOrNoJGC,
      </if>
      <if test="wcjafbqJGC != null" >
        wcjafbqJGC,
      </if>
      <if test="wcjafbnJGC != null" >
        wcjafbnJGC,
      </if>
      <if test="wcjafklJGC != null" >
        wcjafklJGC,
      </if>
      <if test="wcjafblJGC != null" >
        wcjafblJGC,
      </if>
      <if test="xmztwcjlbqJGC != null" >
        xmztwcjlbqJGC,
      </if>
      <if test="xmztwcjlbnJGC != null" >
        xmztwcjlbnJGC,
      </if>
      <if test="xmztwcjlklJGC != null" >
        xmztwcjlklJGC,
      </if>
      <if test="xmztwcjlblJGC != null" >
        xmztwcjlblJGC,
      </if>
      <if test="zcjafbqJGC != null" >
        zcjafbqJGC,
      </if>
      <if test="zcjafbnJGC != null" >
        zcjafbnJGC,
      </if>
      <if test="zcjafklJGC != null" >
        zcjafklJGC,
      </if>
      <if test="zcjafblJGC != null" >
        zcjafblJGC,
      </if>
      <if test="ygjwcbqJGC != null" >
        ygjwcbqJGC,
      </if>
      <if test="ygjwcbnJGC != null" >
        ygjwcbnJGC,
      </if>
      <if test="ygjwcklJGC != null" >
        ygjwcklJGC,
      </if>
      <if test="ygjwcblJGC != null" >
        ygjwcblJGC,
      </if>
      <if test="ygjjlbqJGC != null" >
        ygjjlbqJGC,
      </if>
      <if test="ygjjlbnJGC != null" >
        ygjjlbnJGC,
      </if>
      <if test="ygjjlklJGC != null" >
        ygjjlklJGC,
      </if>
      <if test="ygjjlblJGC != null" >
        ygjjlblJGC,
      </if>
      <if test="qytzwcbq != null" >
        qytzwcbq,
      </if>
      <if test="qytzwcbn != null" >
        qytzwcbn,
      </if>
      <if test="qytzwckl != null" >
        qytzwckl,
      </if>
      <if test="qytzwcbl != null" >
        qytzwcbl,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=CHAR},
      </if>
      <if test="invProId != null" >
        #{invProId,jdbcType=CHAR},
      </if>
      <if test="ztze != null" >
        #{ztze,jdbcType=DECIMAL},
      </if>
      <if test="zjaf != null" >
        #{zjaf,jdbcType=DECIMAL},
      </if>
      <if test="zzcf != null" >
        #{zzcf,jdbcType=DECIMAL},
      </if>
      <if test="tzwcbq != null" >
        #{tzwcbq,jdbcType=DECIMAL},
      </if>
      <if test="tzwcbn != null" >
        #{tzwcbn,jdbcType=DECIMAL},
      </if>
      <if test="tzwckl != null" >
        #{tzwckl,jdbcType=DECIMAL},
      </if>
      <if test="tzwcbl != null" >
        #{tzwcbl,jdbcType=DECIMAL},
      </if>
      <if test="wcjafbq != null" >
        #{wcjafbq,jdbcType=DECIMAL},
      </if>
      <if test="wcjafbn != null" >
        #{wcjafbn,jdbcType=DECIMAL},
      </if>
      <if test="wcjafkl != null" >
        #{wcjafkl,jdbcType=DECIMAL},
      </if>
      <if test="wcjafbl != null" >
        #{wcjafbl,jdbcType=DECIMAL},
      </if>
      <if test="zcjafbq != null" >
        #{zcjafbq,jdbcType=DECIMAL},
      </if>
      <if test="zcjafbn != null" >
        #{zcjafbn,jdbcType=DECIMAL},
      </if>
      <if test="zcjafkl != null" >
        #{zcjafkl,jdbcType=DECIMAL},
      </if>
      <if test="zcjafbl != null" >
        #{zcjafbl,jdbcType=DECIMAL},
      </if>
      <if test="wczcfbq != null" >
        #{wczcfbq,jdbcType=DECIMAL},
      </if>
      <if test="wczcfbn != null" >
        #{wczcfbn,jdbcType=DECIMAL},
      </if>
      <if test="wczcfkl != null" >
        #{wczcfkl,jdbcType=DECIMAL},
      </if>
      <if test="wczcfbl != null" >
        #{wczcfbl,jdbcType=DECIMAL},
      </if>
      <if test="zczcfbq != null" >
        #{zczcfbq,jdbcType=DECIMAL},
      </if>
      <if test="zczcfbn != null" >
        #{zczcfbn,jdbcType=DECIMAL},
      </if>
      <if test="zczcfkl != null" >
        #{zczcfkl,jdbcType=DECIMAL},
      </if>
      <if test="zczcfbl != null" >
        #{zczcfbl,jdbcType=DECIMAL},
      </if>
      <if test="periodType != null" >
        #{periodType,jdbcType=VARCHAR},
      </if>
      <if test="periodValue != null" >
        #{periodValue,jdbcType=VARCHAR},
      </if>
      <if test="org != null" >
        #{org,jdbcType=CHAR},
      </if>
      <if test="currency != null" >
        #{currency,jdbcType=VARCHAR},
      </if>
      <if test="sort != null" >
        #{sort,jdbcType=DECIMAL},
      </if>
      <if test="createBy != null" >
        #{createBy,jdbcType=CHAR},
      </if>
      <if test="createOrg != null" >
        #{createOrg,jdbcType=CHAR},
      </if>
      <if test="createDate != null" >
        #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateBy != null" >
        #{updateBy,jdbcType=CHAR},
      </if>
      <if test="updateOrg != null" >
        #{updateOrg,jdbcType=CHAR},
      </if>
      <if test="updateDate != null" >
        #{updateDate,jdbcType=TIMESTAMP},
      </if>
      <if test="remarks != null" >
        #{remarks,jdbcType=VARCHAR},
      </if>
      <if test="delFlag != null" >
        #{delFlag,jdbcType=CHAR},
      </if>
      <if test="ygjjtjaf != null" >
        #{ygjjtjaf,jdbcType=DECIMAL},
      </if>
      <if test="xmztwcjlbq != null" >
        #{xmztwcjlbq,jdbcType=DECIMAL},
      </if>
      <if test="xmztwcjlbn != null" >
        #{xmztwcjlbn,jdbcType=DECIMAL},
      </if>
      <if test="xmztwcjlkl != null" >
        #{xmztwcjlkl,jdbcType=DECIMAL},
      </if>
      <if test="xmztwcjlbl != null" >
        #{xmztwcjlbl,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtwcjafbq != null" >
        #{ygjjtwcjafbq,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtwcjafbn != null" >
        #{ygjjtwcjafbn,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtwcjafkl != null" >
        #{ygjjtwcjafkl,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtwcjafbl != null" >
        #{ygjjtwcjafbl,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtwcjlbq != null" >
        #{ygjjtwcjlbq,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtwcjlbn != null" >
        #{ygjjtwcjlbn,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtwcjlkl != null" >
        #{ygjjtwcjlkl,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtwcjlbl != null" >
        #{ygjjtwcjlbl,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtzcjafbq != null" >
        #{ygjjtzcjafbq,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtzcjafbn != null" >
        #{ygjjtzcjafbn,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtzcjafkl != null" >
        #{ygjjtzcjafkl,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtzcjafbl != null" >
        #{ygjjtzcjafbl,jdbcType=DECIMAL},
      </if>
      <if test="bz != null" >
        #{bz,jdbcType=VARCHAR},
      </if>
      <if test="yesOrNoJGC != null" >
        #{yesOrNoJGC,jdbcType=VARCHAR},
      </if>
      <if test="wcjafbqJGC != null" >
        #{wcjafbqJGC,jdbcType=DECIMAL},
      </if>
      <if test="wcjafbnJGC != null" >
        #{wcjafbnJGC,jdbcType=DECIMAL},
      </if>
      <if test="wcjafklJGC != null" >
        #{wcjafklJGC,jdbcType=DECIMAL},
      </if>
      <if test="wcjafblJGC != null" >
        #{wcjafblJGC,jdbcType=DECIMAL},
      </if>
      <if test="xmztwcjlbqJGC != null" >
        #{xmztwcjlbqJGC,jdbcType=DECIMAL},
      </if>
      <if test="xmztwcjlbnJGC != null" >
        #{xmztwcjlbnJGC,jdbcType=DECIMAL},
      </if>
      <if test="xmztwcjlklJGC != null" >
        #{xmztwcjlklJGC,jdbcType=DECIMAL},
      </if>
      <if test="xmztwcjlblJGC != null" >
        #{xmztwcjlblJGC,jdbcType=DECIMAL},
      </if>
      <if test="zcjafbqJGC != null" >
        #{zcjafbqJGC,jdbcType=DECIMAL},
      </if>
      <if test="zcjafbnJGC != null" >
        #{zcjafbnJGC,jdbcType=DECIMAL},
      </if>
      <if test="zcjafklJGC != null" >
        #{zcjafklJGC,jdbcType=DECIMAL},
      </if>
      <if test="zcjafblJGC != null" >
        #{zcjafblJGC,jdbcType=DECIMAL},
      </if>
      <if test="ygjwcbqJGC != null" >
        #{ygjwcbqJGC,jdbcType=DECIMAL},
      </if>
      <if test="ygjwcbnJGC != null" >
        #{ygjwcbnJGC,jdbcType=DECIMAL},
      </if>
      <if test="ygjwcklJGC != null" >
        #{ygjwcklJGC,jdbcType=DECIMAL},
      </if>
      <if test="ygjwcblJGC != null" >
        #{ygjwcblJGC,jdbcType=DECIMAL},
      </if>
      <if test="ygjjlbqJGC != null" >
        #{ygjjlbqJGC,jdbcType=DECIMAL},
      </if>
      <if test="ygjjlbnJGC != null" >
        #{ygjjlbnJGC,jdbcType=DECIMAL},
      </if>
      <if test="ygjjlklJGC != null" >
        #{ygjjlklJGC,jdbcType=DECIMAL},
      </if>
      <if test="ygjjlblJGC != null" >
        #{ygjjlblJGC,jdbcType=DECIMAL},
      </if>
      <if test="qytzwcbq != null" >
        #{qytzwcbq,jdbcType=DECIMAL},
      </if>
      <if test="qytzwcbn != null" >
        #{qytzwcbn,jdbcType=DECIMAL},
      </if>
      <if test="qytzwckl != null" >
        #{qytzwckl,jdbcType=DECIMAL},
      </if>
      <if test="qytzwcbl != null" >
        #{qytzwcbl,jdbcType=DECIMAL},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk" >
    update zj_tz_inv_xmtzqk
    <set >
      <if test="invProId != null" >
        inv_pro_id = #{invProId,jdbcType=CHAR},
      </if>
      <if test="ztze != null" >
        ztze = #{ztze,jdbcType=DECIMAL},
      </if>
      <if test="zjaf != null" >
        zjaf = #{zjaf,jdbcType=DECIMAL},
      </if>
      <if test="zzcf != null" >
        zzcf = #{zzcf,jdbcType=DECIMAL},
      </if>
      <if test="tzwcbq != null" >
        tzwcbq = #{tzwcbq,jdbcType=DECIMAL},
      </if>
      <if test="tzwcbn != null" >
        tzwcbn = #{tzwcbn,jdbcType=DECIMAL},
      </if>
      <if test="tzwckl != null" >
        tzwckl = #{tzwckl,jdbcType=DECIMAL},
      </if>
      <if test="tzwcbl != null" >
        tzwcbl = #{tzwcbl,jdbcType=DECIMAL},
      </if>
      <if test="wcjafbq != null" >
        wcjafbq = #{wcjafbq,jdbcType=DECIMAL},
      </if>
      <if test="wcjafbn != null" >
        wcjafbn = #{wcjafbn,jdbcType=DECIMAL},
      </if>
      <if test="wcjafkl != null" >
        wcjafkl = #{wcjafkl,jdbcType=DECIMAL},
      </if>
      <if test="wcjafbl != null" >
        wcjafbl = #{wcjafbl,jdbcType=DECIMAL},
      </if>
      <if test="zcjafbq != null" >
        zcjafbq = #{zcjafbq,jdbcType=DECIMAL},
      </if>
      <if test="zcjafbn != null" >
        zcjafbn = #{zcjafbn,jdbcType=DECIMAL},
      </if>
      <if test="zcjafkl != null" >
        zcjafkl = #{zcjafkl,jdbcType=DECIMAL},
      </if>
      <if test="zcjafbl != null" >
        zcjafbl = #{zcjafbl,jdbcType=DECIMAL},
      </if>
      <if test="wczcfbq != null" >
        wczcfbq = #{wczcfbq,jdbcType=DECIMAL},
      </if>
      <if test="wczcfbn != null" >
        wczcfbn = #{wczcfbn,jdbcType=DECIMAL},
      </if>
      <if test="wczcfkl != null" >
        wczcfkl = #{wczcfkl,jdbcType=DECIMAL},
      </if>
      <if test="wczcfbl != null" >
        wczcfbl = #{wczcfbl,jdbcType=DECIMAL},
      </if>
      <if test="zczcfbq != null" >
        zczcfbq = #{zczcfbq,jdbcType=DECIMAL},
      </if>
      <if test="zczcfbn != null" >
        zczcfbn = #{zczcfbn,jdbcType=DECIMAL},
      </if>
      <if test="zczcfkl != null" >
        zczcfkl = #{zczcfkl,jdbcType=DECIMAL},
      </if>
      <if test="zczcfbl != null" >
        zczcfbl = #{zczcfbl,jdbcType=DECIMAL},
      </if>
      <if test="periodType != null" >
        period_type = #{periodType,jdbcType=VARCHAR},
      </if>
      <if test="periodValue != null" >
        period_value = #{periodValue,jdbcType=VARCHAR},
      </if>
      <if test="org != null" >
        org = #{org,jdbcType=CHAR},
      </if>
      <if test="currency != null" >
        currency = #{currency,jdbcType=VARCHAR},
      </if>
      <if test="sort != null" >
        sort = #{sort,jdbcType=DECIMAL},
      </if>
      <if test="createBy != null" >
        create_by = #{createBy,jdbcType=CHAR},
      </if>
      <if test="createOrg != null" >
        create_org = #{createOrg,jdbcType=CHAR},
      </if>
      <if test="createDate != null" >
        create_date = #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateBy != null" >
        update_by = #{updateBy,jdbcType=CHAR},
      </if>
      <if test="updateOrg != null" >
        update_org = #{updateOrg,jdbcType=CHAR},
      </if>
      <if test="updateDate != null" >
        update_date = #{updateDate,jdbcType=TIMESTAMP},
      </if>
      <if test="remarks != null" >
        remarks = #{remarks,jdbcType=VARCHAR},
      </if>
      <if test="delFlag != null" >
        del_flag = #{delFlag,jdbcType=CHAR},
      </if>
      <if test="ygjjtjaf != null" >
        ygjjtjaf = #{ygjjtjaf,jdbcType=DECIMAL},
      </if>
      <if test="xmztwcjlbq != null" >
        xmztwcjlbq = #{xmztwcjlbq,jdbcType=DECIMAL},
      </if>
      <if test="xmztwcjlbn != null" >
        xmztwcjlbn = #{xmztwcjlbn,jdbcType=DECIMAL},
      </if>
      <if test="xmztwcjlkl != null" >
        xmztwcjlkl = #{xmztwcjlkl,jdbcType=DECIMAL},
      </if>
      <if test="xmztwcjlbl != null" >
        xmztwcjlbl = #{xmztwcjlbl,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtwcjafbq != null" >
        ygjjtwcjafbq = #{ygjjtwcjafbq,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtwcjafbn != null" >
        ygjjtwcjafbn = #{ygjjtwcjafbn,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtwcjafkl != null" >
        ygjjtwcjafkl = #{ygjjtwcjafkl,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtwcjafbl != null" >
        ygjjtwcjafbl = #{ygjjtwcjafbl,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtwcjlbq != null" >
        ygjjtwcjlbq = #{ygjjtwcjlbq,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtwcjlbn != null" >
        ygjjtwcjlbn = #{ygjjtwcjlbn,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtwcjlkl != null" >
        ygjjtwcjlkl = #{ygjjtwcjlkl,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtwcjlbl != null" >
        ygjjtwcjlbl = #{ygjjtwcjlbl,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtzcjafbq != null" >
        ygjjtzcjafbq = #{ygjjtzcjafbq,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtzcjafbn != null" >
        ygjjtzcjafbn = #{ygjjtzcjafbn,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtzcjafkl != null" >
        ygjjtzcjafkl = #{ygjjtzcjafkl,jdbcType=DECIMAL},
      </if>
      <if test="ygjjtzcjafbl != null" >
        ygjjtzcjafbl = #{ygjjtzcjafbl,jdbcType=DECIMAL},
      </if>
      <if test="bz != null" >
        bz = #{bz,jdbcType=VARCHAR},
      </if>
      <if test="yesOrNoJGC != null" >
        yesOrNoJGC = #{yesOrNoJGC,jdbcType=VARCHAR},
      </if>
      <if test="wcjafbqJGC != null" >
        wcjafbqJGC = #{wcjafbqJGC,jdbcType=DECIMAL},
      </if>
      <if test="wcjafbnJGC != null" >
        wcjafbnJGC = #{wcjafbnJGC,jdbcType=DECIMAL},
      </if>
      <if test="wcjafklJGC != null" >
        wcjafklJGC = #{wcjafklJGC,jdbcType=DECIMAL},
      </if>
      <if test="wcjafblJGC != null" >
        wcjafblJGC = #{wcjafblJGC,jdbcType=DECIMAL},
      </if>
      <if test="xmztwcjlbqJGC != null" >
        xmztwcjlbqJGC = #{xmztwcjlbqJGC,jdbcType=DECIMAL},
      </if>
      <if test="xmztwcjlbnJGC != null" >
        xmztwcjlbnJGC = #{xmztwcjlbnJGC,jdbcType=DECIMAL},
      </if>
      <if test="xmztwcjlklJGC != null" >
        xmztwcjlklJGC = #{xmztwcjlklJGC,jdbcType=DECIMAL},
      </if>
      <if test="xmztwcjlblJGC != null" >
        xmztwcjlblJGC = #{xmztwcjlblJGC,jdbcType=DECIMAL},
      </if>
      <if test="zcjafbqJGC != null" >
        zcjafbqJGC = #{zcjafbqJGC,jdbcType=DECIMAL},
      </if>
      <if test="zcjafbnJGC != null" >
        zcjafbnJGC = #{zcjafbnJGC,jdbcType=DECIMAL},
      </if>
      <if test="zcjafklJGC != null" >
        zcjafklJGC = #{zcjafklJGC,jdbcType=DECIMAL},
      </if>
      <if test="zcjafblJGC != null" >
        zcjafblJGC = #{zcjafblJGC,jdbcType=DECIMAL},
      </if>
      <if test="ygjwcbqJGC != null" >
        ygjwcbqJGC = #{ygjwcbqJGC,jdbcType=DECIMAL},
      </if>
      <if test="ygjwcbnJGC != null" >
        ygjwcbnJGC = #{ygjwcbnJGC,jdbcType=DECIMAL},
      </if>
      <if test="ygjwcklJGC != null" >
        ygjwcklJGC = #{ygjwcklJGC,jdbcType=DECIMAL},
      </if>
      <if test="ygjwcblJGC != null" >
        ygjwcblJGC = #{ygjwcblJGC,jdbcType=DECIMAL},
      </if>
      <if test="ygjjlbqJGC != null" >
        ygjjlbqJGC = #{ygjjlbqJGC,jdbcType=DECIMAL},
      </if>
      <if test="ygjjlbnJGC != null" >
        ygjjlbnJGC = #{ygjjlbnJGC,jdbcType=DECIMAL},
      </if>
      <if test="ygjjlklJGC != null" >
        ygjjlklJGC = #{ygjjlklJGC,jdbcType=DECIMAL},
      </if>
      <if test="ygjjlblJGC != null" >
        ygjjlblJGC = #{ygjjlblJGC,jdbcType=DECIMAL},
      </if>
      <if test="qytzwcbq != null" >
        qytzwcbq = #{qytzwcbq,jdbcType=DECIMAL},
      </if>
      <if test="qytzwcbn != null" >
        qytzwcbn = #{qytzwcbn,jdbcType=DECIMAL},
      </if>
      <if test="qytzwckl != null" >
        qytzwckl = #{qytzwckl,jdbcType=DECIMAL},
      </if>
      <if test="qytzwcbl != null" >
        qytzwcbl = #{qytzwcbl,jdbcType=DECIMAL},
      </if>
    </set>
    where id = #{id,jdbcType=CHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk" >
    update zj_tz_inv_xmtzqk
    set       inv_pro_id = #{invProId,jdbcType=CHAR},
      ztze = #{ztze,jdbcType=DECIMAL},
      zjaf = #{zjaf,jdbcType=DECIMAL},
      zzcf = #{zzcf,jdbcType=DECIMAL},
      tzwcbq = #{tzwcbq,jdbcType=DECIMAL},
      tzwcbn = #{tzwcbn,jdbcType=DECIMAL},
      tzwckl = #{tzwckl,jdbcType=DECIMAL},
      tzwcbl = #{tzwcbl,jdbcType=DECIMAL},
      wcjafbq = #{wcjafbq,jdbcType=DECIMAL},
      wcjafbn = #{wcjafbn,jdbcType=DECIMAL},
      wcjafkl = #{wcjafkl,jdbcType=DECIMAL},
      wcjafbl = #{wcjafbl,jdbcType=DECIMAL},
      zcjafbq = #{zcjafbq,jdbcType=DECIMAL},
      zcjafbn = #{zcjafbn,jdbcType=DECIMAL},
      zcjafkl = #{zcjafkl,jdbcType=DECIMAL},
      zcjafbl = #{zcjafbl,jdbcType=DECIMAL},
      wczcfbq = #{wczcfbq,jdbcType=DECIMAL},
      wczcfbn = #{wczcfbn,jdbcType=DECIMAL},
      wczcfkl = #{wczcfkl,jdbcType=DECIMAL},
      wczcfbl = #{wczcfbl,jdbcType=DECIMAL},
      zczcfbq = #{zczcfbq,jdbcType=DECIMAL},
      zczcfbn = #{zczcfbn,jdbcType=DECIMAL},
      zczcfkl = #{zczcfkl,jdbcType=DECIMAL},
      zczcfbl = #{zczcfbl,jdbcType=DECIMAL},
      period_type = #{periodType,jdbcType=VARCHAR},
      period_value = #{periodValue,jdbcType=VARCHAR},
      org = #{org,jdbcType=CHAR},
      currency = #{currency,jdbcType=VARCHAR},
      sort = #{sort,jdbcType=DECIMAL},
      create_by = #{createBy,jdbcType=CHAR},
      create_org = #{createOrg,jdbcType=CHAR},
      create_date = #{createDate,jdbcType=TIMESTAMP},
      update_by = #{updateBy,jdbcType=CHAR},
      update_org = #{updateOrg,jdbcType=CHAR},
      update_date = #{updateDate,jdbcType=TIMESTAMP},
      remarks = #{remarks,jdbcType=VARCHAR},
      del_flag = #{delFlag,jdbcType=CHAR},
      ygjjtjaf = #{ygjjtjaf,jdbcType=DECIMAL},
      xmztwcjlbq = #{xmztwcjlbq,jdbcType=DECIMAL},
      xmztwcjlbn = #{xmztwcjlbn,jdbcType=DECIMAL},
      xmztwcjlkl = #{xmztwcjlkl,jdbcType=DECIMAL},
      xmztwcjlbl = #{xmztwcjlbl,jdbcType=DECIMAL},
      ygjjtwcjafbq = #{ygjjtwcjafbq,jdbcType=DECIMAL},
      ygjjtwcjafbn = #{ygjjtwcjafbn,jdbcType=DECIMAL},
      ygjjtwcjafkl = #{ygjjtwcjafkl,jdbcType=DECIMAL},
      ygjjtwcjafbl = #{ygjjtwcjafbl,jdbcType=DECIMAL},
      ygjjtwcjlbq = #{ygjjtwcjlbq,jdbcType=DECIMAL},
      ygjjtwcjlbn = #{ygjjtwcjlbn,jdbcType=DECIMAL},
      ygjjtwcjlkl = #{ygjjtwcjlkl,jdbcType=DECIMAL},
      ygjjtwcjlbl = #{ygjjtwcjlbl,jdbcType=DECIMAL},
      ygjjtzcjafbq = #{ygjjtzcjafbq,jdbcType=DECIMAL},
      ygjjtzcjafbn = #{ygjjtzcjafbn,jdbcType=DECIMAL},
      ygjjtzcjafkl = #{ygjjtzcjafkl,jdbcType=DECIMAL},
      ygjjtzcjafbl = #{ygjjtzcjafbl,jdbcType=DECIMAL},
      bz = #{bz,jdbcType=VARCHAR},
      yesOrNoJGC = #{yesOrNoJGC,jdbcType=VARCHAR},
      wcjafbqJGC = #{wcjafbqJGC,jdbcType=DECIMAL},
      wcjafbnJGC = #{wcjafbnJGC,jdbcType=DECIMAL},
      wcjafklJGC = #{wcjafklJGC,jdbcType=DECIMAL},
      wcjafblJGC = #{wcjafblJGC,jdbcType=DECIMAL},
      xmztwcjlbqJGC = #{xmztwcjlbqJGC,jdbcType=DECIMAL},
      xmztwcjlbnJGC = #{xmztwcjlbnJGC,jdbcType=DECIMAL},
      xmztwcjlklJGC = #{xmztwcjlklJGC,jdbcType=DECIMAL},
      xmztwcjlblJGC = #{xmztwcjlblJGC,jdbcType=DECIMAL},
      zcjafbqJGC = #{zcjafbqJGC,jdbcType=DECIMAL},
      zcjafbnJGC = #{zcjafbnJGC,jdbcType=DECIMAL},
      zcjafklJGC = #{zcjafklJGC,jdbcType=DECIMAL},
      zcjafblJGC = #{zcjafblJGC,jdbcType=DECIMAL},
      ygjwcbqJGC = #{ygjwcbqJGC,jdbcType=DECIMAL},
      ygjwcbnJGC = #{ygjwcbnJGC,jdbcType=DECIMAL},
      ygjwcklJGC = #{ygjwcklJGC,jdbcType=DECIMAL},
      ygjwcblJGC = #{ygjwcblJGC,jdbcType=DECIMAL},
      ygjjlbqJGC = #{ygjjlbqJGC,jdbcType=DECIMAL},
      ygjjlbnJGC = #{ygjjlbnJGC,jdbcType=DECIMAL},
      ygjjlklJGC = #{ygjjlklJGC,jdbcType=DECIMAL},
      ygjjlblJGC = #{ygjjlblJGC,jdbcType=DECIMAL},
      qytzwcbq = #{qytzwcbq,jdbcType=DECIMAL},
      qytzwcbn = #{qytzwcbn,jdbcType=DECIMAL},
      qytzwckl = #{qytzwckl,jdbcType=DECIMAL},
      qytzwcbl = #{qytzwcbl,jdbcType=DECIMAL}
    where id = #{id,jdbcType=CHAR}
  </update>
  <select id="selectByZjTzInvXmtzqkList" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk" >
    select 
    <include refid="Base_Column_List" />
    from zj_tz_inv_xmtzqk
    where del_flag = '0'
    <if test="id != null and id != ''" >
     and id = #{id,jdbcType=}
    </if>
    <if test="invProId != null and invProId != ''" >
     and inv_pro_id = #{invProId,jdbcType=CHAR}
    </if>
    <if test="ztze != null and ztze != ''" >
     and ztze = #{ztze,jdbcType=DECIMAL}
    </if>
    <if test="zjaf != null and zjaf != ''" >
     and zjaf = #{zjaf,jdbcType=DECIMAL}
    </if>
    <if test="zzcf != null and zzcf != ''" >
     and zzcf = #{zzcf,jdbcType=DECIMAL}
    </if>
    <if test="tzwcbq != null and tzwcbq != ''" >
     and tzwcbq = #{tzwcbq,jdbcType=DECIMAL}
    </if>
    <if test="tzwcbn != null and tzwcbn != ''" >
     and tzwcbn = #{tzwcbn,jdbcType=DECIMAL}
    </if>
    <if test="tzwckl != null and tzwckl != ''" >
     and tzwckl = #{tzwckl,jdbcType=DECIMAL}
    </if>
    <if test="tzwcbl != null and tzwcbl != ''" >
     and tzwcbl = #{tzwcbl,jdbcType=DECIMAL}
    </if>
    <if test="wcjafbq != null and wcjafbq != ''" >
     and wcjafbq = #{wcjafbq,jdbcType=DECIMAL}
    </if>
    <if test="wcjafbn != null and wcjafbn != ''" >
     and wcjafbn = #{wcjafbn,jdbcType=DECIMAL}
    </if>
    <if test="wcjafkl != null and wcjafkl != ''" >
     and wcjafkl = #{wcjafkl,jdbcType=DECIMAL}
    </if>
    <if test="wcjafbl != null and wcjafbl != ''" >
     and wcjafbl = #{wcjafbl,jdbcType=DECIMAL}
    </if>
    <if test="zcjafbq != null and zcjafbq != ''" >
     and zcjafbq = #{zcjafbq,jdbcType=DECIMAL}
    </if>
    <if test="zcjafbn != null and zcjafbn != ''" >
     and zcjafbn = #{zcjafbn,jdbcType=DECIMAL}
    </if>
    <if test="zcjafkl != null and zcjafkl != ''" >
     and zcjafkl = #{zcjafkl,jdbcType=DECIMAL}
    </if>
    <if test="zcjafbl != null and zcjafbl != ''" >
     and zcjafbl = #{zcjafbl,jdbcType=DECIMAL}
    </if>
    <if test="wczcfbq != null and wczcfbq != ''" >
     and wczcfbq = #{wczcfbq,jdbcType=DECIMAL}
    </if>
    <if test="wczcfbn != null and wczcfbn != ''" >
     and wczcfbn = #{wczcfbn,jdbcType=DECIMAL}
    </if>
    <if test="wczcfkl != null and wczcfkl != ''" >
     and wczcfkl = #{wczcfkl,jdbcType=DECIMAL}
    </if>
    <if test="wczcfbl != null and wczcfbl != ''" >
     and wczcfbl = #{wczcfbl,jdbcType=DECIMAL}
    </if>
    <if test="zczcfbq != null and zczcfbq != ''" >
     and zczcfbq = #{zczcfbq,jdbcType=DECIMAL}
    </if>
    <if test="zczcfbn != null and zczcfbn != ''" >
     and zczcfbn = #{zczcfbn,jdbcType=DECIMAL}
    </if>
    <if test="zczcfkl != null and zczcfkl != ''" >
     and zczcfkl = #{zczcfkl,jdbcType=DECIMAL}
    </if>
    <if test="zczcfbl != null and zczcfbl != ''" >
     and zczcfbl = #{zczcfbl,jdbcType=DECIMAL}
    </if>
    <if test="periodType != null and periodType != ''" >
     and period_type = #{periodType,jdbcType=VARCHAR}
    </if>
    <if test="periodValue != null and periodValue != ''" >
     and period_value = #{periodValue,jdbcType=VARCHAR}
    </if>
    <if test="org != null and org != ''" >
     and org = #{org,jdbcType=CHAR}
    </if>
    <if test="currency != null and currency != ''" >
     and currency = #{currency,jdbcType=VARCHAR}
    </if>
    <if test="sort != null and sort != ''" >
     and sort = #{sort,jdbcType=DECIMAL}
    </if>
    <if test="createBy != null and createBy != ''" >
     and create_by = #{createBy,jdbcType=CHAR}
    </if>
    <if test="createOrg != null and createOrg != ''" >
     and create_org = #{createOrg,jdbcType=CHAR}
    </if>
    <if test="createDate != null and createDate != ''" >
     and create_date = #{createDate,jdbcType=TIMESTAMP}
    </if>
    <if test="updateBy != null and updateBy != ''" >
     and update_by = #{updateBy,jdbcType=CHAR}
    </if>
    <if test="updateOrg != null and updateOrg != ''" >
     and update_org = #{updateOrg,jdbcType=CHAR}
    </if>
    <if test="updateDate != null and updateDate != ''" >
     and update_date = #{updateDate,jdbcType=TIMESTAMP}
    </if>
    <if test="remarks != null and remarks != ''" >
     and remarks = #{remarks,jdbcType=VARCHAR}
    </if>
    <if test="ygjjtjaf != null and ygjjtjaf != ''" >
     and ygjjtjaf = #{ygjjtjaf,jdbcType=DECIMAL}
    </if>
    <if test="xmztwcjlbq != null and xmztwcjlbq != ''" >
     and xmztwcjlbq = #{xmztwcjlbq,jdbcType=DECIMAL}
    </if>
    <if test="xmztwcjlbn != null and xmztwcjlbn != ''" >
     and xmztwcjlbn = #{xmztwcjlbn,jdbcType=DECIMAL}
    </if>
    <if test="xmztwcjlkl != null and xmztwcjlkl != ''" >
     and xmztwcjlkl = #{xmztwcjlkl,jdbcType=DECIMAL}
    </if>
    <if test="xmztwcjlbl != null and xmztwcjlbl != ''" >
     and xmztwcjlbl = #{xmztwcjlbl,jdbcType=DECIMAL}
    </if>
    <if test="ygjjtwcjafbq != null and ygjjtwcjafbq != ''" >
     and ygjjtwcjafbq = #{ygjjtwcjafbq,jdbcType=DECIMAL}
    </if>
    <if test="ygjjtwcjafbn != null and ygjjtwcjafbn != ''" >
     and ygjjtwcjafbn = #{ygjjtwcjafbn,jdbcType=DECIMAL}
    </if>
    <if test="ygjjtwcjafkl != null and ygjjtwcjafkl != ''" >
     and ygjjtwcjafkl = #{ygjjtwcjafkl,jdbcType=DECIMAL}
    </if>
    <if test="ygjjtwcjafbl != null and ygjjtwcjafbl != ''" >
     and ygjjtwcjafbl = #{ygjjtwcjafbl,jdbcType=DECIMAL}
    </if>
    <if test="ygjjtwcjlbq != null and ygjjtwcjlbq != ''" >
     and ygjjtwcjlbq = #{ygjjtwcjlbq,jdbcType=DECIMAL}
    </if>
    <if test="ygjjtwcjlbn != null and ygjjtwcjlbn != ''" >
     and ygjjtwcjlbn = #{ygjjtwcjlbn,jdbcType=DECIMAL}
    </if>
    <if test="ygjjtwcjlkl != null and ygjjtwcjlkl != ''" >
     and ygjjtwcjlkl = #{ygjjtwcjlkl,jdbcType=DECIMAL}
    </if>
    <if test="ygjjtwcjlbl != null and ygjjtwcjlbl != ''" >
     and ygjjtwcjlbl = #{ygjjtwcjlbl,jdbcType=DECIMAL}
    </if>
    <if test="ygjjtzcjafbq != null and ygjjtzcjafbq != ''" >
     and ygjjtzcjafbq = #{ygjjtzcjafbq,jdbcType=DECIMAL}
    </if>
    <if test="ygjjtzcjafbn != null and ygjjtzcjafbn != ''" >
     and ygjjtzcjafbn = #{ygjjtzcjafbn,jdbcType=DECIMAL}
    </if>
    <if test="ygjjtzcjafkl != null and ygjjtzcjafkl != ''" >
     and ygjjtzcjafkl = #{ygjjtzcjafkl,jdbcType=DECIMAL}
    </if>
    <if test="ygjjtzcjafbl != null and ygjjtzcjafbl != ''" >
     and ygjjtzcjafbl = #{ygjjtzcjafbl,jdbcType=DECIMAL}
    </if>
    <if test="bz != null and bz != ''" >
     and bz = #{bz,jdbcType=VARCHAR}
    </if>
    <if test="yesOrNoJGC != null and yesOrNoJGC != ''" >
     and yesOrNoJGC = #{yesOrNoJGC,jdbcType=VARCHAR}
    </if>
    <if test="wcjafbqJGC != null and wcjafbqJGC != ''" >
     and wcjafbqJGC = #{wcjafbqJGC,jdbcType=DECIMAL}
    </if>
    <if test="wcjafbnJGC != null and wcjafbnJGC != ''" >
     and wcjafbnJGC = #{wcjafbnJGC,jdbcType=DECIMAL}
    </if>
    <if test="wcjafklJGC != null and wcjafklJGC != ''" >
     and wcjafklJGC = #{wcjafklJGC,jdbcType=DECIMAL}
    </if>
    <if test="wcjafblJGC != null and wcjafblJGC != ''" >
     and wcjafblJGC = #{wcjafblJGC,jdbcType=DECIMAL}
    </if>
    <if test="xmztwcjlbqJGC != null and xmztwcjlbqJGC != ''" >
     and xmztwcjlbqJGC = #{xmztwcjlbqJGC,jdbcType=DECIMAL}
    </if>
    <if test="xmztwcjlbnJGC != null and xmztwcjlbnJGC != ''" >
     and xmztwcjlbnJGC = #{xmztwcjlbnJGC,jdbcType=DECIMAL}
    </if>
    <if test="xmztwcjlklJGC != null and xmztwcjlklJGC != ''" >
     and xmztwcjlklJGC = #{xmztwcjlklJGC,jdbcType=DECIMAL}
    </if>
    <if test="xmztwcjlblJGC != null and xmztwcjlblJGC != ''" >
     and xmztwcjlblJGC = #{xmztwcjlblJGC,jdbcType=DECIMAL}
    </if>
    <if test="zcjafbqJGC != null and zcjafbqJGC != ''" >
     and zcjafbqJGC = #{zcjafbqJGC,jdbcType=DECIMAL}
    </if>
    <if test="zcjafbnJGC != null and zcjafbnJGC != ''" >
     and zcjafbnJGC = #{zcjafbnJGC,jdbcType=DECIMAL}
    </if>
    <if test="zcjafklJGC != null and zcjafklJGC != ''" >
     and zcjafklJGC = #{zcjafklJGC,jdbcType=DECIMAL}
    </if>
    <if test="zcjafblJGC != null and zcjafblJGC != ''" >
     and zcjafblJGC = #{zcjafblJGC,jdbcType=DECIMAL}
    </if>
    <if test="ygjwcbqJGC != null and ygjwcbqJGC != ''" >
     and ygjwcbqJGC = #{ygjwcbqJGC,jdbcType=DECIMAL}
    </if>
    <if test="ygjwcbnJGC != null and ygjwcbnJGC != ''" >
     and ygjwcbnJGC = #{ygjwcbnJGC,jdbcType=DECIMAL}
    </if>
    <if test="ygjwcklJGC != null and ygjwcklJGC != ''" >
     and ygjwcklJGC = #{ygjwcklJGC,jdbcType=DECIMAL}
    </if>
    <if test="ygjwcblJGC != null and ygjwcblJGC != ''" >
     and ygjwcblJGC = #{ygjwcblJGC,jdbcType=DECIMAL}
    </if>
    <if test="ygjjlbqJGC != null and ygjjlbqJGC != ''" >
     and ygjjlbqJGC = #{ygjjlbqJGC,jdbcType=DECIMAL}
    </if>
    <if test="ygjjlbnJGC != null and ygjjlbnJGC != ''" >
     and ygjjlbnJGC = #{ygjjlbnJGC,jdbcType=DECIMAL}
    </if>
    <if test="ygjjlklJGC != null and ygjjlklJGC != ''" >
     and ygjjlklJGC = #{ygjjlklJGC,jdbcType=DECIMAL}
    </if>
    <if test="ygjjlblJGC != null and ygjjlblJGC != ''" >
     and ygjjlblJGC = #{ygjjlblJGC,jdbcType=DECIMAL}
    </if>
    <if test="qytzwcbq != null and qytzwcbq != ''" >
     and qytzwcbq = #{qytzwcbq,jdbcType=DECIMAL}
    </if>
    <if test="qytzwcbn != null and qytzwcbn != ''" >
     and qytzwcbn = #{qytzwcbn,jdbcType=DECIMAL}
    </if>
    <if test="qytzwckl != null and qytzwckl != ''" >
     and qytzwckl = #{qytzwckl,jdbcType=DECIMAL}
    </if>
    <if test="qytzwcbl != null and qytzwcbl != ''" >
     and qytzwcbl = #{qytzwcbl,jdbcType=DECIMAL}
    </if>
    ORDER BY modify_time DESC 
  </select>
  <delete id="batchDeleteUpdateZjTzInvXmtzqk" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk" >
    <![CDATA[ 
        update zj_tz_inv_xmtzqk
        set del_flag = '1',
            modify_time=#{param2.modifyTime,jdbcType=TIMESTAMP},
            modify_user=#{param2.modifyUser},
            modify_user_name=#{param2.modifyUserName}
        where del_flag = '0' and id in 
     ]]> 
     <foreach collection="param1" item = "model" open="(" separator="," close=")">#{model.id} 
     </foreach>
  </delete>
  <select id="selectZjTzInvXmtzqkMonthlyReportListByPeriodValue" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
	SELECT
		t3.project_id,
		pro_no AS pro_num,
		t5.company_name AS comname,
		(SELECT  d.label FROM sys_dict  d inner join  sys_dict_category c  on c.id = d.category_id  and  c.del_flag = '0' 
		inner join  pro_inv_basic b  on b.gclb = d.value and  b.del_flag = '0'
		where  d.del_flag = '0'  and  c.category_code = 'XM_GXLB' AND b.project_id = t3.project_id) AS category_name,
		t5.amount1 AS ztze,
		t5.amount3 AS jaf_money,
		t5.amount4 AS zcf_money,
		project_name AS pro_name,
		szgq,
		company8 AS ygjsgfe,
		(SELECT d.label FROM sys_dict d INNER JOIN sys_dict_category c ON c.id = d.category_id and  c.del_flag = '0' 
		INNER JOIN pro_inv_basic b ON b.is_report = d.value and b.del_flag = '0'
		where  d.del_flag = '0' AND c.category_code = 'PFLX' and b.project_id = t3.project_id) AS pfname,
		t1.*,
		t5.amount3 * company8 as ygjjaf,
		(SELECT SUM(tb1.tzwcbq) FROM pro_inv_xmtzqk tb1 INNER JOIN  pro_inv_basic tb2 ON tb2.id = tb1.inv_pro_id AND tb2.del_flag = '0' WHERE tb1.del_flag = '0' AND tb2.project_id = t3.project_id AND tb1.period_value IN <foreach collection="param2" item = "model" open="(" separator="," close=")">#{model}</foreach>) AS tzwcbj,
		(SELECT SUM(tb1.tzwcbq) FROM pro_inv_xmtzqk tb1 INNER JOIN  pro_inv_basic tb2 ON tb2.id = tb1.inv_pro_id AND tb2.del_flag = '0' WHERE tb1.del_flag = '0' AND tb2.project_id = t3.project_id AND tb1.period_value IN <foreach collection="param2" item = "model" open="(" separator="," close=")">#{model}</foreach>)*szgq/100 AS qytzwcbj,
		(SELECT SUM(tb1.wcjafbq) FROM pro_inv_xmtzqk tb1 INNER JOIN  pro_inv_basic tb2 ON tb2.id = tb1.inv_pro_id AND tb2.del_flag = '0' WHERE tb1.del_flag = '0' AND tb2.project_id = t3.project_id AND tb1.period_value IN <foreach collection="param2" item = "model" open="(" separator="," close=")">#{model}</foreach>) AS wcjafbj,
		(SELECT SUM(tb1.xmztwcjlbq) FROM pro_inv_xmtzqk tb1 INNER JOIN  pro_inv_basic tb2 ON tb2.id = tb1.inv_pro_id AND tb2.del_flag = '0' WHERE tb1.del_flag = '0' AND tb2.project_id = t3.project_id AND tb1.period_value IN <foreach collection="param2" item = "model" open="(" separator="," close=")">#{model}</foreach>) AS xmztwcjlbj,
		(SELECT SUM(tb1.zcjafbq) FROM pro_inv_xmtzqk tb1 INNER JOIN  pro_inv_basic tb2 ON tb2.id = tb1.inv_pro_id AND tb2.del_flag = '0' WHERE tb1.del_flag = '0' AND tb2.project_id = t3.project_id AND tb1.period_value IN <foreach collection="param2" item = "model" open="(" separator="," close=")">#{model}</foreach>) AS zcjafbj,
		(SELECT SUM(tb1.ygjjtwcjafbq) FROM pro_inv_xmtzqk tb1 INNER JOIN  pro_inv_basic tb2 ON tb2.id = tb1.inv_pro_id AND tb2.del_flag = '0' WHERE tb1.del_flag = '0' AND tb2.project_id = t3.project_id AND tb1.period_value IN <foreach collection="param2" item = "model" open="(" separator="," close=")">#{model}</foreach>) AS ygjjtwcjafbj,
		(SELECT SUM(tb1.ygjjtwcjlbq) FROM pro_inv_xmtzqk tb1 INNER JOIN  pro_inv_basic tb2 ON tb2.id = tb1.inv_pro_id AND tb2.del_flag = '0' WHERE tb1.del_flag = '0' AND tb2.project_id = t3.project_id AND tb1.period_value IN <foreach collection="param2" item = "model" open="(" separator="," close=")">#{model}</foreach>) AS ygjjtwcjlbj,
		(SELECT SUM(tb1.ygjjtzcjafbq) FROM pro_inv_xmtzqk tb1 INNER JOIN  pro_inv_basic tb2 ON tb2.id = tb1.inv_pro_id AND tb2.del_flag = '0' WHERE tb1.del_flag = '0' AND tb2.project_id = t3.project_id AND tb1.period_value IN <foreach collection="param2" item = "model" open="(" separator="," close=")">#{model}</foreach>) AS ygjjtzcjafbj,
		(SELECT SUM(tb1.wczcfbq) FROM pro_inv_xmtzqk tb1 INNER JOIN  pro_inv_basic tb2 ON tb2.id = tb1.inv_pro_id AND tb2.del_flag = '0' WHERE tb1.del_flag = '0' AND tb2.project_id = t3.project_id AND tb1.period_value IN <foreach collection="param2" item = "model" open="(" separator="," close=")">#{model}</foreach>) AS wczcfbj,
		(SELECT SUM(tb1.zczcfbq) FROM pro_inv_xmtzqk tb1 INNER JOIN  pro_inv_basic tb2 ON tb2.id = tb1.inv_pro_id AND tb2.del_flag = '0' WHERE tb1.del_flag = '0' AND tb2.project_id = t3.project_id AND tb1.period_value IN <foreach collection="param2" item = "model" open="(" separator="," close=")">#{model}</foreach>) AS zczcfbj
	FROM pro_inv_xmtzqk t1
	INNER JOIN pro_inv_com_inf t2 ON t2.inv_pro_id = t1.inv_pro_id and t2.del_flag = '0'
	INNER JOIN pro_inv_basic t3 ON t3.id = t1.inv_pro_id and t3.del_flag = '0'
	INNER JOIN pro_inv_ht_info t4 ON t4.inv_pro_id = t1.inv_pro_id and t4.del_flag = '0'
	INNER JOIN zj_tz_pro_manage t5 ON t5.project_id = t3.project_id and t5.del_flag = '0'
	<where>
		t1.del_flag = '0'
		<if test="param1.periodValue != null and param1.periodValue != '' ">
		 and t1.period_value = #{param1.periodValue}
		</if>
		<if test="param1.proId != null and param1.proId != ''" >
	     and t3.project_id = #{param1.proId,jdbcType=CHAR}
	    </if>
	    <if test="param1.projectId != null and param1.projectId != ''" >
	     and t3.project_id = #{param1.projectId,jdbcType=CHAR}
	    </if>
	    <if test="param1 != null and param1.projectIdSql != null and param1.projectIdSql != ''">
	     and t3.project_id in (${param1.projectIdSql})
	    </if>
	</where>
	ORDER BY CAST(sort1 AS DECIMAL),pro_no
  </select>
  <select id="selectZjTzInvXmtzqkMonthlyReportListBasicData" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
	 SELECT
		t3.id,
		t4.project_id AS proId,
		t4.pro_no AS pro_num,
		t4.company_name AS comname,
		t4.project_name AS pro_name,
		t3.create_date,
		t3.period_value 
	FROM
		zj_tz_pro_manage t4
		INNER JOIN pro_inv_basic t1 ON t1.project_id = t4.project_id
		INNER JOIN pro_inv_com_inf t2 ON t2.inv_pro_id = t1.id
		INNER JOIN pro_inv_xmtzqk t3 ON t3.inv_pro_id = t1.id
	<where>
		t4.del_flag = '0'
		<if test="projectId != null and projectId != ''" >
	     and t4.project_id = #{projectId}
	    </if>
	    <if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     and t4.project_id in (${projectIdSql})
	    </if> 
	</where>
	ORDER BY t3.period_value DESC
  </select>
  <!--  -->
  <select id="selectHomeProgressWarningPlanningProgressWc" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
	SELECT
		t3.project_id,
		t3.pro_no AS pro_num,
		t3.project_name AS pro_name,
		t3.project_short_name AS short_name,
		(SELECT szgq FROM pro_inv_com_inf tb1 
		INNER JOIN pro_inv_basic tb2 ON  tb2.id = tb1.inv_pro_id and tb2.del_flag = '0'
	 	WHERE tb1.del_flag = '0' and tb2.project_id = t3.project_id) AS gqbl,
		t3.company_name AS comname,
		<if test="periodValue != null and periodValue != ''">
		(SELECT TRUNCATE((tzwc1+tzwc2+tzwc3+tzwc4)*szgq/100/10000,2) 
		FROM pro_inv_xmndtzjh tb1
		LEFT JOIN pro_inv_basic tb2 ON tb2.id = tb1.xmid and tb2.del_flag = '0'
		LEFT JOIN pro_inv_com_inf tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
		<where>
		<if test="periodValue != null and periodValue != ''">
			tb1.period_value = YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) and
		</if>
			tb1.bbh = '2' and tb2.project_id = t3.project_id
		</where>
		)AS bnjhwcqytz,
		(SELECT TRUNCATE(yjgjtwcjaxj/10000,2)
		FROM pro_inv_xmndtzjh tb1
		LEFT JOIN pro_inv_basic tb2 ON tb2.id = tb1.xmid and tb2.del_flag = '0'
		<where>
		<if test="periodValue != null and periodValue != ''">
			tb1.period_value = YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) and
		</if>
			tb1.bbh = '2' and tb2.project_id = t3.project_id
		</where>
		) AS ygjbnjhwcja,
		
		(SELECT TRUNCATE(IFNULL(SUM(IFNULL(tb1.qytzwcbq,0)),0)/10000,2) FROM pro_inv_xmtzqk tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.id = tb1.inv_pro_id and tb2.del_flag = '0' 
		<where>
			tb1.del_flag = '0' and
			<if test="periodValue != null and periodValue != ''">
			SUBSTR(tb1.period_value,1,4)  = YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) AND
			</if>
			tb2.project_id = t3.project_id
		</where>
		) AS qytzwcbn,
	 	(SELECT TRUNCATE( IFNULL(SUM(IFNULL(tb1.ygjjtwcjafbq,0)),0)/10000,2) FROM pro_inv_xmtzqk tb1 
	 	LEFT JOIN pro_inv_basic tb2 ON tb2.id = tb1.inv_pro_id and tb2.del_flag = '0'
		<where>
			tb1.del_flag = '0' and
			<if test="periodValue != null and periodValue != ''">
			SUBSTR(tb1.period_value,1,4)  = YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) AND
			</if>
			tb2.project_id = t3.project_id
		</where>
		) AS ygjjtwcjafbn,
		(SELECT IFNULL(SUM(IFNULL(tb1.qytzwcbq,0)),0) FROM pro_inv_xmtzqk tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.id = tb1.inv_pro_id and tb2.del_flag = '0' 
		<where>
			tb1.del_flag = '0' and
			<if test="periodValue != null and periodValue != ''">
			SUBSTR(tb1.period_value,1,4)  = YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) AND
			</if>
			tb2.project_id = t3.project_id
		</where>
		)
		/(SELECT (tzwc1+tzwc2+tzwc3+tzwc4)*szgq/100 
		FROM pro_inv_xmndtzjh tb1
		LEFT JOIN pro_inv_basic tb2 ON tb2.id = tb1.xmid and tb2.del_flag = '0'
		LEFT JOIN pro_inv_com_inf tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
		<where>
		<if test="periodValue != null and periodValue != ''">
			tb1.period_value = YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) and
		</if>
			tb1.bbh = '2' and tb2.project_id = t3.project_id
		</where>
		) AS bnqytzbfb,
		(SELECT IFNULL(SUM(IFNULL(tb1.ygjjtwcjafbq,0)),0) FROM pro_inv_xmtzqk tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.id = tb1.inv_pro_id and tb2.del_flag = '0'
		<where>
			tb1.del_flag = '0' and
			<if test="periodValue != null and periodValue != ''">
			SUBSTR(tb1.period_value,1,4)  = YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) AND
			</if>
			tb2.project_id = t3.project_id
		</where>
		)
		/(SELECT yjgjtwcjaxj  FROM pro_inv_xmndtzjh tb1
		LEFT JOIN pro_inv_basic tb2 ON tb2.id = tb1.xmid and tb2.del_flag = '0'
		<where>
			<if test="periodValue != null and periodValue != ''">
			tb1.period_value = YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) AND 
			</if>
			tb1.bbh = '2' and tb2.project_id = t3.project_id
		</where>
		) AS bnjjafbfb,
		
		
		<if test="quarter != null and quarter != '' and quarter != '1'.toString()">
		
		(SELECT 
			(SUM( t.tzwcbq ) * t.szgq / 100)/
			<if test="quarter == '2'.toString()">(IFNULL(t.tzwc1,0)* t.szgq / 100)</if>
			<if test="quarter == '3'.toString()">((IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0))* t.szgq / 100)</if>
			<if test="quarter == '4'.toString()">((IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0) + IFNULL(t.tzwc3,0) )* t.szgq / 100)</if>
		FROM 
			(SELECT
					tb1.project_id,
					tb1.project_short_name,
					tb3.tzwcbq,
					tb4.szgq,
					<if test="quarter == '2'.toString()">tb5.tzwc1,</if>
					<if test="quarter == '3'.toString()">tb5.tzwc1,tb5.tzwc2,</if>
					<if test="quarter == '4'.toString()">tb5.tzwc1,tb5.tzwc2,tb5.tzwc3,</if>
					QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu, 
					YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
					tb5.period_value
			FROM zj_tz_pro_manage tb1 
			LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
			LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
			LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
			LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2' 
			<if test="periodValue != null and periodValue != ''">
			and tb5.period_value = YEAR(STR_TO_DATE(#{periodValue},'%Y%m'))
			</if>
			WHERE tb1.del_flag = '0' AND tb1.project_type = '0' ) AS t
			<where>
				t.project_id = t3.project_id 
				<if test="periodValue != null and periodValue != ''">
				AND t.n = YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) 
				</if>
				<if test="quarter != null and quarter != ''">
				AND t.jidu &lt;= CAST(#{quarter} AS SIGNED) - 1 
				</if>
			</where>
			) AS bjqytzbfb,
		
		(SELECT 
			SUM( t.ygjjtwcjafbq )/
			<if test="quarter == '2'.toString()">IFNULL(t.yjgjtwcja1,0)</if>
			<if test="quarter == '3'.toString()">(IFNULL(t.yjgjtwcja1,0) + IFNULL(t.yjgjtwcja2,0))</if>
			<if test="quarter == '4'.toString()">(IFNULL(t.yjgjtwcja1,0) + IFNULL(t.yjgjtwcja2,0) + IFNULL(t.yjgjtwcja3,0) )</if>
		FROM 
			(SELECT
					tb1.project_id,
					tb1.project_short_name,
					tb3.ygjjtwcjafbq,
					tb4.szgq,
					<if test="quarter == '2'.toString()">tb5.yjgjtwcja1,</if>
					<if test="quarter == '3'.toString()">tb5.yjgjtwcja1,tb5.yjgjtwcja2,</if>
					<if test="quarter == '4'.toString()">tb5.yjgjtwcja1,tb5.yjgjtwcja2,tb5.yjgjtwcja3,</if>
					QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
					YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
					tb5.period_value
			FROM zj_tz_pro_manage tb1 
			LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
			LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
			LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
			LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2' 
			<if test="periodValue != null and periodValue != ''">
			and tb5.period_value = YEAR(STR_TO_DATE(#{periodValue},'%Y%m'))
			</if>
			WHERE tb1.del_flag = '0' AND tb1.project_type = '0' ) AS t
			<where>
				t.project_id = t3.project_id 
				<if test="periodValue != null and periodValue != ''">
				AND t.n = YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) 
				</if>
				<if test="quarter != null and quarter != ''">
				AND t.jidu &lt;= CAST(#{quarter} AS SIGNED) - 1 
				</if>
			</where>
			) AS bjjjafbfb,
		
		
		</if>
		
		<if test="colourFlag != null and colourFlag != '' and colourFlag == 'red'">
		
		(SELECT 
			SUM( t.tzwcbq )/
			IFNULL(t.tzwcxj,0)
		FROM 
			(SELECT
					tb1.project_id,
					tb1.project_short_name,
					tb3.tzwcbq,
					tb4.szgq,
					tb5.tzwc1 + tb5.tzwc2 + tb5.tzwc3 + tb5.tzwc4 AS tzwcxj,
					YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
					tb5.period_value
			FROM zj_tz_pro_manage tb1 
			LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
			LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
			LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
			LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2' 
			<if test="periodValue != null and periodValue != ''">
			and tb5.period_value = YEAR(STR_TO_DATE(#{periodValue},'%Y%m'))
			</if>
			WHERE tb1.del_flag = '0' AND tb1.project_type = '0' ) AS t
			<where>
				t.project_id = t3.project_id 
				<if test="periodValue != null and periodValue != ''">
				AND t.n = YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) 
				</if>
			</where>
			) AS snztzbfb,
		
		</if>
		
		
		</if>
		t3.pro_process_id
	FROM
		zj_tz_pro_manage t3 
	<where>
		t3.del_flag = '0' and t3.project_type = '0' and (t3.pro_process_id = '2' or t3.pro_process_id = '3' or t3.pro_process_id = '4')
		<if test="projectId != null and projectId != ''" >
	     and t3.project_id = #{projectId}
		</if>
		<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     and t3.project_id in (${projectIdSql})
	    </if>
		<if test="comname != null and comname != ''">
		 and t3.company_name = #{comname} 
		</if>
		<if test="warnSelect != null and warnSelect != '' and warnSelect == 'yellow' and
		 quarter != '1'.toString() and colourFlag == 'red'">
		 and 
		(SELECT 
			(SUM( t.tzwcbq ) * t.szgq / 100)/
			<if test="quarter == '2'.toString()">(IFNULL(t.tzwc1,0)* t.szgq / 100)</if>
			<if test="quarter == '3'.toString()">( ((IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0))* t.szgq / 100)</if>
			<if test="quarter == '4'.toString()">((IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0) + IFNULL(t.tzwc3,0) )* t.szgq / 100)</if>
		FROM 
			(SELECT
					tb1.project_id,
					tb1.project_short_name,
					tb3.tzwcbq,
					tb4.szgq,
					<if test="quarter == '2'.toString()">tb5.tzwc1,</if>
					<if test="quarter == '3'.toString()">tb5.tzwc1,tb5.tzwc2,</if>
					<if test="quarter == '4'.toString()">tb5.tzwc1,tb5.tzwc2,tb5.tzwc3,</if>
					QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
					YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
					tb5.period_value
			FROM zj_tz_pro_manage tb1 
			LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
			LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
			LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
			LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2' 
			<if test="periodValue != null and periodValue != ''">
			and tb5.period_value = YEAR(STR_TO_DATE(#{periodValue},'%Y%m'))
			</if>
			WHERE tb1.del_flag = '0' AND tb1.project_type = '0' ) AS t
			<where>
				t.project_id = t3.project_id 
				<if test="periodValue != null and periodValue != ''">
				AND t.n = YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) 
				</if>
				<if test="quarter != null and quarter != ''">
				AND t.jidu &lt;= CAST(#{quarter} AS SIGNED) - 1 
				</if>
			</where>
			) &lt; 0.7 
		and (SELECT 
			SUM( t.tzwcbq )/
			IFNULL(t.tzwcxj,0)
		FROM 
			(SELECT
					tb1.project_id,
					tb1.project_short_name,
					tb3.tzwcbq,
					tb4.szgq,
					tb5.tzwc1 + tb5.tzwc2 + tb5.tzwc3 + tb5.tzwc4 AS tzwcxj,
					YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
					tb5.period_value
			FROM zj_tz_pro_manage tb1 
			LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
			LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
			LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
			LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2' 
			<if test="periodValue != null and periodValue != ''">
			and tb5.period_value = YEAR(STR_TO_DATE(#{periodValue},'%Y%m'))
			</if>
			WHERE tb1.del_flag = '0' AND tb1.project_type = '0' ) AS t
			<where>
				t.project_id = t3.project_id 
				<if test="periodValue != null and periodValue != ''">
				AND t.n = YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) 
				</if>
			</where>
			) &gt;= 0.6
		</if>
		
		<if test="warnSelect != null and warnSelect != '' and warnSelect == 'red' and colourFlag == 'red'">
		and (SELECT 
			SUM( t.tzwcbq )/
			IFNULL(t.tzwcxj,0)
		FROM 
			(SELECT
					tb1.project_id,
					tb1.project_short_name,
					tb3.tzwcbq,
					tb4.szgq,
					tb5.tzwc1 + tb5.tzwc2 + tb5.tzwc3 + tb5.tzwc4 AS tzwcxj,
					YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
					tb5.period_value
			FROM zj_tz_pro_manage tb1 
			LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
			LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
			LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
			LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2' 
			<if test="periodValue != null and periodValue != ''">
			and tb5.period_value = YEAR(STR_TO_DATE(#{periodValue},'%Y%m'))
			</if>
			WHERE tb1.del_flag = '0' AND tb1.project_type = '0' ) AS t
			<where>
				t.project_id = t3.project_id 
				<if test="periodValue != null and periodValue != ''">
				AND t.n = YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) 
				</if>
			</where>
			) &lt; 0.6 
		</if>
		
	</where>
	 
	<if test="sortType != null and sortType == '1'.toString()">
	ORDER BY CAST( t3.sort1 AS DECIMAL ),t3.pro_no 
	</if>
	<if test="sortType != null and sortType == '2'.toString()">
	ORDER BY bnjhwcqytz 
	</if>
	<if test="sortType != null and sortType == '3'.toString()">
	ORDER BY bnjhwcqytz DESC 
	</if>
	<if test="sortType != null and sortType == '4'.toString()">
	ORDER BY ygjbnjhwcja 
	</if>
	<if test="sortType != null and sortType == '5'.toString()">
	ORDER BY ygjbnjhwcja DESC
	</if>
	<if test="sortType != null and sortType == '6'.toString()">
	ORDER BY qytzwcbn
	</if>
	<if test="sortType != null and sortType == '7'.toString()">
	ORDER BY qytzwcbn DESC
	</if>
	<if test="sortType != null and sortType == '8'.toString()">
	ORDER BY ygjjtwcjafbn
	</if>
	<if test="sortType != null and sortType == '9'.toString()">
	ORDER BY ygjjtwcjafbn DESC
	</if>
	<if test="sortType != null and sortType == '10'.toString()">
	ORDER BY bnqytzbfb
	</if>
	<if test="sortType != null and sortType == '11'.toString()">
	ORDER BY bnqytzbfb DESC
	</if>
	<if test="sortType != null and sortType == '12'.toString()">
	ORDER BY bnjjafbfb
	</if>
	<if test="sortType != null and sortType == '13'.toString()">
	ORDER BY bnjjafbfb DESC
	</if>
	<if test="sortType != null and sortType == '14'.toString()">
	ORDER BY bjqytzbfb
	</if>
	<if test="sortType != null and sortType == '15'.toString()">
	ORDER BY bjqytzbfb DESC
	</if>
	<if test="sortType != null and sortType == '16'.toString()">
	ORDER BY bjjjafbfb
	</if>
	<if test="sortType != null and sortType == '17'.toString()">
	ORDER BY bjjjafbfb DESC
	</if>
  </select>
  <!--  -->
  <select id="selectHomeProgressWarningInfo" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
  	SELECT
		t3.project_id,
		t3.project_short_name short_name
		
		<if test="dataType == '1'.toString()">
		,1 as dataType
		,(SELECT
			p.bjqytzbfb
		FROM
			(
		SELECT
			t.project_id,
			(SUM( t.tzwcbq ) * t.szgq / 100) 
			/ 
			(
			<if test="quarter == '1'.toString()">  t.tzwc1 </if>
			<if test="quarter == '2'.toString()">  (t.tzwc1 + t.tzwc2) </if>
			<if test="quarter == '3'.toString()">  (t.tzwc1 + t.tzwc2 + t.tzwc3) </if>  
			<if test="quarter == '4'.toString()">  (t.tzwc1 + t.tzwc2 + t.tzwc3 + t.tzwc4) </if>
			 * t.szgq / 100) AS bjqytzbfb
		FROM
			(
		SELECT
			tb1.project_id,
			tb3.tzwcbq,
			tb4.szgq,
			<if test="quarter == '1'.toString()">  tb5.tzwc1, </if>
			<if test="quarter == '2'.toString()">  tb5.tzwc1,tb5.tzwc2, </if>
			<if test="quarter == '3'.toString()">  tb5.tzwc1,tb5.tzwc2,tb5.tzwc3, </if>  
			<if test="quarter == '4'.toString()">  tb5.tzwc1,tb5.tzwc2,tb5.tzwc3,tb5.tzwc4, </if> 
			QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
			tb5.period_value
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0' 
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0' 
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0' 
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2' 
		WHERE tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4')
			) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			 t.n = #{periodValue} 
			</if>
			<if test="quarter != null and quarter != ''">
			AND t.jidu &lt;= #{quarter} 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = #{periodValue} 
			</if>
		</where>
		GROUP BY t.project_id 
		ORDER BY bjqytzbfb DESC 
			) AS p 
		where p.project_id = t3.project_id) AS bjqytzbfb 
		
		</if>
		
		<if test="dataType == '2'.toString()">
		,2 as dataType
		,(SELECT
			p.bjjjafbfb
		FROM
			(
		SELECT
			t.project_id,
			SUM( t.ygjjtwcjafbq ) 
			/ 
			<if test="quarter == '1'.toString()">  t.yjgjtwcja1 </if>
			<if test="quarter == '2'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2) </if>
			<if test="quarter == '3'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2 + t.yjgjtwcja3) </if>  
			<if test="quarter == '4'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2 + t.yjgjtwcja3 + t.yjgjtwcja4) </if>
			AS bjjjafbfb
		FROM
			(
		SELECT
			tb1.project_id,
			tb3.ygjjtwcjafbq,
			tb4.szgq,
			<if test="quarter == '1'.toString()">  tb5.yjgjtwcja1, </if>
			<if test="quarter == '2'.toString()">  tb5.yjgjtwcja1,tb5.yjgjtwcja2, </if>
			<if test="quarter == '3'.toString()">  tb5.yjgjtwcja1,tb5.yjgjtwcja2,tb5.yjgjtwcja3, </if>  
			<if test="quarter == '4'.toString()">  tb5.yjgjtwcja1,tb5.yjgjtwcja2,tb5.yjgjtwcja3,tb5.yjgjtwcja4, </if> 
			QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
			tb5.period_value
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0' 
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0' 
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0' 
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2' 
		WHERE tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4')
			) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			 t.n = #{periodValue} 
			</if>
			<if test="quarter != null and quarter != ''">
			AND t.jidu &lt;= #{quarter} 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = #{periodValue} 
			</if>
		</where>
		GROUP BY t.project_id 
		ORDER BY bjjjafbfb DESC 
			) AS p 
		where p.project_id = t3.project_id) AS bjjjafbfb
		
		</if>
		
		
		<if test="dataType == '3'.toString()">
		,3 as dataType
		,(SELECT
			p.bnztzbfb
		FROM
			(
		SELECT
			t.project_id,
			SUM( t.tzwcbq ) 
			/ 
			(t.tzwc1 + t.tzwc2 + t.tzwc3 + t.tzwc4)
			 AS bnztzbfb
		FROM
			(
		SELECT
			tb1.project_id,
			tb3.tzwcbq,
			tb4.szgq,
			tb5.tzwc1,tb5.tzwc2,tb5.tzwc3,tb5.tzwc4, 
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
			tb5.period_value
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0' 
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0' 
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0' 
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2' 
		WHERE tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4')
			) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			 t.n = #{periodValue} 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = #{periodValue} 
			</if>
		</where>
		GROUP BY t.project_id 
		ORDER BY bnztzbfb DESC 
			) AS p 
		where p.project_id = t3.project_id) AS bnztzbfb 	
		
		</if>
		
	FROM 
	zj_tz_pro_manage t3 
	<where>
		 t3.del_flag = '0' and t3.project_type = '0'  and (t3.pro_process_id = '2' or t3.pro_process_id = '3' or t3.pro_process_id = '4')
		<if test="projectId != null and projectId != ''" >
	     and t3.project_id = #{projectId}
		</if>
		<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     and t3.project_id in (${projectIdSql})
	    </if>
	    <if test="dataType == '1'.toString()">
	     and (SELECT
			p.bjqytzbfb
		FROM
			(
		SELECT
			t.project_id,
			(SUM( t.tzwcbq ) * t.szgq / 100) 
			/ 
			(
			<if test="quarter == '1'.toString()">  t.tzwc1 </if>
			<if test="quarter == '2'.toString()">  (t.tzwc1 + t.tzwc2) </if>
			<if test="quarter == '3'.toString()">  (t.tzwc1 + t.tzwc2 + t.tzwc3) </if>  
			<if test="quarter == '4'.toString()">  (t.tzwc1 + t.tzwc2 + t.tzwc3 + t.tzwc4) </if>
			 * t.szgq / 100) AS bjqytzbfb
		FROM
			(
		SELECT
			tb1.project_id,
			tb3.tzwcbq,
			tb4.szgq,
			<if test="quarter == '1'.toString()">  tb5.tzwc1, </if>
			<if test="quarter == '2'.toString()">  tb5.tzwc1,tb5.tzwc2, </if>
			<if test="quarter == '3'.toString()">  tb5.tzwc1,tb5.tzwc2,tb5.tzwc3, </if>  
			<if test="quarter == '4'.toString()">  tb5.tzwc1,tb5.tzwc2,tb5.tzwc3,tb5.tzwc4, </if> 
			QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
			tb5.period_value
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0' 
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0' 
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0' 
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2' 
		WHERE tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4')
			) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			 t.n = #{periodValue} 
			</if>
			<if test="quarter != null and quarter != ''">
			AND t.jidu &lt;= #{quarter} 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = #{periodValue} 
			</if>
		</where>
		GROUP BY t.project_id 
		ORDER BY bjqytzbfb DESC 
			) AS p 
		where p.project_id = t3.project_id) &lt; 0.7
	    </if>
	    
	    <if test="dataType == '2'.toString()">
	    and (SELECT
			p.bjjjafbfb
		FROM
			(
		SELECT
			t.project_id,
			SUM( t.ygjjtwcjafbq ) 
			/ 
			<if test="quarter == '1'.toString()">  t.yjgjtwcja1 </if>
			<if test="quarter == '2'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2) </if>
			<if test="quarter == '3'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2 + t.yjgjtwcja3) </if>  
			<if test="quarter == '4'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2 + t.yjgjtwcja3 + t.yjgjtwcja4) </if>
			AS bjjjafbfb
		FROM
			(
		SELECT
			tb1.project_id,
			tb3.ygjjtwcjafbq,
			tb4.szgq,
			<if test="quarter == '1'.toString()">  tb5.yjgjtwcja1, </if>
			<if test="quarter == '2'.toString()">  tb5.yjgjtwcja1,tb5.yjgjtwcja2, </if>
			<if test="quarter == '3'.toString()">  tb5.yjgjtwcja1,tb5.yjgjtwcja2,tb5.yjgjtwcja3, </if>  
			<if test="quarter == '4'.toString()">  tb5.yjgjtwcja1,tb5.yjgjtwcja2,tb5.yjgjtwcja3,tb5.yjgjtwcja4, </if> 
			QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n, 
			tb5.period_value
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0' 
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0' 
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0' 
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2' 
		WHERE tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4')
			) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			 t.n = #{periodValue} 
			</if>
			<if test="quarter != null and quarter != ''">
			AND t.jidu &lt;= #{quarter} 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = #{periodValue} 
			</if>
		</where>
		GROUP BY t.project_id 
		ORDER BY bjjjafbfb DESC 
			) AS p 
		where p.project_id = t3.project_id) &lt; 0.7
	    </if>
	    <if test="dataType == '3'.toString()">
	    and (SELECT
			p.bnztzbfb
		FROM
			(
		SELECT
			t.project_id,
			SUM( t.tzwcbq ) 
			/ 
			(t.tzwc1 + t.tzwc2 + t.tzwc3 + t.tzwc4)
			 AS bnztzbfb
		FROM
			(
		SELECT
			tb1.project_id,
			tb3.tzwcbq,
			tb4.szgq,
			tb5.tzwc1,tb5.tzwc2,tb5.tzwc3,tb5.tzwc4, 
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n, 
			tb5.period_value
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0' 
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0' 
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0' 
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2' 
		WHERE tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4')
			) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			 t.n = #{periodValue} 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = #{periodValue} 
			</if>
		</where>
		GROUP BY t.project_id 
		ORDER BY bnztzbfb DESC 
			) AS p 
		where p.project_id = t3.project_id) &lt; 0.6
	    </if>
	</where>
	GROUP BY t3.project_id 
	<if test="dataType == '1'.toString()">
	ORDER BY IFNULL(bjqytzbfb,0)
	</if>
	<if test="dataType == '2'.toString()">
	ORDER BY IFNULL(bjjjafbfb,0)
	</if>
	<if test="dataType == '3'.toString()">
	ORDER BY IFNULL(bnztzbfb,0) 
	</if>
  </select>
  <!--  -->
  <select id="selectHomeProgressWarningCheckingAdmin" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
		<if test="dataType == '1'.toString()">
		SELECT
			1 as dataType,
			t.project_id,
			t.project_short_name AS short_name, 
			(SUM( t.tzwcbq ) * t.szgq / 100) 
			/ 
			(<if test="quarter == '1'.toString()"> IFNULL(t.tzwc1,0) </if>
			<if test="quarter == '2'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0)) </if>
			<if test="quarter == '3'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0) + IFNULL(t.tzwc3,0)) </if>  
			<if test="quarter == '4'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0) + IFNULL(t.tzwc3,0) + IFNULL(t.tzwc4,0)) </if>
			 * t.szgq / 100) AS bjqytzbfb, 
			 RANK() OVER(ORDER BY (SUM( IFNULL(t.tzwcbq,0)  ) * IFNULL(t.szgq,0)  / 100 )/ 
			 
			 (
			 <if test="quarter == '1'.toString()">  IFNULL(t.tzwc1,0) </if>
			 <if test="quarter == '2'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0)) </if>
			 <if test="quarter == '3'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0) + IFNULL(t.tzwc3,0)) </if>
			 <if test="quarter == '4'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0) + IFNULL(t.tzwc3,0) + IFNULL(t.tzwc4,0)) </if>
			 * IFNULL(t.szgq,0)  / 100) DESC) AS bjqytzpm 
		FROM
			(
		SELECT
			tb1.project_id,
			tb1.project_short_name,
			tb3.tzwcbq,
			tb4.szgq,
			<if test="quarter == '1'.toString()">  tb5.tzwc1, </if>
			<if test="quarter == '2'.toString()">  tb5.tzwc1,tb5.tzwc2, </if>
			<if test="quarter == '3'.toString()">  tb5.tzwc1,tb5.tzwc2,tb5.tzwc3, </if>  
			<if test="quarter == '4'.toString()">  tb5.tzwc1,tb5.tzwc2,tb5.tzwc3,tb5.tzwc4, </if> 
			QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
			tb5.period_value
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2'
		<where>
			tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4') 
			<if test="projectId != null and projectId != ''" >
		     AND tb1.project_id = #{projectId}
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
		     AND tb1.project_id in (${_parameter.projectIdSql})
		    </if>
		</where>) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			AND t.n = #{periodValue} 
			</if>
			<if test="quarter != null and quarter != ''">
			AND t.jidu &lt;= #{quarter} 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = #{periodValue} 
			</if>
		</where>
		GROUP BY t.project_id 
		HAVING bjqytzbfb IS NOT NULL 
		ORDER BY bjqytzbfb DESC 
		</if>
		
		<if test="dataType == '2'.toString()">
		
		SELECT
			2 as dataType,
			t.project_id,
			t.project_short_name AS short_name,
			SUM( t.ygjjtwcjafbq )
			/ 
			<if test="quarter == '1'.toString()">  t.yjgjtwcja1 </if>
			<if test="quarter == '2'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2) </if>
			<if test="quarter == '3'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2 + t.yjgjtwcja3) </if>  
			<if test="quarter == '4'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2 + t.yjgjtwcja3 + t.yjgjtwcja4) </if>
			AS bjjjafbfb,
			RANK() OVER(ORDER BY SUM( t.ygjjtwcjafbq )/ 
			<if test="quarter == '1'.toString()">  t.yjgjtwcja1 </if>
			<if test="quarter == '2'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2) </if>
			<if test="quarter == '3'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2 + t.yjgjtwcja3) </if>  
			<if test="quarter == '4'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2 + t.yjgjtwcja3 + t.yjgjtwcja4) </if> DESC) AS bjjjafpm 
		FROM
			(
		SELECT
			tb1.project_id,
			tb1.project_short_name,
			tb3.ygjjtwcjafbq,
			tb4.szgq,
			<if test="quarter == '1'.toString()">  tb5.yjgjtwcja1, </if>
			<if test="quarter == '2'.toString()">  tb5.yjgjtwcja1,tb5.yjgjtwcja2, </if>
			<if test="quarter == '3'.toString()">  tb5.yjgjtwcja1,tb5.yjgjtwcja2,tb5.yjgjtwcja3, </if>  
			<if test="quarter == '4'.toString()">  tb5.yjgjtwcja1,tb5.yjgjtwcja2,tb5.yjgjtwcja3,tb5.yjgjtwcja4, </if> 
			QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
			tb5.period_value
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2'
		<where>
			tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4') 
			<if test="projectId != null and projectId != ''" >
		     AND tb1.project_id = #{projectId}
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
		     AND tb1.project_id in (${_parameter.projectIdSql})
		    </if>
		</where>) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			AND t.n = #{periodValue} 
			</if>
			<if test="quarter != null and quarter != ''">
			AND t.jidu &lt;= #{quarter} 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = #{periodValue} 
			</if>
		</where>
		GROUP BY t.project_id 
		HAVING bjjjafbfb IS NOT NULL 
		ORDER BY bjjjafbfb DESC 
		
		</if>
		
		
		<if test="dataType == '3'.toString()">
		
		SELECT
			3 as dataType, 
			t.project_id,
			t.project_short_name AS short_name,
			SUM( t.tzwcbq ) 
			/
			t.tzwcxj AS bnztzbfb,
			RANK() OVER(ORDER BY SUM( t.tzwcbq )/ t.tzwcxj DESC) AS pmztz 
		FROM
			(
		SELECT
			tb1.project_id,
			tb1.project_short_name,
			tb3.tzwcbq,
			tb4.szgq,
			tb5.tzwc1+tb5.tzwc2+tb5.tzwc3+tb5.tzwc4 AS tzwcxj,
			QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
			tb5.period_value 
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2'
		<where>
			tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4') 
			<if test="projectId != null and projectId != ''" >
		     AND tb1.project_id = #{projectId}
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
		     AND tb1.project_id in (${_parameter.projectIdSql})
		    </if>
		</where> 
			) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			AND t.n = #{periodValue} 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = #{periodValue} 
			</if>
		</where> 
		GROUP BY t.project_id 
		HAVING bnztzbfb IS NOT NULL 
		ORDER BY bnztzbfb DESC 
	
		</if>
		
  </select>
  <!--  -->
  <select id="selectHomeProgressWarningCheckingNotAdmin" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
  <if test="dataType == '1'.toString()">
		SELECT
			p.dataType,
			p.project_id,
			p.short_name,
			p.bjqytzbfb,
			p.bjqytzpm
		FROM
		(SELECT
			1 as dataType,
			t.project_id,
			t.project_short_name AS short_name, 
			(SUM( t.tzwcbq ) * t.szgq / 100) 
			/ 
			(<if test="quarter == '1'.toString()"> IFNULL(t.tzwc1,0) </if>
			<if test="quarter == '2'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0)) </if>
			<if test="quarter == '3'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0) + IFNULL(t.tzwc3,0)) </if>  
			<if test="quarter == '4'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0) + IFNULL(t.tzwc3,0) + IFNULL(t.tzwc4,0)) </if>
			 * t.szgq / 100) AS bjqytzbfb, 
			 RANK() OVER(ORDER BY (SUM( IFNULL(t.tzwcbq,0)  ) * IFNULL(t.szgq,0)  / 100 )/ 
			 
			 (
			 <if test="quarter == '1'.toString()">  IFNULL(t.tzwc1,0) </if>
			 <if test="quarter == '2'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0)) </if>
			 <if test="quarter == '3'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0) + IFNULL(t.tzwc3,0)) </if>
			 <if test="quarter == '4'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0) + IFNULL(t.tzwc3,0) + IFNULL(t.tzwc4,0)) </if>
			 * IFNULL(t.szgq,0)  / 100) DESC) AS bjqytzpm 
		FROM
			(
		SELECT
			tb1.project_id,
			tb1.project_short_name,
			tb3.tzwcbq,
			tb4.szgq,
			<if test="quarter == '1'.toString()">  tb5.tzwc1, </if>
			<if test="quarter == '2'.toString()">  tb5.tzwc1,tb5.tzwc2, </if>
			<if test="quarter == '3'.toString()">  tb5.tzwc1,tb5.tzwc2,tb5.tzwc3, </if>  
			<if test="quarter == '4'.toString()">  tb5.tzwc1,tb5.tzwc2,tb5.tzwc3,tb5.tzwc4, </if> 
			QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
			tb5.period_value
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2'
		<where>
			tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4') 
		</where>) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			AND t.n = #{periodValue} 
			</if>
			<if test="quarter != null and quarter != ''">
			AND t.jidu &lt;= #{quarter} 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = #{periodValue} 
			</if>
		</where>
		GROUP BY t.project_id 
		HAVING bjqytzbfb IS NOT NULL
		ORDER BY bjqytzbfb DESC ) p
		<where>
			<if test="projectId != null and projectId != ''" >
		     AND p.project_id = #{projectId}
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
		     AND p.project_id in (${_parameter.projectIdSql})
		    </if>
		</where>
		
		</if>
		
		<if test="dataType == '2'.toString()">
		SELECT
			p.dataType,
			p.project_id,
			p.short_name,
			p.bjjjafbfb,
			p.bjjjafpm
		FROM
		(SELECT
			2 as dataType,
			t.project_id,
			t.project_short_name AS short_name,
			SUM( t.ygjjtwcjafbq )
			/ 
			<if test="quarter == '1'.toString()">  t.yjgjtwcja1 </if>
			<if test="quarter == '2'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2) </if>
			<if test="quarter == '3'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2 + t.yjgjtwcja3) </if>  
			<if test="quarter == '4'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2 + t.yjgjtwcja3 + t.yjgjtwcja4) </if>
			AS bjjjafbfb,
			RANK() OVER(ORDER BY SUM( t.ygjjtwcjafbq )/ 
			<if test="quarter == '1'.toString()">  t.yjgjtwcja1 </if>
			<if test="quarter == '2'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2) </if>
			<if test="quarter == '3'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2 + t.yjgjtwcja3) </if>  
			<if test="quarter == '4'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2 + t.yjgjtwcja3 + t.yjgjtwcja4) </if> DESC) AS bjjjafpm 
		FROM
			(
		SELECT
			tb1.project_id,
			tb1.project_short_name,
			tb3.ygjjtwcjafbq,
			tb4.szgq,
			<if test="quarter == '1'.toString()">  tb5.yjgjtwcja1, </if>
			<if test="quarter == '2'.toString()">  tb5.yjgjtwcja1,tb5.yjgjtwcja2, </if>
			<if test="quarter == '3'.toString()">  tb5.yjgjtwcja1,tb5.yjgjtwcja2,tb5.yjgjtwcja3, </if>  
			<if test="quarter == '4'.toString()">  tb5.yjgjtwcja1,tb5.yjgjtwcja2,tb5.yjgjtwcja3,tb5.yjgjtwcja4, </if> 
			QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
			tb5.period_value
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2'
		<where>
			tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4') 
		</where>) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			AND t.n = #{periodValue} 
			</if>
			<if test="quarter != null and quarter != ''">
			AND t.jidu &lt;= #{quarter} 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = #{periodValue} 
			</if>
		</where>
		GROUP BY t.project_id 
		HAVING bjjjafbfb IS NOT NULL
		ORDER BY bjjjafbfb DESC) p
		<where>
			<if test="projectId != null and projectId != ''" >
		     AND p.project_id = #{projectId}
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
		     AND p.project_id in (${_parameter.projectIdSql})
		    </if>
		</where> 
		
		</if>
		
		
		<if test="dataType == '3'.toString()">
		SELECT
			p.dataType,
			p.project_id,
			p.short_name,
			p.bnztzbfb,
			p.pmztz
		FROM
		(SELECT
			3 as dataType, 
			t.project_id,
			t.project_short_name AS short_name,
			SUM( t.tzwcbq ) 
			/
			t.tzwcxj AS bnztzbfb,
			RANK() OVER(ORDER BY SUM( t.tzwcbq )/ t.tzwcxj DESC) AS pmztz 
		FROM
			(
		SELECT
			tb1.project_id,
			tb1.project_short_name,
			tb3.tzwcbq,
			tb4.szgq,
			tb5.tzwc1+tb5.tzwc2+tb5.tzwc3+tb5.tzwc4 AS tzwcxj,
			QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
			tb5.period_value 
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2'
		<where>
			tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4') 
		</where> 
			) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			AND t.n = #{periodValue} 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = #{periodValue} 
			</if>
		</where> 
		GROUP BY t.project_id 
		HAVING bnztzbfb IS NOT NULL
		ORDER BY bnztzbfb DESC) p
		<where>
			<if test="projectId != null and projectId != ''" >
		     AND p.project_id = #{projectId}
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
		     AND p.project_id in (${_parameter.projectIdSql})
		    </if>
		</where>  
	
		</if>
  </select>
  
  <!--  -->
  <select id="selectHomeProgressWarningCheckingSj" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
		<if test="dataType == '1'.toString()">
		
		<if test="quarter != null and quarter != '' and quarter == '1'.toString()">
		SELECT
			p.sjqytzpm 
		FROM
			(
		SELECT
			t.project_id,
			(SUM( t.tzwcbq ) * t.szgq / 100) 
			/ 
			(t.tzwcxj * t.szgq / 100) AS snqytzbfb, 
			 RANK() OVER(ORDER BY (SUM( IFNULL(t.tzwcbq,0)  ) * IFNULL(t.szgq,0)  / 100 )/ 
			 (t.tzwcxj * t.szgq / 100) DESC) AS sjqytzpm 
		FROM
			(
		SELECT
			tb1.project_id,
			tb3.tzwcbq,
			tb4.szgq,
			tb5.tzwc1+tb5.tzwc2+tb5.tzwc3+tb5.tzwc4 AS tzwcxj,
			QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
			tb5.period_value 
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2'
		<where>
			tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4') 
		</where> 
			) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			AND t.n = CAST(#{periodValue} AS SIGNED) - 1 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = CAST(#{periodValue} AS SIGNED) - 1 
			</if>
		</where> 
		GROUP BY t.project_id 
		ORDER BY snqytzbfb DESC 
			) AS p 
		<where>
		<if test="projectId != null and projectId != ''" >
	      p.project_id = #{projectId}
		</if>
		</where>
		
		</if>
		
		<if test="quarter != null and quarter != '' and quarter != '1'.toString()">
		SELECT
			p.sjqytzpm 
		FROM
			(
		SELECT
			t.project_id,
			(SUM( t.tzwcbq ) * t.szgq / 100) 
			/ 
			(<if test="quarter == '2'.toString()">  IFNULL(t.tzwc1,0) </if>
			<if test="quarter == '3'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0)) </if>  
			<if test="quarter == '4'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0) + IFNULL(t.tzwc3,0)) </if>
			 * t.szgq / 100) AS sjqytzbfb, 
			 RANK() OVER(ORDER BY (SUM( IFNULL(t.tzwcbq,0)  ) * IFNULL(t.szgq,0)  / 100 )/ 
			 
			 (
			 <if test="quarter == '2'.toString()">  IFNULL(t.tzwc1,0) </if>
			 <if test="quarter == '3'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0)) </if>
			 <if test="quarter == '4'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0) + IFNULL(t.tzwc3,0)) </if>
			 * IFNULL(t.szgq,0)  / 100) DESC) AS sjqytzpm 
		FROM
			(
		SELECT
			tb1.project_id,
			tb3.tzwcbq,
			tb4.szgq,
			<if test="quarter == '2'.toString()">  tb5.tzwc1, </if>
			<if test="quarter == '3'.toString()">  tb5.tzwc1,tb5.tzwc2, </if>  
			<if test="quarter == '4'.toString()">  tb5.tzwc1,tb5.tzwc2,tb5.tzwc3, </if> 
			QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
			tb5.period_value 
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2'
		<where>
			tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4') 
		</where>) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			AND t.n = #{periodValue} 
			</if>
			<if test="quarter != null and quarter != ''">
			AND t.jidu &lt;= CAST(#{quarter} AS SIGNED) - 1 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = #{periodValue} 
			</if>
		</where>
		GROUP BY t.project_id 
		ORDER BY sjqytzbfb DESC 
			) AS p 
		<where>
		<if test="projectId != null and projectId != ''" >
	      p.project_id = #{projectId}
		</if>
		</where>
		
		</if> 
		
		</if>
		
		<if test="dataType == '2'.toString()">
		
		<if test="quarter != null and quarter != '' and quarter == '1'.toString()">
		SELECT
			p.sjjjafpm 
		FROM
			(
		SELECT
			t.project_id,
			SUM( t.ygjjtwcjafbq ) 
			/
			t.yjgjtwcjaxj AS snjjafbfb,
			RANK() OVER(ORDER BY SUM( t.ygjjtwcjafbq )/ t.yjgjtwcjaxj DESC) AS sjjjafpm 
		FROM
			(
		SELECT
			tb1.project_id,
			tb3.ygjjtwcjafbq,
			tb4.szgq,
			tb5.yjgjtwcjaxj, 
			QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
			tb5.period_value 
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2'
		<where>
			tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4') 
		</where>
			) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			AND t.n = CAST(#{periodValue} AS SIGNED) - 1 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = CAST(#{periodValue} AS SIGNED) - 1
			</if>
		</where> 
		GROUP BY t.project_id 
		ORDER BY snjjafbfb DESC 
			) AS p 
		<where>
		<if test="projectId != null and projectId != ''" >
	      p.project_id = #{projectId}
		</if>
		</where>
		
		</if>
		
		<if test="quarter != null and quarter != '' and quarter != '1'.toString()">
		SELECT
			p.sjjjafpm 
		FROM
			(
		SELECT
			t.project_id,
			SUM( t.ygjjtwcjafbq )
			/ 
			<if test="quarter == '2'.toString()">  t.yjgjtwcja1 </if>
			<if test="quarter == '3'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2) </if>  
			<if test="quarter == '4'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2 + t.yjgjtwcja3) </if>
			AS sjjjafbfb,
			RANK() OVER(ORDER BY SUM( t.ygjjtwcjafbq )/ 
			<if test="quarter == '2'.toString()">  t.yjgjtwcja1 </if>
			<if test="quarter == '3'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2) </if>  
			<if test="quarter == '4'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2 + t.yjgjtwcja3) </if> DESC) AS sjjjafpm 
		FROM
			(
		SELECT
			tb1.project_id,
			tb3.ygjjtwcjafbq,
			tb4.szgq,
			<if test="quarter == '2'.toString()">  tb5.yjgjtwcja1,</if>
			<if test="quarter == '3'.toString()">  tb5.yjgjtwcja1,tb5.yjgjtwcja2,</if>  
			<if test="quarter == '4'.toString()">  tb5.yjgjtwcja1,tb5.yjgjtwcja2,tb5.yjgjtwcja3, </if> 
			QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
			tb5.period_value 
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2'
		<where>
			tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4') 
		</where>) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			AND t.n = #{periodValue} 
			</if>
			<if test="quarter != null and quarter != ''">
			AND t.jidu &lt;= CAST(#{quarter} AS SIGNED) - 1 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = #{periodValue}
			</if>
		</where>
		GROUP BY t.project_id 
		ORDER BY sjjjafbfb DESC 
			)AS p 
		<where>
		<if test="projectId != null and projectId != ''" >
	      p.project_id = #{projectId}
		</if>
		</where>
		
		</if> 
		
		</if>
  </select>
  <!--  -->
  <select id="selectHomeProgressWarningCompleteStatusAdmin" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
	 SELECT
		IFNULL(SUM(IFNULL(qytzwcbq,0)),0) AS qytzwcbn,
		IFNULL((SELECT IFNULL(bnjhqytz,0)    FROM pro_inv_jndjh 
		<where>
		<if test="periodValue != null and periodValue != ''">
		period_value = #{periodValue}
		</if>
		</where>),0)  AS bnjhwcqytz,
		IFNULL(SUM( IFNULL(ygjjtwcjafbq,0) + IFNULL(ygjwcbqJGC,0)),0)  AS ygjjtwcjafbn,
		IFNULL((SELECT IFNULL(bnjhjjaf,0)    FROM pro_inv_jndjh 
		<where>
		<if test="periodValue != null and periodValue != ''">
		period_value = #{periodValue}
		</if>
		</where>),0) AS ygjbnjhwcja 
	FROM
	    zj_tz_pro_manage t1
	LEFT JOIN pro_inv_basic t2 ON t2.project_id = t1.project_id
	AND t2.del_flag = '0'
	LEFT JOIN pro_inv_xmtzqk t3 ON t3.inv_pro_id = t2.id
	AND t3.del_flag = '0'
	LEFT JOIN pro_inv_com_inf t4 ON t4.inv_pro_id = t2.id
	AND t4.del_flag = '0'
	<where>
		t1.del_flag = '0' AND t1.project_type = '0'
		<if test="projectId != null and projectId != ''" >
		AND	t1.project_id = #{projectId}
		</if>
		<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	    AND t1.project_id in (${projectIdSql})
	    </if> 
		<if test="periodValue != null and periodValue != ''" >
		AND t3.period_value BETWEEN CONCAT(#{periodValue},'01') AND DATE_FORMAT(date_add(now(),interval-1 month),'%Y%m') 
		</if>
	</where>
  </select>
  
  <!--  -->
  <select id="selectHomeProgressWarningCompleteStatusNotAdmin" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
	SELECT 
		SUM(
		(
		IFNULL( tzwc1, 0 ) + IFNULL( tzwc2, 0 ) + IFNULL( tzwc3, 0 ) + IFNULL( tzwc4, 0 ) 
		) * CAST( IFNULL( szgq, 0 ) AS DECIMAL ( 30, 2 ) ) / 100 
		) AS bnjhwcqytz,
		SUM( IFNULL( yjgjtwcjaxj, 0 ) ) AS ygjbnjhwcja 
	FROM
		zj_tz_pro_manage t1
        LEFT JOIN pro_inv_basic t2 ON t2.project_id = t1.project_id and t2.del_flag = '0'
        LEFT JOIN pro_inv_com_inf t3 ON t3.inv_pro_id = t2.id and t3.del_flag = '0'
        LEFT JOIN pro_inv_xmndtzjh t4 ON t4.xmid = t2.id
	<where>
		t1.del_flag = '0' AND t1.project_type = '0' 
		<if test="periodValue != null and periodValue != ''">
		AND t4.period_value = #{periodValue}
		</if>
		<if test="projectId != null and projectId != ''" >
		AND	t1.project_id = #{projectId}
		</if>
		<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	    AND t1.project_id in (${projectIdSql})
	    </if> 
	</where>
  </select>
  
  <!--  -->
  <select id="selectHomeChartComnameStatis" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
  	SELECT
  		t1.company_id,
		t1.company_name AS comname
		<if test="tjType != null and tjType == '1'.toString()">
		, 1 AS tjType
		,( SELECT COUNT( t2.project_id ) FROM zj_tz_pro_manage t2 WHERE t2.del_flag = '0' and t2.project_type = '0' and t2.company_id = t1.company_id ) AS count
		</if>
		<if test="tjType != null and tjType == '2'.toString()">
		, 2 AS tjType
		,(
			SELECT
				SUM( TABLE1.hte ) 
			FROM
				(
				(
			SELECT
				t4.company_id,
				IFNULL( t1.bcjaf_money, 0 ) + IFNULL( t1.bcjlf_money, 0 ) + IFNULL( t1.bczcf_money, 0 ) + IFNULL( t1.bcglf_money, 0 ) + IFNULL( t1.bcccsjf_money, 0 ) + IFNULL( t1.bcoth_money, 0 ) AS hte 
			FROM
				pro_inv_bgbcxy t1
				INNER JOIN pro_inv_ht_info t2 ON t2.id = t1.inv_htinfo_id 
				AND t2.del_flag = '0'
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' AND DATE_FORMAT( t4.sign_date1, '%Y%m' ) &lt;= #{periodValue}
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t1.bcxyqd_date, '%Y%m' ) &lt;= #{periodValue}
			</if>
			</where>
				) UNION ALL
				(
			SELECT
				t4.company_id,
				IFNULL( t2.ztze, 0 ) AS hte 
			FROM
				pro_inv_ht_info t2
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' AND DATE_FORMAT( t4.sign_date1, '%Y%m' ) &lt;= #{periodValue}
			<where>
			t2.del_flag = '0' 
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t2.htqd_date, '%Y%m' ) &lt;= #{periodValue} 
			</if>
			</where>
				) 
				) AS TABLE1
			WHERE TABLE1.company_id = t1.company_id )	AS xmzht
		</if>
		<if test="tjType != null and tjType == '3'.toString()">
		, 3 AS tjType
		,(
			SELECT
				SUM( TABLE1.jaf ) 
			FROM
				(
				(
			SELECT
				t4.company_id,
				IFNULL( t1.bcjaf_money, 0 ) AS jaf 
			FROM
				pro_inv_bgbcxy t1
				INNER JOIN pro_inv_ht_info t2 ON t2.id = t1.inv_htinfo_id 
				AND t2.del_flag = '0'
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' AND DATE_FORMAT( t4.sign_date1, '%Y%m' ) &lt;= #{periodValue}
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t1.bcxyqd_date, '%Y%m' ) &lt;= #{periodValue}
			</if>
			</where>
				) UNION ALL
				(
			SELECT
				t4.company_id,
				IFNULL( t2.jaf_money, 0 ) AS jaf 
			FROM
				pro_inv_ht_info t2
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' AND DATE_FORMAT( t4.sign_date1, '%Y%m' ) &lt;= #{periodValue}
			<where>
			t2.del_flag = '0' 
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t2.htqd_date, '%Y%m' ) &lt;= #{periodValue} 
			</if>
			</where>
				) 
				) AS TABLE1
			WHERE TABLE1.company_id = t1.company_id ) AS xmzja 
		</if>
	FROM
		zj_tz_pro_manage t1 
	<where>
		t1.del_flag = '0' and t1.project_type = '0'
		<if test="projectId != null and projectId != ''" >
		AND	t1.project_id = #{projectId}
		</if>
		<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	    AND t1.project_id in (${projectIdSql})
	    </if> 
	</where>
		GROUP BY
			t1.company_name 
	ORDER BY
		( t1.sort1 + 0 ) ASC
  </select>
  <!-- - -->
  <select id="selectHomeChartTrendData" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
  		SELECT
			<if test="data == '1'.toString()">
			(SELECT TRUNCATE(SUM(IFNULL(tzwcbq,0))/10000,2) FROM pro_inv_xmtzqk t1 
			LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
			LEFT JOIN zj_tz_pro_manage t3 ON t3.project_id = t2.project_id and t3.del_flag = '0' and t3.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t3.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t3.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND SUBSTR( t1.period_value, 1, 4 ) = #{periodValue}
			</if>
			</where>) AS tzwcbn,
			(SELECT TRUNCATE(SUM(IFNULL(qytzwcbq,0))/10000,2) FROM pro_inv_xmtzqk t1 
			LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
			LEFT JOIN zj_tz_pro_manage t3 ON t3.project_id = t2.project_id and t3.del_flag = '0' and t3.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t3.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t3.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND SUBSTR( t1.period_value, 1, 4 ) = #{periodValue}
			</if>
			</where>) AS qytzwcbn,
			
			(
			SELECT
				SUM( TABLE1.hte ) 
			FROM
				(
				(
			SELECT
				t4.project_id,
				IFNULL( t1.bcjaf_money, 0 ) + IFNULL( t1.bcjlf_money, 0 ) + IFNULL( t1.bczcf_money, 0 ) + IFNULL( t1.bcglf_money, 0 ) + IFNULL( t1.bcccsjf_money, 0 ) + IFNULL( t1.bcoth_money, 0 ) AS hte 
			FROM
				pro_inv_bgbcxy t1
				INNER JOIN pro_inv_ht_info t2 ON t2.id = t1.inv_htinfo_id 
				AND t2.del_flag = '0'
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t1.bcxyqd_date, '%Y' ) = #{periodValue}
			</if>
			</where>
				) UNION ALL
				(
			SELECT
				t4.project_id,
				IFNULL( t2.ztze, 0 ) AS hte 
			FROM
				pro_inv_ht_info t2
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t2.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t2.htqd_date, '%Y' ) = #{periodValue} 
			</if>
			</where>
				) 
				) AS TABLE1
							
			) AS bnamount1,
			
			SUM( (
			SELECT
				SUM( TABLE1.hte ) 
			FROM
				(
				(
			SELECT
				t4.project_id,
				IFNULL( t1.bcjaf_money, 0 ) + IFNULL( t1.bcjlf_money, 0 ) + IFNULL( t1.bczcf_money, 0 ) + IFNULL( t1.bcglf_money, 0 ) + IFNULL( t1.bcccsjf_money, 0 ) + IFNULL( t1.bcoth_money, 0 ) AS hte 
			FROM
				pro_inv_bgbcxy t1
				INNER JOIN pro_inv_ht_info t2 ON t2.id = t1.inv_htinfo_id 
				AND t2.del_flag = '0'
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t1.bcxyqd_date, '%Y' ) = #{periodValue}
			</if>
			</where>
				) UNION ALL
				(
			SELECT
				t4.project_id,
				IFNULL( t2.ztze, 0 ) AS hte 
			FROM
				pro_inv_ht_info t2
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t2.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t2.htqd_date, '%Y' ) = #{periodValue} 
			</if>
			</where>
				) 
				) AS TABLE1
			WHERE TABLE1.project_id = t3.project_id )		
			* ( SELECT IFNULL(company7,0)  FROM zj_tz_pro_manage tb1 WHERE tb1.del_flag = '0' AND tb1.project_id = t3.project_id ) / 100
			) AS bnamount2,
			
			(SELECT SUM(tzwcbq) FROM pro_inv_xmtzqk t1 
			LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
			LEFT JOIN zj_tz_pro_manage t3 ON t3.project_id = t2.project_id and t3.del_flag = '0' and t3.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t3.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t3.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND SUBSTR( t1.period_value, 1, 4 ) = #{periodValue}
			</if>
			</where>)
			/
			(SELECT SUM(tzwcbq) FROM pro_inv_xmtzqk t1 
			LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
			LEFT JOIN zj_tz_pro_manage t3 ON t3.project_id = t2.project_id and t3.del_flag = '0' and t3.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t3.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t3.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND SUBSTR( t1.period_value, 1, 4 ) = CAST(#{periodValue} AS SIGNED) -1
			</if>
			</where>)-1 AS tbtzwc,
			
			(SELECT SUM(IFNULL(qytzwcbq,0)) FROM pro_inv_xmtzqk t1 
			LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
			LEFT JOIN zj_tz_pro_manage t3 ON t3.project_id = t2.project_id and t3.del_flag = '0' and t3.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t3.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t3.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND SUBSTR( t1.period_value, 1, 4 ) = #{periodValue}
			</if>
			</where>)/
			(SELECT SUM(qytzwcbq) FROM pro_inv_xmtzqk t1 
			LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
			LEFT JOIN zj_tz_pro_manage t3 ON t3.project_id = t2.project_id and t3.del_flag = '0' and t3.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t3.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t3.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND SUBSTR( t1.period_value, 1, 4 ) = CAST(#{periodValue} AS SIGNED) -1
			</if>
			</where>)-1 AS tbqytzwc,
			
			(
			SELECT
				SUM( TABLE1.hte ) 
			FROM
				(
				(
			SELECT
				t4.project_id,
				IFNULL( t1.bcjaf_money, 0 ) + IFNULL( t1.bcjlf_money, 0 ) + IFNULL( t1.bczcf_money, 0 ) + IFNULL( t1.bcglf_money, 0 ) + IFNULL( t1.bcccsjf_money, 0 ) + IFNULL( t1.bcoth_money, 0 ) AS hte 
			FROM
				pro_inv_bgbcxy t1
				INNER JOIN pro_inv_ht_info t2 ON t2.id = t1.inv_htinfo_id 
				AND t2.del_flag = '0'
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t1.bcxyqd_date, '%Y' ) = #{periodValue}
			</if>
			</where>
				) UNION ALL
				(
			SELECT
				t4.project_id,
				IFNULL( t2.ztze, 0 ) AS hte 
			FROM
				pro_inv_ht_info t2
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t2.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t2.htqd_date, '%Y' ) = #{periodValue} 
			</if>
			</where>
				) 
				) AS TABLE1
							
			)
				/
			(
			SELECT
				SUM( TABLE1.hte ) 
			FROM
				(
				(
			SELECT
				t4.project_id,
				IFNULL( t1.bcjaf_money, 0 ) + IFNULL( t1.bcjlf_money, 0 ) + IFNULL( t1.bczcf_money, 0 ) + IFNULL( t1.bcglf_money, 0 ) + IFNULL( t1.bcccsjf_money, 0 ) + IFNULL( t1.bcoth_money, 0 ) AS hte 
			FROM
				pro_inv_bgbcxy t1
				INNER JOIN pro_inv_ht_info t2 ON t2.id = t1.inv_htinfo_id 
				AND t2.del_flag = '0'
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t1.bcxyqd_date, '%Y' ) = CAST(#{periodValue} AS SIGNED) -1
			</if>
			</where>
				) UNION ALL
				(
			SELECT
				t4.project_id,
				IFNULL( t2.ztze, 0 ) AS hte 
			FROM
				pro_inv_ht_info t2
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t2.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t2.htqd_date, '%Y' ) = CAST(#{periodValue} AS SIGNED) -1 
			</if>
			</where>
				) 
				) AS TABLE1
							
			) - 1 AS tbamount,
			
			
			SUM( (
			SELECT
				SUM( TABLE1.hte ) 
			FROM
				(
				(
			SELECT
				t4.project_id,
				IFNULL( t1.bcjaf_money, 0 ) + IFNULL( t1.bcjlf_money, 0 ) + IFNULL( t1.bczcf_money, 0 ) + IFNULL( t1.bcglf_money, 0 ) + IFNULL( t1.bcccsjf_money, 0 ) + IFNULL( t1.bcoth_money, 0 ) AS hte 
			FROM
				pro_inv_bgbcxy t1
				INNER JOIN pro_inv_ht_info t2 ON t2.id = t1.inv_htinfo_id 
				AND t2.del_flag = '0'
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t1.bcxyqd_date, '%Y' ) = #{periodValue}
			</if>
			</where>
				) UNION ALL
				(
			SELECT
				t4.project_id,
				IFNULL( t2.ztze, 0 ) AS hte 
			FROM
				pro_inv_ht_info t2
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t2.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t2.htqd_date, '%Y' ) = #{periodValue} 
			</if>
			</where>
				) 
				) AS TABLE1
			WHERE TABLE1.project_id = t3.project_id )		
			* ( SELECT IFNULL(company7,0)  FROM zj_tz_pro_manage tb1 WHERE tb1.del_flag = '0' AND tb1.project_id = t3.project_id ) / 100
			)
			
			/
			SUM( (
			SELECT
				SUM( TABLE1.hte ) 
			FROM
				(
				(
			SELECT
				t4.project_id,
				IFNULL( t1.bcjaf_money, 0 ) + IFNULL( t1.bcjlf_money, 0 ) + IFNULL( t1.bczcf_money, 0 ) + IFNULL( t1.bcglf_money, 0 ) + IFNULL( t1.bcccsjf_money, 0 ) + IFNULL( t1.bcoth_money, 0 ) AS hte 
			FROM
				pro_inv_bgbcxy t1
				INNER JOIN pro_inv_ht_info t2 ON t2.id = t1.inv_htinfo_id 
				AND t2.del_flag = '0'
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t1.bcxyqd_date, '%Y' ) = CAST(#{periodValue} AS SIGNED) -1
			</if>
			</where>
				) UNION ALL
				(
			SELECT
				t4.project_id,
				IFNULL( t2.ztze, 0 ) AS hte 
			FROM
				pro_inv_ht_info t2
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t2.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t2.htqd_date, '%Y' ) = CAST(#{periodValue} AS SIGNED) -1
			</if>
			</where>
				) 
				) AS TABLE1
			WHERE TABLE1.project_id = t3.project_id )		
			* ( SELECT IFNULL(company7,0)  FROM zj_tz_pro_manage tb1 WHERE tb1.del_flag = '0' AND tb1.project_id = t3.project_id ) / 100
			) - 1 AS tbqyamount,
			
			</if>
			
			
			<if test="data == '2'.toString()">
			(SELECT TRUNCATE(SUM(IFNULL(tzwcbq,0))/10000,2) FROM pro_inv_xmtzqk t1 
			LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
			LEFT JOIN zj_tz_pro_manage t3 ON t3.project_id = t2.project_id and t3.del_flag = '0' and t3.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t3.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t3.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND SUBSTR( t1.period_value, 1, 4 ) &lt;= #{periodValue}
			</if>
			</where>) AS tzwckl,
			(SELECT TRUNCATE(SUM(IFNULL(qytzwcbq,0))/10000,2) FROM pro_inv_xmtzqk t1 
			LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
			LEFT JOIN zj_tz_pro_manage t3 ON t3.project_id = t2.project_id and t3.del_flag = '0' and t3.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t3.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t3.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND SUBSTR( t1.period_value, 1, 4 ) &lt;= #{periodValue}
			</if>
			</where>) AS qytzwckl,
			
			(
			SELECT
				SUM( TABLE1.hte ) 
			FROM
				(
				(
			SELECT
				t4.project_id,
				IFNULL( t1.bcjaf_money, 0 ) + IFNULL( t1.bcjlf_money, 0 ) + IFNULL( t1.bczcf_money, 0 ) + IFNULL( t1.bcglf_money, 0 ) + IFNULL( t1.bcccsjf_money, 0 ) + IFNULL( t1.bcoth_money, 0 ) AS hte 
			FROM
				pro_inv_bgbcxy t1
				INNER JOIN pro_inv_ht_info t2 ON t2.id = t1.inv_htinfo_id 
				AND t2.del_flag = '0'
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t1.bcxyqd_date, '%Y' ) &lt;= #{periodValue}
			</if>
			</where>
				) UNION ALL
				(
			SELECT
				t4.project_id,
				IFNULL( t2.ztze, 0 ) AS hte 
			FROM
				pro_inv_ht_info t2
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t2.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t2.htqd_date, '%Y' ) &lt;= #{periodValue} 
			</if>
			</where>
				) 
				) AS TABLE1
							
			) AS klamount1,
			
			SUM( (
			SELECT
				SUM( TABLE1.hte ) 
			FROM
				(
				(
			SELECT
				t4.project_id,
				IFNULL( t1.bcjaf_money, 0 ) + IFNULL( t1.bcjlf_money, 0 ) + IFNULL( t1.bczcf_money, 0 ) + IFNULL( t1.bcglf_money, 0 ) + IFNULL( t1.bcccsjf_money, 0 ) + IFNULL( t1.bcoth_money, 0 ) AS hte 
			FROM
				pro_inv_bgbcxy t1
				INNER JOIN pro_inv_ht_info t2 ON t2.id = t1.inv_htinfo_id 
				AND t2.del_flag = '0'
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t1.bcxyqd_date, '%Y' ) &lt;= #{periodValue}
			</if>
			</where>
				) UNION ALL
				(
			SELECT
				t4.project_id,
				IFNULL( t2.ztze, 0 ) AS hte 
			FROM
				pro_inv_ht_info t2
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t2.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t2.htqd_date, '%Y' ) &lt;= #{periodValue} 
			</if>
			</where>
				) 
				) AS TABLE1
			WHERE TABLE1.project_id = t3.project_id )		
			* ( SELECT IFNULL(company7,0)  FROM zj_tz_pro_manage tb1 WHERE tb1.del_flag = '0' AND tb1.project_id = t3.project_id ) / 100
			) AS klamount2,
			
			(SELECT TRUNCATE(SUM(IFNULL(tzwcbq,0))/10000,2) FROM pro_inv_xmtzqk t1 
			LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
			LEFT JOIN zj_tz_pro_manage t3 ON t3.project_id = t2.project_id and t3.del_flag = '0' and t3.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t3.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t3.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND SUBSTR( t1.period_value, 1, 4 ) &lt;= #{periodValue}
			</if>
			</where>)/
			(SELECT TRUNCATE(SUM(IFNULL(tzwcbq,0))/10000,2) FROM pro_inv_xmtzqk t1 
			LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
			LEFT JOIN zj_tz_pro_manage t3 ON t3.project_id = t2.project_id and t3.del_flag = '0' and t3.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t3.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t3.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND SUBSTR( t1.period_value, 1, 4 ) &lt;= CAST(#{periodValue} AS SIGNED) -1
			</if>
			</where>)-1 AS tbtzwc,
			
			
			(SELECT TRUNCATE(SUM(IFNULL(qytzwcbq,0))/10000,2) FROM pro_inv_xmtzqk t1 
			LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
			LEFT JOIN zj_tz_pro_manage t3 ON t3.project_id = t2.project_id and t3.del_flag = '0' and t3.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t3.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t3.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND SUBSTR( t1.period_value, 1, 4 ) &lt;= #{periodValue}
			</if>
			</where>)/
			(SELECT TRUNCATE(SUM(IFNULL(qytzwcbq,0))/10000,2) FROM pro_inv_xmtzqk t1 
			LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
			LEFT JOIN zj_tz_pro_manage t3 ON t3.project_id = t2.project_id and t3.del_flag = '0' and t3.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t3.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t3.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND SUBSTR( t1.period_value, 1, 4 ) &lt;= CAST(#{periodValue} AS SIGNED) -1
			</if>
			</where>)-1 AS tbqytzwc,
			
			(
			SELECT
				SUM( TABLE1.hte ) 
			FROM
				(
				(
			SELECT
				t4.project_id,
				IFNULL( t1.bcjaf_money, 0 ) + IFNULL( t1.bcjlf_money, 0 ) + IFNULL( t1.bczcf_money, 0 ) + IFNULL( t1.bcglf_money, 0 ) + IFNULL( t1.bcccsjf_money, 0 ) + IFNULL( t1.bcoth_money, 0 ) AS hte 
			FROM
				pro_inv_bgbcxy t1
				INNER JOIN pro_inv_ht_info t2 ON t2.id = t1.inv_htinfo_id 
				AND t2.del_flag = '0'
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t1.bcxyqd_date, '%Y' ) &lt;= #{periodValue}
			</if>
			</where>
				) UNION ALL
				(
			SELECT
				t4.project_id,
				IFNULL( t2.ztze, 0 ) AS hte 
			FROM
				pro_inv_ht_info t2
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t2.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t2.htqd_date, '%Y' ) &lt;= #{periodValue} 
			</if>
			</where>
				) 
				) AS TABLE1
							
			)
				/
			(
			SELECT
				SUM( TABLE1.hte ) 
			FROM
				(
				(
			SELECT
				t4.project_id,
				IFNULL( t1.bcjaf_money, 0 ) + IFNULL( t1.bcjlf_money, 0 ) + IFNULL( t1.bczcf_money, 0 ) + IFNULL( t1.bcglf_money, 0 ) + IFNULL( t1.bcccsjf_money, 0 ) + IFNULL( t1.bcoth_money, 0 ) AS hte 
			FROM
				pro_inv_bgbcxy t1
				INNER JOIN pro_inv_ht_info t2 ON t2.id = t1.inv_htinfo_id 
				AND t2.del_flag = '0'
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t1.bcxyqd_date, '%Y' ) &lt;= CAST(#{periodValue} AS SIGNED) -1
			</if>
			</where>
				) UNION ALL
				(
			SELECT
				t4.project_id,
				IFNULL( t2.ztze, 0 ) AS hte 
			FROM
				pro_inv_ht_info t2
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t2.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t2.htqd_date, '%Y' ) &lt;= CAST(#{periodValue} AS SIGNED) -1
			</if>
			</where>
				) 
				) AS TABLE1
							
			) - 1 AS tbamount,
			
			
			SUM( (
			SELECT
				SUM( TABLE1.hte ) 
			FROM
				(
				(
			SELECT
				t4.project_id,
				IFNULL( t1.bcjaf_money, 0 ) + IFNULL( t1.bcjlf_money, 0 ) + IFNULL( t1.bczcf_money, 0 ) + IFNULL( t1.bcglf_money, 0 ) + IFNULL( t1.bcccsjf_money, 0 ) + IFNULL( t1.bcoth_money, 0 ) AS hte 
			FROM
				pro_inv_bgbcxy t1
				INNER JOIN pro_inv_ht_info t2 ON t2.id = t1.inv_htinfo_id 
				AND t2.del_flag = '0'
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t1.bcxyqd_date, '%Y' ) &lt;= #{periodValue}
			</if>
			</where>
				) UNION ALL
				(
			SELECT
				t4.project_id,
				IFNULL( t2.ztze, 0 ) AS hte 
			FROM
				pro_inv_ht_info t2
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t2.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t2.htqd_date, '%Y' ) &lt;= #{periodValue} 
			</if>
			</where>
				) 
				) AS TABLE1
			WHERE TABLE1.project_id = t3.project_id )		
			* ( SELECT IFNULL(company7,0)  FROM zj_tz_pro_manage tb1 WHERE tb1.del_flag = '0' AND tb1.project_id = t3.project_id ) / 100
			)
			/
			SUM( (
			SELECT
				SUM( TABLE1.hte ) 
			FROM
				(
				(
			SELECT
				t4.project_id,
				IFNULL( t1.bcjaf_money, 0 ) + IFNULL( t1.bcjlf_money, 0 ) + IFNULL( t1.bczcf_money, 0 ) + IFNULL( t1.bcglf_money, 0 ) + IFNULL( t1.bcccsjf_money, 0 ) + IFNULL( t1.bcoth_money, 0 ) AS hte 
			FROM
				pro_inv_bgbcxy t1
				INNER JOIN pro_inv_ht_info t2 ON t2.id = t1.inv_htinfo_id 
				AND t2.del_flag = '0'
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t1.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t1.bcxyqd_date, '%Y' ) &lt;= CAST(#{periodValue} AS SIGNED) -1
			</if>
			</where>
				) UNION ALL
				(
			SELECT
				t4.project_id,
				IFNULL( t2.ztze, 0 ) AS hte 
			FROM
				pro_inv_ht_info t2
				INNER JOIN pro_inv_basic t3 ON t3.id = t2.inv_pro_id 
				AND t3.del_flag = '0'
				INNER JOIN zj_tz_pro_manage t4 ON t4.project_id = t3.project_id 
				AND t4.del_flag = '0' 
				AND t4.project_type = '0' 
			<where>
			t2.del_flag = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t4.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t4.project_id in (${projectIdSql})
	    	</if>
			<if test="periodValue != null and periodValue != ''">
	 		AND DATE_FORMAT( t2.htqd_date, '%Y' ) &lt;= CAST(#{periodValue} AS SIGNED) -1 
			</if>
			</where>
				) 
				) AS TABLE1
			WHERE TABLE1.project_id = t3.project_id )		
			* ( SELECT IFNULL(company7,0)  FROM zj_tz_pro_manage tb1 WHERE tb1.del_flag = '0' AND tb1.project_id = t3.project_id ) / 100
			) - 1 AS tbqyamount,
			</if>
			1
		FROM
			zj_tz_pro_manage t3
		<where>
			 t3.del_flag = '0' and t3.project_type = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t3.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t3.project_id in (${projectIdSql})
	    	</if>
		</where>
  </select>
  <!-- --/ -->
  <select id="selectHomeRegionalOverviewZhtAndZja" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
	  	SELECT
			SUM(IFNULL(amount1,0)) as zht,
			SUM(IFNULL(amount3,0)) as zja
		FROM
		zj_tz_pro_manage 
	<where>
		del_flag = '0' and project_type = '0'
		<if test="projectId != null and projectId != ''" >
	 	AND zj_tz_pro_manage.project_id = #{projectId} 
		</if>
		<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	    AND zj_tz_pro_manage.project_id in (${projectIdSql})
	    </if>
	</where>
  </select>
  <!-- / -->
  <select id="selectHomeRegionalOverviewTzwcbnAndWcjafbn" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
  	SELECT
		TRUNCATE(SUM( tzwcbq )/10000,2) AS ztzwcbn,
		( SUM( tzwcbq ) / ( SELECT SUM( tzwcbq ) FROM pro_inv_xmtzqk tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.id = tb1.inv_pro_id and tb2.del_flag = '0'
		LEFT JOIN zj_tz_pro_manage tb3 ON tb3.project_id = tb2.project_id and tb3.del_flag = '0' and tb3.project_type = '0'
		<where> 
		tb1.del_flag = '0'	
		<if test="projectId != null and projectId != ''" >
	 	AND tb2.project_id = #{projectId} 
		</if>
		<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	    AND tb2.project_id in (${projectIdSql})
	    </if>
		<if test="periodValue != null and periodValue != ''">
		AND tb1.period_value BETWEEN CONCAT( date_format(DATE_SUB(curdate(), INTERVAL 1 YEAR), '%Y'), '01' ) 
		and CONCAT( date_format(DATE_SUB(curdate(), INTERVAL 1 YEAR), '%Y'), date_format(DATE_SUB(curdate(), INTERVAL 1 MONTH), '%m') )
		</if>
		</where> ) ) - 1 AS tzwcbhl,
		TRUNCATE(SUM( wcjafbq )/10000,2)  AS zwcjafbn,
		( SUM( wcjafbq ) / ( SELECT SUM( wcjafbq ) FROM pro_inv_xmtzqk tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.id = tb1.inv_pro_id and tb2.del_flag = '0'
		LEFT JOIN zj_tz_pro_manage tb3 ON tb3.project_id = tb2.project_id and tb3.del_flag = '0' and tb3.project_type = '0'
		<where> 
		tb1.del_flag = '0'
		<if test="projectId != null and projectId != ''" >
	 	AND tb2.project_id = #{projectId} 
		</if>
		<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	    AND tb2.project_id in (${projectIdSql})
	    </if>
		<if test="periodValue != null and periodValue != ''">
		AND tb1.period_value BETWEEN CONCAT( date_format(DATE_SUB(curdate(), INTERVAL 1 YEAR), '%Y'), '01' ) 
		and CONCAT( date_format(DATE_SUB(curdate(), INTERVAL 1 YEAR), '%Y'), date_format(DATE_SUB(curdate(), INTERVAL 1 MONTH), '%m') )
		</if>
		</where> ) ) - 1 AS wcjafbhl 
	FROM
		pro_inv_xmtzqk t1 
		LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0'
		LEFT JOIN zj_tz_pro_manage t3 ON t3.project_id = t2.project_id and t3.del_flag = '0' and t3.project_type = '0'
	<where>
		t1.del_flag = '0'
		<if test="projectId != null and projectId != ''" >
	 	AND t3.project_id = #{projectId} 
		</if>
		<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	    AND t3.project_id in (${projectIdSql})
	    </if>
		<if test="periodValue != null and periodValue != ''">
		AND t1.period_value BETWEEN CONCAT(#{periodValue},'01') and CONCAT(#{periodValue},date_format(DATE_SUB(curdate(), INTERVAL 1 MONTH), '%m'))
		</if>
	</where>
  </select>
  <!--  -->
  <select id="selectHomeRegionalOverviewCountryMap" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
  	SELECT
		area_name,
		COUNT( project_id ) AS count 
	FROM
		zj_tz_pro_manage t2
		<where>
			t2.del_flag = '0' and t2.project_type = '0'
			<if test="projectId != null and projectId != ''" >
	 		AND t2.project_id = #{projectId} 
			</if>
			<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	AND t2.project_id in (${projectIdSql})
	    	</if>
		</where> 
	GROUP BY
		area_name
  </select>
  <!--  -->
  <select id="selectHomeRegionalOverviewProvinceMap" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
  	SELECT
		TRUNCATE(SUM( tzwcbq )/10000,2) AS tzwckl,
		TRUNCATE(SUM( wcjafbq )/10000,2) AS wcjafkl,
		area_name,
		(
		SELECT
			COUNT(*)
			FROM
			zj_tz_pro_manage tb1
		<where>
			tb1.del_flag = '0' and tb1.project_type = '0'
	    	<if test="areaName != null and areaName != ''">
			and tb1.area_name LIKE concat('%', #{areaName}, '%')
	    	</if>
	    	<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	     	and tb1.project_id in (${projectIdSql})
	    	</if>
		</where>
		) AS invCount 
	FROM
		zj_tz_pro_manage t1
		INNER JOIN pro_inv_basic t2 ON t2.project_id = t1.project_id and t2.del_flag = '0'
		INNER JOIN pro_inv_xmtzqk t3 ON t3.inv_pro_id = t2.id and t3.del_flag = '0'
	<where>
		t1.del_flag = '0' and t1.project_type = '0'
		<if test="areaName != null and areaName != ''">
		and t1.area_name LIKE concat('%', #{areaName}, '%')
		</if>
		<if test="_parameter != null and _parameter.projectIdSql != null and _parameter.projectIdSql != ''">
	    and t1.project_id in (${projectIdSql})
	    </if>
	</where>
  </select>
  <select id="selectAllPeriod" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
  	SELECT
		IFNULL(TRUNCATE(amount1 /10000,2),0)  AS amount1,
		
		
		IFNULL((SELECT TRUNCATE(SUM(IFNULL(tzwcbq,0))/10000,2)  FROM pro_inv_xmtzqk t1 
		LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
		WHERE t1.del_flag = '0' and t2.project_id = #{projectId} ),0)  AS tzwckl,
		
		IFNULL(TRUNCATE(amount1 /10000,2),0) - 
		IFNULL((SELECT TRUNCATE(SUM(IFNULL(tzwcbq,0))/10000,2)  FROM pro_inv_xmtzqk t1 
		LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
		WHERE t1.del_flag = '0' and t2.project_id = #{projectId} ),0) AS wtzwckl,
		
		IFNULL(TRUNCATE(amount3/10000,2),0)  AS amount3,
		
		IFNULL((SELECT TRUNCATE(SUM(IFNULL(wcjafbq,0))/10000,2) FROM pro_inv_xmtzqk t1 
		LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
		WHERE t1.del_flag = '0' and t2.project_id = #{projectId} ),0)  AS wcjafkl,
		
		IFNULL(TRUNCATE(amount3/10000,2),0)-
		IFNULL((SELECT TRUNCATE(SUM(IFNULL(wcjafbq,0))/10000,2) FROM pro_inv_xmtzqk t1 
		LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
		WHERE t1.del_flag = '0' and t2.project_id = #{projectId} ),0) AS wwcjafkl
	
	FROM zj_tz_pro_manage t3  
	<where>
		t3.del_flag = '0' and t3.project_type = '0'
		<if test="projectId != null and projectId != ''">
		and t3.project_id = #{projectId}
		</if>
	</where>
  </select>
  <!--  -->
  <select id="selectConstructPageProduction" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
  	  	SELECT
  	  	tb2.project_id, 

		IFNULL(TRUNCATE((IFNULL(tzwc1,0)+IFNULL(tzwc2,0)+IFNULL(tzwc3,0)+IFNULL(tzwc4,0))/10000,2) ,0) AS bnjhwcztz, 
		
		IFNULL((SELECT TRUNCATE(SUM(IFNULL(tzwcbq,0) )/10000,2) FROM pro_inv_xmtzqk t1 
		LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
		LEFT JOIN zj_tz_pro_manage t3 ON t3.project_id = t2.project_id and t3.del_flag = '0' 
		WHERE t1.del_flag = '0' and t3.pro_process_id = #{param2.proProcessId} 
		and t2.project_id = #{param2.projectId} and SUBSTR(t1.period_value,1,4) = #{param2.periodValue}),0)  AS tzwcbn,
		
		IFNULL(TRUNCATE((IFNULL(tzwc1,0)+IFNULL(tzwc2,0)+IFNULL(tzwc3,0)+IFNULL(tzwc4,0))/10000,2) ,0) 
		-
		IFNULL((SELECT TRUNCATE(SUM(IFNULL(tzwcbq,0) )/10000,2) FROM pro_inv_xmtzqk t1 
		LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
		LEFT JOIN zj_tz_pro_manage t3 ON t3.project_id = t2.project_id and t3.del_flag = '0' 
		WHERE t1.del_flag = '0' and t3.pro_process_id = #{param2.proProcessId}  
		and t2.project_id = #{param2.projectId} and SUBSTR(t1.period_value,1,4) = #{param2.periodValue}),0) AS wtzwcbn,
		
		IFNULL(TRUNCATE(IFNULL(xmztjawcjaxj,0) /10000,2) ,0) AS bnjhwcjaf, 
		
		IFNULL((SELECT TRUNCATE(SUM(IFNULL(wcjafbq,0) )/10000,2) FROM pro_inv_xmtzqk t1 
		LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
		LEFT JOIN zj_tz_pro_manage t3 ON t3.project_id = t2.project_id and t3.del_flag = '0' 
		WHERE t1.del_flag = '0' and t3.pro_process_id = #{param2.proProcessId}  
		and t2.project_id = #{param2.projectId} and SUBSTR(t1.period_value,1,4) = #{param2.periodValue}),0) AS wcjafbn,
		
		
		IFNULL(TRUNCATE(IFNULL(xmztjawcjaxj,0) /10000,2) ,0) 
		-
		IFNULL((SELECT TRUNCATE(SUM(IFNULL(wcjafbq,0) )/10000,2) FROM pro_inv_xmtzqk t1 
		LEFT JOIN pro_inv_basic t2 ON t2.id = t1.inv_pro_id and t2.del_flag = '0' 
		LEFT JOIN zj_tz_pro_manage t3 ON t3.project_id = t2.project_id and t3.del_flag = '0' 
		WHERE t1.del_flag = '0' and t3.pro_process_id = #{param2.proProcessId}  
		and t2.project_id = #{param2.projectId} and SUBSTR(t1.period_value,1,4) = #{param2.periodValue}),0) AS wwcjafbn,
  	  	
		IFNULL( 
		<if test="param2.quarter == '1'.toString()">TRUNCATE(IFNULL(tzwc1,0)/10000,2)</if>
		<if test="param2.quarter == '2'.toString()">TRUNCATE(IFNULL(tzwc2,0)/10000,2)</if>
		<if test="param2.quarter == '3'.toString()">TRUNCATE(IFNULL(tzwc3,0)/10000,2)</if>
		<if test="param2.quarter == '4'.toString()">TRUNCATE(IFNULL(tzwc4,0)/10000,2)</if> 
		,0)  AS jhwcztzbj,
		
		<if test="param1.size() > 0">
		IFNULL((SELECT TRUNCATE(SUM(IFNULL(tzwcbq,0))/10000,2)   FROM pro_inv_xmtzqk t4
		LEFT JOIN pro_inv_basic t5 ON t5.id = t4.inv_pro_id and t5.del_flag = '0'
		LEFT JOIN zj_tz_pro_manage t6 ON t6.project_id = t5.project_id and t6.del_flag = '0'
		WHERE t4.del_flag = '0' and t6.pro_process_id = #{param2.proProcessId} and t5.project_id = #{param2.projectId} AND t4.period_value IN <foreach collection="param1" item = "model" open="(" separator="," close=")">#{model} </foreach>),0)  AS tzwcbj,
		</if>
		
		<if test="param1.size() > 0">
		IFNULL(
		<if test="param2.quarter == '1'.toString()">TRUNCATE(IFNULL(tzwc1,0)/10000,2)</if>
		<if test="param2.quarter == '2'.toString()">TRUNCATE(IFNULL(tzwc2,0)/10000,2)</if>
		<if test="param2.quarter == '3'.toString()">TRUNCATE(IFNULL(tzwc3,0)/10000,2)</if>
		<if test="param2.quarter == '4'.toString()">TRUNCATE(IFNULL(tzwc4,0)/10000,2)</if> 
		,0)
		-
		IFNULL((SELECT TRUNCATE(SUM(IFNULL(tzwcbq,0))/10000,2)   FROM pro_inv_xmtzqk t4
		LEFT JOIN pro_inv_basic t5 ON t5.id = t4.inv_pro_id and t5.del_flag = '0'
		LEFT JOIN zj_tz_pro_manage t6 ON t6.project_id = t5.project_id and t6.del_flag = '0'
		WHERE t4.del_flag = '0' and t6.pro_process_id = #{param2.proProcessId} and 
		t5.project_id = #{param2.projectId} AND t4.period_value IN <foreach collection="param1" item = "model" open="(" separator="," close=")">#{model} </foreach>),0) AS wtzwcbj,
		</if>
		
		
		IFNULL(
		<if test="param2.quarter == '1'.toString()">TRUNCATE(IFNULL(xmztwcja1,0)/10000,2)</if>
		<if test="param2.quarter == '2'.toString()">TRUNCATE(IFNULL(xmztwcja2,0)/10000,2)</if>
		<if test="param2.quarter == '3'.toString()">TRUNCATE(IFNULL(xmztwcja3,0)/10000,2)</if>
		<if test="param2.quarter == '4'.toString()">TRUNCATE(IFNULL(xmztwcja4,0)/10000,2)</if> 
		,0) AS jhwcjafbj
		
		<if test="param1.size() > 0">
		,IFNULL((SELECT TRUNCATE(SUM(IFNULL(wcjafbq,0))/10000,2)   FROM pro_inv_xmtzqk t4
		LEFT JOIN pro_inv_basic t5 ON t5.id = t4.inv_pro_id and t5.del_flag = '0'
		LEFT JOIN zj_tz_pro_manage t6 ON t6.project_id = t5.project_id and t6.del_flag = '0'
		WHERE t4.del_flag = '0' and t6.pro_process_id = #{param2.proProcessId} and 
		t5.project_id = #{param2.projectId} AND t4.period_value IN <foreach collection="param1" item = "model" open="(" separator="," close=")">#{model} </foreach>),0) AS wcjafbj,
		</if>
		
		<if test="param1.size() > 0">
		IFNULL( 
		<if test="param2.quarter == '1'.toString()">TRUNCATE(IFNULL(xmztwcja1,0)/10000,2)</if>
		<if test="param2.quarter == '2'.toString()">TRUNCATE(IFNULL(xmztwcja2,0)/10000,2)</if>
		<if test="param2.quarter == '3'.toString()">TRUNCATE(IFNULL(xmztwcja3,0)/10000,2)</if>
		<if test="param2.quarter == '4'.toString()">TRUNCATE(IFNULL(xmztwcja4,0)/10000,2)</if> 
		,0) 
		-
		IFNULL((SELECT TRUNCATE(SUM(IFNULL(wcjafbq,0))/10000,2)   FROM pro_inv_xmtzqk t4
		LEFT JOIN pro_inv_basic t5 ON t5.id = t4.inv_pro_id and t5.del_flag = '0'
		LEFT JOIN zj_tz_pro_manage t6 ON t6.project_id = t5.project_id and t6.del_flag = '0'
		WHERE t4.del_flag = '0' and t6.pro_process_id = #{param2.proProcessId} and 
		t5.project_id = #{param2.projectId} AND t4.period_value IN <foreach collection="param1" item = "model" open="(" separator="," close=")">#{model} </foreach>),0) AS wwcjafbj
		</if>
		FROM
			pro_inv_xmndtzjh tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.id = tb1.xmid and tb2.del_flag = '0' 
	<where>
		tb1.bbh = '2'
		<if test="param2.projectId != null and param2.projectId != ''">
			and tb2.project_id = #{param2.projectId}
		</if>
		<if test="param2.periodValue != null and param2.periodValue != ''">
			and tb1.period_value =  #{param2.periodValue}
		</if>
	</where>
  </select>
  <select id="selectConstructPageTrendDataByQuarter" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
	SELECT 
		t1.project_id, 
		TRUNCATE(SUM( t3.tzwcbq )/10000,2) AS tzwcbj,
		TRUNCATE(SUM( t3.wcjafbq )/10000,2) AS wcjafbj,
		SUBSTR( t3.period_value, 1, 4 ) AS n, 
		QUARTER ( STR_TO_DATE( concat( t3.period_value, '01' ), '%Y%m%d' ) ) AS jidu 
	FROM zj_tz_pro_manage t1 
	LEFT JOIN pro_inv_basic t2 ON t2.project_id = t1.project_id AND t2.del_flag = '0'
	LEFT JOIN pro_inv_xmtzqk t3 ON t3.inv_pro_id = t2.id AND t3.del_flag = '0' 
	<where>
		t1.del_flag = '0' and t1.project_type = '0' 
		<if test="projectId != null and projectId != ''">
		and t1.project_id = #{projectId}
		</if>
		<if test="periodValue != null and periodValue != ''">
		and SUBSTR( t3.period_value, 1, 4 ) = #{periodValue}
		</if>
	</where> 
	GROUP BY jidu
	ORDER BY jidu
  </select>
  <select id="selectConstructPageTrendDataByYear" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
	SELECT 
		t1.project_id, 
		TRUNCATE(SUM( t3.tzwcbq )/10000,2) AS tzwckl,
		TRUNCATE(SUM( t3.wcjafbq )/10000,2) AS wcjafkl, 
		SUBSTR( t3.period_value, 1, 4 ) AS n
	FROM zj_tz_pro_manage t1 
	LEFT JOIN pro_inv_basic t2 ON t2.project_id = t1.project_id AND t2.del_flag = '0'
	LEFT JOIN pro_inv_xmtzqk t3 ON t3.inv_pro_id = t2.id AND t3.del_flag = '0' 
	<where>
		t1.del_flag = '0' and t1.project_type = '0' 
		<if test="projectId != null and projectId != ''">
		and t1.project_id = #{projectId}
		</if>
		<if test="periodValue != null and periodValue != ''">
		and SUBSTR( t3.period_value, 1, 4 ) &lt;= #{periodValue}
		</if>
	</where>
  </select>
  <!--  -->
  <select id="selectConstructPageProductionRankingQytz" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
  	<if test="quarter != null and quarter != '' and quarter == '1'.toString()">
  	SELECT
			p.sjqytzpm 
		FROM
			(
		SELECT
			t.project_id,
			(SUM( t.tzwcbq ) * t.szgq / 100) 
			/ 
			((IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0) + IFNULL(t.tzwc3,0) + IFNULL(t.tzwc4,0))
			 * t.szgq / 100) AS sjqytzbfb, 
			 RANK() OVER(ORDER BY (SUM( IFNULL(t.tzwcbq,0)  ) * IFNULL(t.szgq,0)  / 100 )/ 
			 
			 (
			(IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0) + IFNULL(t.tzwc3,0) + IFNULL(t.tzwc4,0))
			 * IFNULL(t.szgq,0)  / 100) DESC) AS sjqytzpm 
		FROM
			(
		SELECT
			tb1.project_id,
			tb3.tzwcbq,
			tb4.szgq,
			tb5.tzwc1,tb5.tzwc2,tb5.tzwc3,tb5.tzwc4,
			QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
			tb5.period_value 
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2'
		<where>
			tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4') 
		</where>) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			AND t.n = CAST(#{periodValue} AS SIGNED) - 1 
			</if>
			<if test="quarter != null and quarter != ''">
			AND t.jidu &lt;= 4 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = CAST(#{periodValue} AS SIGNED) - 1  
			</if>
		</where>
		GROUP BY t.project_id
		HAVING sjqytzbfb IS NOT NULL 
		ORDER BY sjqytzbfb DESC 
			) AS p 
		<where>
		<if test="projectId != null and projectId != ''">
			and p.project_id = #{projectId}
		</if>
		</where>
  	
  	</if>
  	<if test="quarter != null and quarter != '' and quarter != '1'.toString()">
  	SELECT
			p.sjqytzpm 
		FROM
			(
		SELECT
			t.project_id,
			(SUM( t.tzwcbq ) * t.szgq / 100) 
			/ 
			(<if test="quarter == '2'.toString()">  IFNULL(t.tzwc1,0) </if>
			<if test="quarter == '3'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0)) </if>  
			<if test="quarter == '4'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0) + IFNULL(t.tzwc3,0)) </if>
			 * t.szgq / 100) AS sjqytzbfb, 
			 RANK() OVER(ORDER BY (SUM( IFNULL(t.tzwcbq,0)  ) * IFNULL(t.szgq,0)  / 100 )/ 
			 
			 (
			 <if test="quarter == '2'.toString()">  IFNULL(t.tzwc1,0) </if>
			 <if test="quarter == '3'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0)) </if>
			 <if test="quarter == '4'.toString()">  (IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0) + IFNULL(t.tzwc3,0)) </if>
			 * IFNULL(t.szgq,0)  / 100) DESC) AS sjqytzpm 
		FROM
			(
		SELECT
			tb1.project_id,
			tb3.tzwcbq,
			tb4.szgq,
			<if test="quarter == '2'.toString()">  tb5.tzwc1, </if>
			<if test="quarter == '3'.toString()">  tb5.tzwc1,tb5.tzwc2, </if>
			<if test="quarter == '4'.toString()">  tb5.tzwc1,tb5.tzwc2, tb5.tzwc3,</if>
			QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
			tb5.period_value 
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2'
		<where>
			tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4') 
		</where>) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			AND t.n = #{periodValue} 
			</if>
			<if test="quarter != null and quarter != ''">
			AND t.jidu &lt;= CAST(#{quarter} AS SIGNED) - 1 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = #{periodValue}  
			</if>
		</where>
		GROUP BY t.project_id
		HAVING sjqytzbfb IS NOT NULL 
		ORDER BY sjqytzbfb DESC 
			) AS p 
	<where>
		<if test="projectId != null and projectId != ''">
			and p.project_id = #{projectId}
		</if>
	</where>
	
	</if>
  </select>
  <!--  -->
  <select id="selectConstructPageProductionRankingJjaf" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
  	<if test="quarter != null and quarter != '' and quarter == '1'.toString() ">
  	SELECT
			p.sjjjafpm 
		FROM
			(
		SELECT
			t.project_id,
			SUM( t.ygjjtwcjafbq )
			/ 
			(t.yjgjtwcja1 + t.yjgjtwcja2 + t.yjgjtwcja3 + t.yjgjtwcja4) 
			AS sjjjafbfb,
			RANK() OVER(ORDER BY SUM( t.ygjjtwcjafbq )/ 
			(t.yjgjtwcja1 + t.yjgjtwcja2 + t.yjgjtwcja3 + t.yjgjtwcja4) DESC) AS sjjjafpm 
		FROM
			(
		SELECT
			tb1.project_id,
			tb3.ygjjtwcjafbq,
			tb4.szgq,
			tb5.yjgjtwcja1,tb5.yjgjtwcja2, tb5.yjgjtwcja3,tb5.yjgjtwcja4,
			QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
			tb5.period_value 
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2'
		<where>
			tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4') 
		</where>) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			AND t.n = CAST(#{periodValue} AS SIGNED) - 1 
			</if>
			<if test="quarter != null and quarter != ''">
			AND t.jidu &lt;= 4 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = CAST(#{periodValue} AS SIGNED) - 1 
			</if>
		</where>
		GROUP BY t.project_id
		HAVING sjjjafbfb IS NOT NULL 
		ORDER BY sjjjafbfb DESC 
			)AS p 
		<where>
		<if test="projectId != null and projectId != ''">
			and p.project_id = #{projectId}
		</if>
		</where>
  	</if>
  	<if test="quarter != null and quarter != '' and quarter != '1'.toString() ">
  	SELECT
			p.sjjjafpm 
		FROM
			(
		SELECT
			t.project_id,
			SUM( t.ygjjtwcjafbq )
			/ 
			<if test="quarter == '2'.toString()">  t.yjgjtwcja1 </if>
			<if test="quarter == '3'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2) </if>  
			<if test="quarter == '4'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2 + t.yjgjtwcja3) </if>
			AS sjjjafbfb,
			RANK() OVER(ORDER BY SUM( t.ygjjtwcjafbq )/ 
			<if test="quarter == '2'.toString()">  t.yjgjtwcja1 </if>
			<if test="quarter == '3'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2) </if>  
			<if test="quarter == '4'.toString()">  (t.yjgjtwcja1 + t.yjgjtwcja2 + t.yjgjtwcja3) </if> DESC) AS sjjjafpm 
		FROM
			(
		SELECT
			tb1.project_id,
			tb3.ygjjtwcjafbq,
			tb4.szgq,
			<if test="quarter == '2'.toString()">  tb5.yjgjtwcja1, </if>
			<if test="quarter == '3'.toString()">  tb5.yjgjtwcja1,tb5.yjgjtwcja2, </if>
			<if test="quarter == '4'.toString()">  tb5.yjgjtwcja1,tb5.yjgjtwcja2,tb5.yjgjtwcja3, </if>
			QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
			YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
			tb5.period_value
		FROM zj_tz_pro_manage tb1 
		LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
		LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
		LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
		LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2'
		<where>
			tb1.del_flag = '0' AND tb1.project_type = '0' AND (tb1.pro_process_id = '2' or tb1.pro_process_id = '3' or tb1.pro_process_id = '4') 
		</where>) AS t 
		<where>
			<if test="periodValue != null and periodValue != ''">
			AND t.n = #{periodValue} 
			</if>
			<if test="quarter != null and quarter != ''">
			AND t.jidu &lt;= CAST(#{quarter} AS SIGNED) - 1 
			</if>
			<if test="periodValue != null and periodValue != ''">
			AND t.period_value = #{periodValue} 
			</if>
		</where>
		GROUP BY t.project_id 
		HAVING sjjjafbfb IS NOT NULL
		ORDER BY sjjjafbfb DESC 
			)AS p 
	<where>
		<if test="projectId != null and projectId != ''">
			and p.project_id = #{projectId}
		</if>
	</where>
	</if>
		
  </select>
  <!--  -->
  <select id="selectProjectPagePlanningWarning" resultMap="BaseResultMap" parameterType="com.apih5.mybatis.pojo.ZjTzInvXmtzqk">
	SELECT
		<if test="quarter != null and quarter != '' and quarter == '1'.toString()">
		IFNULL((SELECT 
			(SUM( t.tzwcbq ) * t.szgq / 100)/
			((IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0) + IFNULL(t.tzwc3,0) + IFNULL(t.tzwc4,0) )* t.szgq / 100)
		FROM 
			(SELECT
					tb1.project_id,
					tb1.project_short_name,
					tb3.tzwcbq,
					tb4.szgq,
					tb5.tzwc1,tb5.tzwc2,tb5.tzwc3,tb5.tzwc4,
					QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
					YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
					tb5.period_value
			FROM zj_tz_pro_manage tb1 
			LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
			LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
			LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
			LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2' 
			<if test="periodValue != null and periodValue != ''">
			and tb5.period_value = CAST(YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) AS SIGNED) - 1 
			</if>
			WHERE tb1.del_flag = '0' AND tb1.project_type = '0' ) AS t
			<where>
				t.project_id = t3.project_id 
				<if test="periodValue != null and periodValue != ''">
				AND t.n = CAST(YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) AS SIGNED) - 1 
				</if>
				<if test="quarter != null and quarter != ''">
				AND t.jidu &lt;= 4
				</if>
			</where>
			),0)  AS bjqytzbfb,
			
		IFNULL((SELECT 
			SUM( t.tzwcbq )/
			IFNULL(t.tzwcxj,0)
		FROM 
			(SELECT
					tb1.project_id,
					tb1.project_short_name,
					tb3.tzwcbq,
					tb4.szgq,
					tb5.tzwc1 + tb5.tzwc2 + tb5.tzwc3 + tb5.tzwc4 AS tzwcxj,
					YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
					tb5.period_value
			FROM zj_tz_pro_manage tb1 
			LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
			LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
			LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
			LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2' 
			<if test="periodValue != null and periodValue != ''">
			and tb5.period_value = YEAR(STR_TO_DATE(#{periodValue},'%Y%m'))
			</if>
			WHERE tb1.del_flag = '0' AND tb1.project_type = '0' ) AS t
			<where>
				t.project_id = t3.project_id 
				<if test="periodValue != null and periodValue != ''">
				AND t.n = YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) 
				</if>
			</where>
			),0) AS snztzbfb,
			
		</if> 
		
		<if test="quarter != null and quarter != '' and quarter != '1'.toString()">
		IFNULL((SELECT 
			(SUM( t.tzwcbq ) * t.szgq / 100)/
			((IFNULL(t.tzwc1,0) + IFNULL(t.tzwc2,0) + IFNULL(t.tzwc3,0) + IFNULL(t.tzwc4,0) )* t.szgq / 100)
		FROM 
			(SELECT
					tb1.project_id,
					tb1.project_short_name,
					tb3.tzwcbq,
					tb4.szgq,
					tb5.tzwc1,tb5.tzwc2,tb5.tzwc3,tb5.tzwc4,
					QUARTER ( STR_TO_DATE( tb3.period_value, '%Y%m' ) ) AS jidu,
					YEAR ( STR_TO_DATE( tb3.period_value, '%Y' ) ) AS n,
					tb5.period_value
			FROM zj_tz_pro_manage tb1 
			LEFT JOIN pro_inv_basic tb2 ON tb2.project_id = tb1.project_id and tb2.del_flag = '0'
			LEFT JOIN pro_inv_xmtzqk tb3 ON tb3.inv_pro_id = tb2.id and tb3.del_flag = '0'
			LEFT JOIN pro_inv_com_inf tb4 ON tb4.inv_pro_id = tb2.id and tb4.del_flag = '0'
			LEFT JOIN pro_inv_xmndtzjh tb5 ON tb5.xmid = tb2.id and tb5.bbh = '2' 
			<if test="periodValue != null and periodValue != ''">
			and tb5.period_value = YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) 
			</if>
			WHERE tb1.del_flag = '0' AND tb1.project_type = '0' ) AS t
			<where>
				t.project_id = t3.project_id 
				<if test="periodValue != null and periodValue != ''">
				AND t.n = YEAR(STR_TO_DATE(#{periodValue},'%Y%m')) 
				</if>
				<if test="quarter != null and quarter != ''">
				AND t.jidu &lt;= CAST(#{quarter} AS SIGNED) - 1
				</if>
			</where>
			),0)  AS bjqytzbfb,
		</if>
		t3.project_id
	FROM
		zj_tz_pro_manage t3 
	<where>
		t3.del_flag = '0' AND t3.project_type = '0'
		<if test="projectId != null and projectId != ''">
		AND t3.project_id = #{projectId}
		</if>
	</where>
  </select>
</mapper>
