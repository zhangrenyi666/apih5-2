(window.webpackJsonp=window.webpackJsonp||[]).push([[173],{"3JR7":function(e,t,a){e.exports={nestedTable:"_1H2Dxa1aypKFV-iDcCr_Kj",tree:"_3rya84gElfyTFu72kDc8D_"}},BF4E:function(e,t,a){"use strict";a.r(t);var n=a("Id3l"),l=a("RNsw"),r=a("OR/T"),o=a("bn5B"),u=a("PnTt"),d=a("r0ML"),c=a.n(d),i=a("fbSu"),s=a.n(i),m=a("5T12"),p=a.n(m),f=a("qHWA"),h=a.n(f),b=a("rx6U"),v=a.n(b),g=a("4tJN"),y=a.n(g),S=a("Qsbb"),E=a.n(S),D=(a("9U97"),a("kO4A"),a("+kFb"),a("FMw2"),a("x/6R"),a("Z5ek"),a("jnfO"),a("zIPO"),a("MRnW"),a("IdsT"),a("GzNv"),a("QifN"),a("l9AF"),a("+xeR"),a("Id6h"),a("orcL"),a("07Zm"),a("2HLw")),x=a("wUJ3"),K=a.n(x),N=a("Wv3C"),U=a.n(N),k=(a("Rdx9"),a("Le+4")),P=(a("K4KN"),a("lOXM")),w=(a("TSXX"),a("iZJp")),M=(a("NExk"),a("ftLu")),I=a("eKXt"),C=a.n(I),T=a("EByn"),V=a.n(T),_=a("qQuN"),O=a.n(_),A=(a("fx2i"),a("cZi0")),L=a("isxb"),B=a.n(L),J=a("wJ7t"),R=a.n(J),F=a("rD0L"),j=a.n(F),z=a("bj0d"),H=a.n(z),W=a("i2ZC"),X=a.n(W),Z=(a("w9C0"),a("XW+2")),Q=(a("j0L1"),a("jgfh")),Y=a("3JR7"),q=a.n(Y),G=a("U32T"),$=(a("YD43"),a("fgI6")),ee=a("5D0v"),te=a.n(ee);function ae(e,t){var a=E()(e);if(y.a){var n=y()(e);t&&(n=n.filter(function(t){return v()(e,t).enumerable})),a.push.apply(a,n)}return a}function ne(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(a),!0).forEach(function(t){O()(e,t,a[t])}):h.a?p()(e,h()(a)):ae(Object(a)).forEach(function(t){s()(e,t,v()(a,t))})}return e}var le=Q.a.Item,re=Z.a.confirm,oe=window.configs.language,ue=void 0===oe?"zh_CN":oe,de="en_US"===ue,ce={AddSubmenu:"en_US"===ue?"Add submenu":"\u65b0\u5efa\u5b50\u83dc\u5355",AddButton:"en_US"===ue?"Add Button":"\u65b0\u5efa\u6309\u94ae",Rename:"en_US"===ue?"Rename":"\u91cd\u547d\u540d",confirm:"en_US"===ue?"confirm":"\u786e\u8ba4",cancel:"en_US"===ue?"cancel":"\u53d6\u6d88",delete:"en_US"===ue?"delete":"\u5220\u9664",save:"en_US"===ue?"save":"\u4fdd\u5b58",placeholder:"en_US"===ue?"please enter...":"\u8bf7\u8f93\u5165...",JSONParseError:"en_US"===ue?"JSON Parse error":"JSON \u89e3\u6790\u5931\u8d25",JSONData:"en_US"===ue?"JSON data":"JSON\u6570\u636e",CannotAddNode:"en_US"===ue?"Cannot be the same as the root node":"\u4e0d\u80fd\u4e0e\u6839\u8282\u70b9\u540c\u7ea7"},ie=function(e){function t(){var e,a;B()(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=j()(this,(e=H()(t)).call.apply(e,[this].concat(l)))).depId=a.props.match.params.depId||"0",a.gData=[],a.modals={},a.visibleValue="",a.endKey=a.depId,a.pageParams={page:1,limit:10},a.inputValue="",a.state={record:{},mData:[],gData:[],rState:"0",selectedRowKeys:[],treeSelectedKeys:[],expandedKeys:[],visibleValue:"",editValue:"",visible:!1,treeK:{label:de?"labelUS":"label",value:"value",children:"children"}},a.loadTree=function(){var e=a.props.myFetch;A.b.loading("loading...",0),e("getSysMenuAllTree").then(function(e){var t=e.success,n=(e.code,e.message,e.data);if(A.b.destroy(),t){a.endKey="0"===a.depId?n.value:a.depId;(n=function e(t){for(var n=0;n<t.length;n++){var l=t[n];l._title=l.title,a.endKey===l.value&&(l.expanded=!0),l.children&&l.children.length&&e(l.children)}return t}([ne({},n)]))[0].expanded=!0,a.gData=n;var l=a.initSimpleData(a.gData),r=a.getBreadcrumb(a.endKey,l).keys;a.setState({record:{menuId:l[a.endKey]&&l[a.endKey].value,menuUrl:l[a.endKey]&&l[a.endKey]._title},gData:V()(a.gData),expandedKeys:r,treeSelectedKeys:[a.endKey]})}})},a.setSelectedRowKeys=function(e){a.setState({selectedRowKeys:e})},a.setPageParams=function(e){a.pageParams=ne({},e),a.loadList().then(function(e,t){a.setState(ne({totalNumber:t,mData:e,rState:"0",loading:!1},a.pageParams))})},a.loadList=function(){var e=a.props.myFetch;a.setState({loading:!0});var t=ne({menuId:a.endKey},a.pageParams);return new C.a(function(a){e("getSysUserListByBg",t).then(function(e){var t=e.success,n=e.data,l=e.totalNumber;t&&a(n,l)})})},a.initSimpleData=function(e){var t={};return function e(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(a){var n=a.value,l=a.children,r=void 0===l?[]:l;t[n]=a,r.length&&e(r)})}(e),t},a.getLoopMatch=function(e,t,n){e.forEach(function(e,l,r){return a.state.expandedKeys.includes(e.value)&&(e.expanded=!0),e.value===t?n(e,l,r):e.children?a.getLoopMatch(e.children,t,n):void 0})},a.getBreadcrumb=function(e,t){for(var a=[],n=[];e;)if(t[e]){var l=t[e].valuePid;a.unshift(e),n.unshift(t[e]),e=l}else e=null;return{keys:a,datas:n.map(function(e){return e.expanded=!0,e})}},a.onSelect=function(e,t){var n=t.node,l=a.props,r=l.dispatch,o=l.routerInfo,u=o.curKey,d=o.routeData[u].moduleName;if(a.visibleValue!==n.props.eventKey&&!a.state.editValue){a.visibleValue="",a.endKey=n.props.eventKey,r(Object(G.f)("".concat(d,"menus/").concat(a.endKey)));var c=a.initSimpleData(a.gData);a.setState({record:{menuId:c[a.endKey].value,menuUrl:c[a.endKey]._title},treeSelectedKeys:e})}},a.onExpand=function(e){a.setState({expandedKeys:e})},a.onDragEnter=function(e){a.setState({expandedKeys:e.expandedKeys})},a.onRightClick=function(e){a.setState({visibleValue:e.node.props.eventKey})},a.handle=function(e){"0"===e.rState?a.loadTree():a.setState(e)},a}return X()(t,e),R()(t,[{key:"componentDidMount",value:function(){this.loadTree()}},{key:"render",value:function(){var e=this,t=this.props.myFetch,a=this.state,n=a.rState,l=a.record,r=a.gData,o=a.visibleValue,u=a.editValue,d=a.treeK,i=d.label,s=d.value;return c.a.createElement(k.a,{style:{background:"transparent",height:"100%"},onClick:function(t){return o&&e.setState({visibleValue:""}),!1}},c.a.createElement(k.a.Sider,{className:q.a.treeContainer,width:"350px",style:{background:"transparent"}},c.a.createElement("div",{className:q.a.tree,onContextMenu:function(e){e.preventDefault()}},c.a.createElement($.a,{treeData:r,onChange:function(t){return e.setState({gData:t})},theme:te.a,generateNodeProps:function(a){var n=a.node.valuePid,l=a.node[s],r=a.node._title,d={};try{d=r?JSON.parse(r):{}}catch(S){console.error("\u83dc\u5355\u6570\u636e\u89e3\u6790\u5931\u8d25\uff1a",r)}var m="en_US"===ue?d["".concat(i)]:a.node[i],p="en_US"===ue&&d.tableNameUS||d.tableName;p&&(m="".concat(p,"-").concat(m));var f=a.node.isAdd,h=a.node.addBtn,b=u===l,v=function(a){switch(e.visibleValue=l,a){case 1:var n=[].concat([l],e.state.expandedKeys),r=Math.random(),o={value:r,label:"",type:"1",valuePid:l,children:[],isAdd:!0,expanded:!0};e.getLoopMatch(e.gData,l,function(e,t,a){e.children=e.children||[],e.children.push(o),e.expanded=!0}),e.inputValue="",e.setState({gData:V()(e.gData),editValue:r,expandedKeys:n});break;case"addBtn":var u=[].concat([l],e.state.expandedKeys),d=Math.random(),c={value:d,label:"",type:"addBtn",valuePid:l,children:[],addBtn:!0,expanded:!0};e.getLoopMatch(e.gData,l,function(e,t,a){e.children=e.children||[],e.children.push(c),e.expanded=!0}),e.inputValue="",e.setState({gData:V()(e.gData),editValue:d,expandedKeys:u});break;case 2:e.inputValue=m,e.setState({editValue:l});break;case 3:e.getLoopMatch(e.gData,l,function(e,t,a){a.splice(t,1)}),e.setState({gData:V()(e.gData)}),t("batchDeleteUpdateSysMenu",[{menuId:l}]).then(function(t){var a=t.success,n=t.message;a||A.b.error(n,1.2,function(){e.loadTree()})})}},g=c.a.createElement("div",null,"0"===n?c.a.createElement("div",null):null,c.a.createElement("div",null,c.a.createElement("a",{onClick:function(){return v(1)}},ce.AddSubmenu)),c.a.createElement("div",null,c.a.createElement("a",{onClick:function(){return v("addBtn")}},ce.AddButton)),"0"!==n?c.a.createElement("div",null,c.a.createElement("a",{onClick:function(){return v(2)}},ce.Rename)):null,"0"!==n?c.a.createElement("div",null,c.a.createElement("a",{onClick:function(){re({title:"en_US"===ue?"Are you sure you want to delete the department [".concat(m,"]?"):"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u90e8\u95e8\u3010".concat(m,"\u3011\u4e48?"),content:"",okText:ce.confirm,cancelText:ce.cancel,onOk:function(){return v(3)}})}},ce.delete)):null),y=function(a){var r=a.target.value.toString().trim();if(r)if(f){var o={menuParentId:n,menuFlag:1};"en_US"===ue?o.menuNameUS=r:o.menuName=r,A.b.loading("loading..."),t("addSysMenu",o).then(function(t){var a=t.success,n=(t.code,t.message),r=t.data;if(A.b.destroy(),a){var o=r.menuId,u=r.menuName,d=r.menuNameUS,c=r.menuParentId,i=r.children,s=void 0===i?[]:i;e.getLoopMatch(e.gData,l,function(e,t,a){"en_US"===ue?e.labelUS=d:e.label=u,e.value=o,e.valuePid=c,e.children=s,e.isAdd=!1}),e.setState({gData:V()(e.gData),editValue:""})}else A.b.error(n,1.2,function(){e.loadTree()})})}else if(h){var u={menuParentId:n,menuFlag:2};"en_US"===ue?u.menuNameUS=r:u.menuName=r,A.b.loading("loading..."),t("addSysMenu",u).then(function(t){var a=t.success,n=(t.code,t.message),r=t.data;if(A.b.destroy(),a){var o=r.menuId,u=r.menuName,d=r.menuParentId,c=r.children,i=void 0===c?[]:c;e.getLoopMatch(e.gData,l,function(e,t,a){"en_US"===ue?e.labelUS=menuNameUS:e.label=u,e.value=o,e.valuePid=d,e.children=i,e.addBtn=!1}),e.setState({gData:V()(e.gData),editValue:""})}else A.b.error(n,1.2,function(){e.loadTree()})})}else{e.getLoopMatch(e.gData,l,function(e,t,a){e.label=r});var d={menuId:l};"en_US"===ue?d.menuNameUS=r:d.menuName=r,A.b.loading("loading..."),t("updateSysMenu",d).then(function(t){var a=t.success,n=t.message;A.b.destroy(),a||A.b.error(n,1.2,function(){e.loadTree()})}),e.setState({gData:V()(e.gData),editValue:""})}else(f||h)&&e.getLoopMatch(e.gData,l,function(e,t,a){a.splice(t,1)}),e.setState({gData:V()(e.gData),editValue:""})};return a.node.title=c.a.createElement("div",{onContextMenu:function(t){e.onRightClick({node:{props:{eventKey:l}}})},style:{background:e.endKey===l?"#ececec":"",padding:"2px 6px",borderRadius:"3px"}},b?c.a.createElement("div",{onMouseDown:function(e){e.preventDefault(),e.stopPropagation()},onMouseMove:function(e){e.preventDefault(),e.stopPropagation()}},c.a.createElement(M.a,{autoFocus:!0,defaultValue:e.inputValue,placeholder:ce.placeholder,onBlur:y,onPressEnter:y})):c.a.createElement(P.a,{visible:o===l,placement:"rightTop",content:g},m&&m.length>8?c.a.createElement(w.a,{title:m},c.a.createElement("span",null,m)):c.a.createElement("span",null,m))),ne({onClick:function(){e.onSelect([l],{node:{props:{eventKey:l}}})},onDoubleClick:function(t){var n=!a.node.expanded;e.getLoopMatch(e.gData,l,function(e,t,a){e.expanded=n}),e.inputValue="",e.setState({gData:V()(e.gData),expandedKeys:n?e.state.expandedKeys.concat([l]):e.state.expandedKeys.filter(function(e){return e!==l})})},listIndex:a.treeIndex},a)},getNodeKey:function(e){return e.node[s]},rowHeight:32,scaffoldBlockPxWidth:24,slideRegionSize:50,isVirtualized:!1,onDragStateChanged:function(t){t.isDragging&&(e.backUpTreeData=r)},onMoveNode:function(a){var n=a.treeData,l=a.node,r=a.nextParentNode;if(a.nextPath.length<=1)return A.b.info(ce.CannotAddNode,1),void e.setState({gData:V()(e.backUpTreeData)});var o=null,u=null;!function e(t){if(t&&t.length)for(var a=0;a<t.length;a++){var n=t[a];if(n.value===l.value){if(t.length>1)if(a>0){var r=t[a-1],d=t[a+1];r&&(o=r.value),d&&(u=d.value)}else u=t[a+1].value;return}n.children&&n.children.length&&e(n.children)}}(n);var d={menuParent:r.value,menuToMove:l.value,menuAfter:u,menuBefore:o};t("moveUpdateSysMenu",d).then(function(t){var a=t.success,n=(t.code,t.message);t.data;a||A.b.error(n,1.2,function(){e.loadTree()})})},onVisibilityToggle:function(t){var a=t.expanded,n=t.node[s];e.getLoopMatch(e.gData,n,function(e,t,n){e.expanded=a}),e.inputValue="",e.setState({gData:V()(e.gData),expandedKeys:a?e.state.expandedKeys.concat([n]):e.state.expandedKeys.filter(function(e){return e!==n})})}}))),c.a.createElement(k.a.Content,null,function(){var t,a=[{label:"menuId",type:"hidden",dataIndex:"menuId"},{label:ce.JSONData,dataIndex:"menuUrl"}];switch(n){case"0":default:t=c.a.createElement(se,U()({},e.props,{handle:e.handle,columns:a,dataSource:l}))}return t}()))}}]),t}(d.Component),se=function(e){function t(){var e,a;B()(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=j()(this,(e=H()(t)).call.apply(e,[this].concat(l)))).handleSubmit=function(e){return(0,a.props.myFetch)("updateSysMenuDetails",ne({},e)).then(function(e){var t=e.success,n=e.message;t?A.b.success(n,1.2,function(){a.handle({rState:"0"})}):A.b.error(n,1.2)}),event&&event.preventDefault&&event.preventDefault(),!1},a.handle=function(e){a.props.handle(e)},a}return X()(t,e),R()(t,[{key:"render",value:function(){var e={labelCol:{span:3},wrapperCol:{span:20}},t=this.props,a=t.columns,n=t.dataSource,l=a.map(function(t,a){var l,r=t.dataIndex,o=t.label;switch(t.type){case"hidden":l=c.a.createElement(le,{name:[r],noStyle:!0,key:a},c.a.createElement(M.a,{hidden:!0}));break;default:if(n[r])try{var u=JSON.parse(n[r]),d=K()(u,null,4);n[r]=d}catch(i){n[r]="\n                            ".concat(ce.JSONParseError,"\uff1a\n                                ").concat(n[r],"\n                            ")}l=c.a.createElement(le,U()({help:"en_US"===ue?c.a.createElement("div",null,'"showType":\'Three level menu display types(Subset occurrence mode  0 Expanded  1 floating window\u3010default\u3011) "0" | "1" \', ',c.a.createElement("br",null),"\"hide\":'Hidden boolean',",c.a.createElement("br",null),'"defaultPath": "default path",',c.a.createElement("br",null),'"moduleName": "/webPro/",',c.a.createElement("br",null),'"pathName": "front-end routing",',c.a.createElement("br",null),'"comKey": "Component key", (IframePage need)',c.a.createElement("br",null),'"tableField": "Table id",',c.a.createElement("br",null),'"label": "Menu Chinese name",',c.a.createElement("br",null),'"labelUS": "English name of menu",',c.a.createElement("br",null),'"label": "Menu Chinese name",',c.a.createElement("br",null),'"tableName": "Chinese name of table",',c.a.createElement("br",null),'"tableNameUS": "English name of table",',c.a.createElement("br",null),'"iconType": "http | https size 20px * 20px",  Address of the icon icon at the beginning',c.a.createElement("br",null),'"url": "http://baidu.com" Embedded web site'):c.a.createElement("div",null,'"showType":\'\u4e09\u7ea7\u83dc\u5355\u5c55\u793a\u7c7b\u578b(\u5b50\u96c6\u51fa\u73b0\u65b9\u5f0f 0\u5c55\u5f00  1\u6d6e\u7a97\u3010\u9ed8\u8ba4\u3011) "0" | "1" \', ',c.a.createElement("br",null),"\"hide\":'\u662f\u5426\u9690\u85cf boolean',",c.a.createElement("br",null),'"defaultPath": "\u9ed8\u8ba4\u8def\u5f84",',c.a.createElement("br",null),'"moduleName": "/webPro/",',c.a.createElement("br",null),'"pathName": "\u524d\u7aef\u8def\u7531",',c.a.createElement("br",null),'"comKey": "\u7ec4\u4ef6key", (\u5185\u5d4c\u7f51\u5740\u9700\u4f7f\u7528\uff1aIframePage)',c.a.createElement("br",null),'"tableField": "\u8868\u683cid",',c.a.createElement("br",null),'"label": "\u83dc\u5355\u4e2d\u6587\u540d",',c.a.createElement("br",null),'"labelUS": "\u83dc\u5355\u82f1\u6587\u540d",',c.a.createElement("br",null),'"tableName": "\u8868\u683c\u4e2d\u6587\u540d",',c.a.createElement("br",null),'"tableNameUS": "\u8868\u683c\u82f1\u6587\u540d",',c.a.createElement("br",null),'"iconType": "http | https\u5f00\u5934\u7684icon\u56fe\u6807\u5730\u5740  \u5c3a\u5bf8 20px * 20px",',c.a.createElement("br",null),'"url": "http://baidu.com" (\u5185\u5d4c\u7f51\u5740, \u9700\u8981\u8bbe\u7f6e "comKey": "IframePage",  defaultPath: "biYing/0", pathName: "biYing/:url"), ',c.a.createElement("br",null),'"tokenKey":"code", (\u5b58\u5728 tokenKey \u5c31\u4f1a\u6dfb\u52a0 ?[tokenKey]=[token] \u5230\u7f51\u5740\u540e\u9762, \u5185\u5d4c\u7f51\u5740\u7279\u5b9a)'),name:[r],key:a,label:o},e),c.a.createElement(M.a.TextArea,{autoSize:!0,placeholder:o}))}return l});return c.a.createElement(Q.a,{ref:function(e){e&&e.setFieldsValue(n)},initialValues:n,onFinish:this.handleSubmit},c.a.createElement(D.a.Group,{style:{marginBottom:"12px"}},c.a.createElement(D.a,{htmlType:"submit",type:"primary"},ce.save)),l)}}]),t}(d.Component),me=ie,pe=function(e){function t(){return Object(n.a)(this,t),Object(r.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return c.a.createElement(me,this.props)}}]),t}(d.Component);t.default=pe}}]);