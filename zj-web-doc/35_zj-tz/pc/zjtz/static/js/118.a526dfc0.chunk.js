(window.webpackJsonp=window.webpackJsonp||[]).push([[118],{"2puO":function(e,t,n){"use strict";var a=n("NhKq");e.exports=function(e){a(a.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},"3KqC":function(e,t,n){var a=n("Z2yL");e.exports=function(e,t){var n=[];return a(e,!1,n.push,n,t),n}},"6NPa":function(e,t,n){"use strict";var a=n("xhuU").f,r=n("kY58"),o=n("AGhJ"),i=n("trfr"),s=n("A7Te"),c=n("Z2yL"),l=n("CxRn"),u=n("wfks"),d=n("NPcP"),f=n("IH+S"),p=n("vXrM").fastKey,h=n("iZ+U"),v=f?"_s":"size",g=function(e,t){var n,a=p(t);if("F"!==a)return e._i[a];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,l){var u=e(function(e,a){s(e,u,t,"_i"),e._t=t,e._i=r(null),e._f=void 0,e._l=void 0,e[v]=0,void 0!=a&&c(a,n,e[l],e)});return o(u.prototype,{clear:function(){for(var e=h(this,t),n=e._i,a=e._f;a;a=a.n)a.r=!0,a.p&&(a.p=a.p.n=void 0),delete n[a.i];e._f=e._l=void 0,e[v]=0},delete:function(e){var n=h(this,t),a=g(n,e);if(a){var r=a.n,o=a.p;delete n._i[a.i],a.r=!0,o&&(o.n=r),r&&(r.p=o),n._f==a&&(n._f=r),n._l==a&&(n._l=o),n[v]--}return!!a},forEach:function(e){h(this,t);for(var n,a=i(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(a(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!g(h(this,t),e)}}),f&&a(u.prototype,"size",{get:function(){return h(this,t)[v]}}),u},def:function(e,t,n){var a,r,o=g(e,t);return o?o.v=n:(e._l=o={i:r=p(t,!0),k:t,v:n,p:a=e._l,n:void 0,r:!1},e._f||(e._f=o),a&&(a.n=o),e[v]++,"F"!==r&&(e._i[r]=o)),e},getEntry:g,setStrong:function(e,t,n){l(e,t,function(e,n){this._t=h(e,t),this._k=n,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?u(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,u(1))},n?"entries":"values",!n,!0),d(t)}}},"7t3s":function(e,t,n){var a=n("trfr"),r=n("Nhsw"),o=n("02oD"),i=n("jBX+"),s=n("i8BR");e.exports=function(e,t){var n=1==e,c=2==e,l=3==e,u=4==e,d=6==e,f=5==e||d,p=t||s;return function(t,s,h){for(var v,g,m=o(t),y=r(m),b=a(s,h,3),D=i(y.length),S=0,w=n?p(t,D):c?p(t,0):void 0;D>S;S++)if((f||S in y)&&(g=b(v=y[S],S,m),e))if(n)w[S]=g;else if(g)switch(e){case 3:return!0;case 5:return v;case 6:return S;case 2:w.push(v)}else if(u)return!1;return d?-1:l||u?u:w}}},"92XF":function(e,t,n){e.exports=n("X8YZ")},"9Yfi":function(e,t,n){n("2puO")("Set")},NNcu:function(e,t,n){n("QhJZ")("Set")},QhJZ:function(e,t,n){"use strict";var a=n("NhKq"),r=n("r0bi"),o=n("trfr"),i=n("Z2yL");e.exports=function(e){a(a.S,e,{from:function(e){var t,n,a,s,c=arguments[1];return r(this),(t=void 0!==c)&&r(c),void 0==e?new this:(n=[],t?(a=0,s=o(c,arguments[2],2),i(e,!1,function(e){n.push(s(e,a++))})):i(e,!1,n.push,n),new this(n))}})}},UHFi:function(e,t,n){e.exports={nestedTable:"_2jB9To2sNiR4u-aP5FYkY_",nestedTableTop:"_11jmSJw3JqM4gwSZQru0Ny",scrollstyle:"_1NAjuEzPYv7vhLsvHIzScf",treeContainer:"_8kSSzHVD0uICUI4k0velA",searchContainer:"_1w5uVgpJ8CcR0xKEGkbYsN",searchContainerRight:"_17a6JGYGKpHteKce2xkGci",searchResContainer:"_1ym6nE-zgqPhUX41lWLtDS",searchResContainer_btn:"_1L5KjNHM1-A598ARD1op6T",tree:"_517eK4OitIKKlpG8E0PGw",noselect:"_1VhOrtrczk4SyRaqI2cTr-",drawBtn:"_2aUSKJONukJPs1nmOP4T3z",onDragStart:"B97ckxWmA9VtfwGpGAdTH",onDragEnter:"GfLPcyK3rg9n3LkdiILgg",beforeInsert:"_3XxMHZ0URVSFEtx6A-ApWL",afterInsert:"_15b6HnZDChgd5Z_zHaMw2q"}},X8YZ:function(e,t,n){n("ot0G"),n("sh1G"),n("HQ92"),n("gDZo"),n("v0tr"),n("9Yfi"),n("NNcu"),e.exports=n("WsQ/").Set},YCk7:function(e,t,n){"use strict";var a=n("+e9d"),r=n("NhKq"),o=n("vXrM"),i=n("G1lJ"),s=n("MKF8"),c=n("AGhJ"),l=n("Z2yL"),u=n("A7Te"),d=n("SUQI"),f=n("pRNd"),p=n("xhuU").f,h=n("7t3s")(0),v=n("IH+S");e.exports=function(e,t,n,g,m,y){var b=a[e],D=b,S=m?"set":"add",w=D&&D.prototype,x={};return v&&"function"==typeof D&&(y||w.forEach&&!i(function(){(new D).entries().next()}))?(D=t(function(t,n){u(t,D,e,"_c"),t._c=new b,void 0!=n&&l(n,m,t[S],t)}),h("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in w&&(!y||"clear"!=e)&&s(D.prototype,e,function(n,a){if(u(this,D,e),!t&&y&&!d(n))return"get"==e&&void 0;var r=this._c[e](0===n?0:n,a);return t?this:r})}),y||p(D.prototype,"size",{get:function(){return this._c.size}})):(D=g.getConstructor(t,e,m,S),c(D.prototype,n),o.NEED=!0),f(D,e),x[e]=D,r(r.G+r.W+r.F,x),y||g.setStrong(D,e,m),D}},YULh:function(e,t,n){"use strict";n.r(t);var a=n("UpC8"),r=n("Id3l"),o=n("RNsw"),i=n("OR/T"),s=n("bn5B"),c=n("PnTt"),l=n("r0ML"),u=n.n(l),d=n("fbSu"),f=n.n(d),p=n("5T12"),h=n.n(p),v=n("qHWA"),g=n.n(v),m=n("rx6U"),y=n.n(m),b=n("4tJN"),D=n.n(b),S=n("Qsbb"),w=n.n(S),x=(n("9U97"),n("kO4A"),n("+kFb"),n("FMw2"),n("S6uq"),n("gyUR"),n("Z5ek"),n("jnfO"),n("zIPO"),n("MRnW"),n("IdsT"),n("GzNv"),n("QifN"),n("l9AF"),n("S26F"),n("+xeR"),n("Id6h"),n("9M8h"),n("4sxk")),E=(n("9pI4"),n("QVyI")),I=n("Wv3C"),K=n.n(I),k=(n("Rdx9"),n("Le+4")),C=(n("K4KN"),n("lOXM")),T=(n("TSXX"),n("iZJp")),N=n("92XF"),_=n.n(N),L=n("E1ju"),P=n.n(L),R=(n("am1t"),n("5WK1")),F=(n("5fiz"),n("LepS")),A=(n("NExk"),n("ftLu")),M=n("yRwV"),U=n.n(M),O=(n("GSo0"),n("H5O6")),V=n.n(O),q=n("eKXt"),J=n.n(q),Y=n("EByn"),j=n.n(Y),B=n("qQuN"),Q=n.n(B),Z=n("eRGJ"),H=n.n(Z),G=(n("fx2i"),n("cZi0")),z=n("isxb"),W=n.n(z),X=n("wJ7t"),$=n.n(X),ee=n("rD0L"),te=n.n(ee),ne=n("bj0d"),ae=n.n(ne),re=n("i2ZC"),oe=n.n(re),ie=(n("w9C0"),n("XW+2")),se=n("Ervb"),ce=n("rb0r"),le=n("tRvt"),ue=n("UHFi"),de=n.n(ue),fe=n("U32T"),pe=(n("YD43"),n("fgI6")),he=n("5D0v"),ve=n.n(he),ge=n("+Wf6"),me=n("3a3M"),ye=n.n(me),be=n("jB+J");function De(e,t){var n=w()(e);if(D.a){var a=D()(e);t&&(a=a.filter(function(t){return y()(e,t).enumerable})),n.push.apply(n,a)}return n}function Se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach(function(t){Q()(e,t,n[t])}):g.a?h()(e,g()(n)):De(Object(n)).forEach(function(t){f()(e,t,y()(n,t))})}return e}var we=window.configs.language,xe="en_US"===(void 0===we?"zh_CN":we),Ee={edit:xe?"Edit":"\u7f16\u8f91",rename:xe?"Rename":"\u91cd\u547d\u540d",goBack:xe?"go back":"\u8fd4\u56de",confirm:xe?"Confirm":"\u786e\u8ba4",cancel:xe?"Cancel":"\u53d6\u6d88",add:xe?"Add":"\u65b0\u589e",save:xe?"Save":"\u4fdd\u5b58",placeholder:xe?"please enter...":"\u8bf7\u8f93\u5165...",delete:xe?"Delete":"\u6279\u91cf\u5220\u9664","\u65e0\u7ed3\u679c":xe?"no data":"\u65e0\u7ed3\u679c","\u4fdd\u5b58\u5e76\u7ee7\u7eed\u6dfb\u52a0":xe?"Save and continue to add":"\u4fdd\u5b58\u5e76\u7ee7\u7eed\u6dfb\u52a0","\u70b9\u51fb\u6216\u8005\u62d6\u52a8\u4e0a\u4f20":xe?"Click or drag to upload":"\u70b9\u51fb\u6216\u8005\u62d6\u52a8\u4e0a\u4f20"},Ie=ie.a.confirm,Ke=function(e){function t(){var e,n;W()(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=te()(this,(e=ae()(t)).call.apply(e,[this].concat(r)))).depId=n.props.match.params.depId||"0",n.gData=[],n.modals={},n.visibleValue="",n.endKey=n.depId,n.pageParams={page:1,limit:10},n.inputValue="",n.state={record:{},mData:[],gData:[],rState:"0",selectedRowKeys:[],treeSelectedKeys:[],expandedKeys:[],visibleValue:"",editValue:"",visible:!1,treeK:{label:"label",value:"value",children:"children"},searchTreeNodeText:null,searchFocusIndex:0,searchFoundCount:null,gwData:[],gwName:n.props.loginAndLogoutInfo.loginInfo.userInfo.ext1||(xe?" post":"\u5c97\u4f4d"),loadingNodeId:void 0},n.myQnnTable=void 0,n.setMyQnnTable=function(e){n.myQnnTable=e},n.loadTree=function(){var e=n.props,t=e.myFetch,a=e.leftTreeDemandLoading,r=e.leftTreeDemandLoadingApiName,o=e.loginAndLogoutInfo.loginInfo.userInfo.curCompany,i=(void 0===o?{}:o).departmentId,s=n.state.expandedKeys;G.b.loading("loading...",0);var c={};a&&(c={departmentParentId:"0"}),i&&(c.topId=i),t(a?r:"getSysDepartmentAllTree",c).then(function(e){var t=e.success,a=e.data;if(G.b.destroy(),t){n.gData=H()(a)?a:[a],n.endKey="0"===n.depId?n.gData[0]&&n.gData[0].value:n.depId;!function e(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(t){t.loaded=!1;var n=t.value,a=t.children,r=void 0===a?[]:a;s.includes(n)&&(t.expanded=!0),r.length&&e(r)})}(n.gData),n.setState(Se({rState:"0",loading:!1,selectedRowKeys:[]},n.pageParams,{gData:j()(n.gData),expandedKeys:[],treeSelectedKeys:[n.endKey]}),function(){n.state.tableHeight||n.setTreeContainerHeight()})}})},n.loadList=function(e){var t=n.props.myFetch;n.setState({loading:!0});var a=Se({departmentId:n.endKey},n.pageParams,{search:e});return new J.a(function(e){t("getSysUserListByBg",a).then(function(t){var n=t.success,a=(t.code,t.message,t.data),r=t.totalNumber;n&&e({mData:a,totalNumber:r})})})},n.setTreeContainerHeight=function(){},n.searchText=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";n.setState({searchText:e})},n.initSimpleData=function(e){var t={};return function e(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(n){var a=n.value,r=n.children,o=void 0===r?[]:r;t[a]=n,o.length&&e(o)})}(e),t},n.getLoopMatch=function(e,t,a){e.forEach(function(e,r,o){return n.state.expandedKeys.includes(e.value)&&(e.expanded=!0),e.value===t?a(e,r,o):e.children?n.getLoopMatch(e.children,t,a):void 0})},n.getBreadcrumb=function(e,t){for(var n=[],a=[];e;)if(t[e]){var r=t[e].valuePid;n.unshift(e),a.unshift(t[e]),e=r}else e=null;return{keys:n,datas:a}},n.onSelect=function(){var e=V()(U.a.mark(function e(t,a){var r,o,i,s,c,l,u,d,f,p,h,v,g,m,y,b,D,S,w;return U.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.node,o=n.state,i=o.expandedKeys,s=o.gData,c=n.props,l=c.dispatch,u=c.routerInfo,d=u.curKey,f=u.routeData,p=c.leftTreeDemandLoading,h=c.leftTreeDemandLoadingApiName,v=f[d].moduleName,n.visibleValue===r.props.eventKey||n.state.editValue){e.next=24;break}if(n.visibleValue="",n.endKey=r.props.eventKey,l(Object(fe.f)("".concat(v,"contacts/").concat(n.endKey))),g=[],m=!1,i.includes(n.endKey)?(y=i.indexOf(n.endKey),g=i.splice(0,y)):(g=r.path,m=!0),b=r.node.children,D=r.node.type,!m||r.node.loaded||"2"===D||!p){e.next=20;break}return n.setState({loadingNodeId:r.props.eventKey}),e.next=17,n.props.myFetch(h,{departmentParentId:r.props.eventKey,type:D});case 17:S=e.sent,n.setState({loadingNodeId:void 0}),S.success&&(b=S.data,r.node.loaded=!0);case 20:w=function e(t){if(t&&t.length)return t.map(function(t){return t.value===r.props.eventKey&&(t.children=b),g.includes(t.value)?t.expanded=!0:t.expanded=!1,t.children&&t.children.length&&(t.children=e(t.children)),t})}(s),n.setState({expandedKeys:g,gData:w},function(){return n.setState({expandedKeys:g})}),n.myQnnTable.qnnSetState({curPage:1},n.myQnnTable.refresh);case 24:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),n.onDragEnter=function(e){n.setState({expandedKeys:e.expandedKeys})},n.onRightClick=function(e){n.setState({visibleValue:e.node.props.eventKey})},n.handle=function(e){var t=n.state.selectedRowKeys;if("0"===e.rState)n.loadList().then(function(e){var t=e.mData,a=e.totalNumber;n.setState(Se({searchText:"",rState:"0",loading:!1,totalNumber:a,mData:t,selectedRowKeys:[]},n.pageParams))});else if("resetPwd"===e.rState){if(!t.length)return void G.b.error(xe?"Please select the person who needs to reset the password!":"\u8bf7\u9009\u62e9\u9700\u8981\u91cd\u7f6e\u5bc6\u7801\u7684\u4eba\u5458\uff01");var a=n.props.myFetch;Ie({title:xe?"You are sure to reset the selected":"\u60a8\u786e\u5b9a\u8981\u91cd\u7f6e\u9009\u4e2d\u7684".concat(t.length,"\u4e2a\u8d26\u53f7\u7684\u5bc6\u7801\u5417?"),content:"",okText:Ee.confirm,cancelText:Ee.cancel,onOk:function(){n.setState({loading:!0}),a("resetUserPwd",t.map(function(e){return{userKey:e.userKey}})).then(function(e){var t=e.success,a=e.message;t?(G.b.success(a),n.setState({loading:!1,selectedRowKeys:[]})):(G.b.error(a),n.setState({loading:!1}))})}})}else e.record&&e.record.sysDepartmentList&&(e.record.sysDepartmentList=e.record.sysDepartmentList.map(function(e){return Se({},e,{label:e.label||e.departmentName,value:e.value||e.departmentId})})),n.setState(e)},n.searchTreeNode=function(e){n.setState({searchTreeNodeText:e.target.value})},n}return oe()(t,e),$()(t,[{key:"componentDidMount",value:function(){this.loadTree()}},{key:"render",value:function(){var e=this,t=this.props,n=t.myFetch,a=t.leftTreeDemandLoading,r=t.removeTreeNodeRightMenu,o=this.state,i=o.gData,s=o.expandedKeys,c=o.visibleValue,l=o.editValue,d=o.treeK,f=d.label,p=d.value,h=o.searchTreeNodeText,v=o.searchFocusIndex,g=o.searchFoundCount,m=o.loadingNodeId;return u.a.createElement(k.a,{style:{background:"transparent",height:"100%"},onClick:function(t){return c&&e.setState({visibleValue:""}),!1}},u.a.createElement(k.a.Sider,{className:de.a.treeContainer,width:"25%",theme:"light"},u.a.createElement("div",{name:"tree",className:de.a.tree,onContextMenu:function(e){e.preventDefault()}},u.a.createElement("div",{className:de.a.searchContainer},u.a.createElement(R.a,{align:"middle",justify:"space-between"},u.a.createElement(F.a,{span:15},u.a.createElement(A.a,{placeholder:Ee.placeholder,onChange:this.searchTreeNode,style:{width:"100%"},allowClear:!0})),u.a.createElement(F.a,{span:9},u.a.createElement("div",{className:de.a.searchContainerRight},g?u.a.createElement("div",{className:de.a.searchResContainer},u.a.createElement("div",null,g,xe?" in ":"\u4e2d\u7684",v+1)):Ee["\u65e0\u7ed3\u679c"],u.a.createElement("div",{className:de.a.searchResContainer_btn},u.a.createElement("span",{style:0===v?{opacity:.5}:null,onClick:function(){if(0!==v){var t=v-1;e.setState({searchFocusIndex:t})}}},u.a.createElement(se.a,null)),u.a.createElement("span",{style:v>=g-1?{opacity:.5}:null,onClick:function(){if(!(v>=g-1)){var t=v+1;e.setState({searchFocusIndex:t})}}},u.a.createElement(ce.a,null))))))),u.a.createElement(pe.a,{canDrag:!r,searchQuery:h,searchFocusOffset:v,searchFinishCallback:function(t){e.setState({searchFoundCount:t.length,searchFocusIndex:t.length>0?v%t.length:0})},onlyExpandSearchedNodes:!0,searchMethod:function(e){if(h&&e.node.label&&e.node.label.includes(h))return!0},treeData:i,onChange:function(t){return e.setState({gData:t})},theme:ve.a,rowDirection:"ltr",generateNodeProps:function(t){var a,o=t.node[f],i=t.node.valuePid,d=t.node[p],h=t.node.isAdd,v=l===d,g=function(t){switch(e.visibleValue=d,t){case 0:n("syncWeChatToSysInfo",a).then(function(t){var n=t.success,a=t.message;n||G.b.error(a,1.2,function(){e.loadTree()})});break;case 1:var r=[].concat(e.state.expandedKeys,[d]),i=Math.random(),s={value:i,label:"",type:"1",valuePid:d,children:[],isAdd:!0};e.getLoopMatch(e.gData,d,function(e,t,n){e.expanded=!0,e.children=e.children||[],e.children.push(s)}),e.inputValue="",e.setState({gData:j()(e.gData),editValue:i,expandedKeys:P()(new _.a(r))});break;case 2:e.inputValue=o,e.setState({editValue:d});break;case 3:a=[{departmentId:d}],G.b.loading("loading...",0),n("batchDeleteUpdateSysDepartment",a).then(function(t){var n=t.success,a=t.message;G.b.destroy(),e.visibleValue=null,n?(e.getLoopMatch(e.gData,d,function(e,t,n){n.splice(t,1)}),e.setState({gData:j()(e.gData)})):G.b.error(a)})}},y=u.a.createElement("div",null,"0"===i?u.a.createElement("div",null):null,u.a.createElement("div",null,u.a.createElement("a",{onClick:function(){return g(1)}},xe?"Add subdivision":"\u65b0\u5efa\u5b50\u90e8\u95e8")),"0"!==i?u.a.createElement("div",null,u.a.createElement("a",{onClick:function(){return g(2)}},Ee.rename)):null,"0"!==i?u.a.createElement("div",null,u.a.createElement("a",{onClick:function(){Ie({title:"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u90e8\u95e8\u3010".concat(o,"\u3011\u4e48?"),content:"",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){return g(3)}})}},Ee.delete)):null),b=function(t){var a=t.target.value.toString().trim();if(a)if(h){var r={departmentParentId:i,departmentName:a,departmentFlag:1};G.b.loading("loading..."),n("addSysDepartment",r).then(function(t){var n=t.success,a=(t.code,t.message),r=t.data;if(G.b.destroy(),e.setState({addIng:!1}),n){e.visibleValue=null;var o=r.departmentId,i=r.departmentName,s=r.departmentParentId,c=r.children,l=void 0===c?[]:c;e.getLoopMatch(e.gData,d,function(e,t,n){e.label=i,e.value=o,e.valuePid=s,e.children=l,e.isAdd=!1}),e.setState({gData:j()(e.gData),editValue:""})}else G.b.error(a,1.2,function(){})})}else{e.getLoopMatch(e.gData,d,function(e,t,n){e.label=a}),n("updateSysDepartment",{departmentId:d,departmentName:a}).then(function(t){var n=t.success,a=(t.code,t.message);t.data;n||G.b.error(a,1.2,function(){e.loadTree()})}),e.setState({gData:j()(e.gData),editValue:""})}else h&&(e.visibleValue=null,e.getLoopMatch(e.gData,d,function(e,t,n){n.splice(t,1)})),e.setState({gData:j()(e.gData),editValue:""})},D=d===m?u.a.createElement(be.a,null):"",S=o.length>15?u.a.createElement(T.a,{title:o},u.a.createElement("span",null,D," ",o)):u.a.createElement("span",null,D," ",o||"\u672a\u547d\u540d");return t.node.title=u.a.createElement("div",{onContextMenu:function(t){e.onRightClick({node:{props:{eventKey:d}}})},style:{background:e.endKey===d?"#ececec":"",padding:"2px 6px",borderRadius:"3px"}},v?u.a.createElement("div",{id:"contactsCurInput",onMouseDown:function(e){e.preventDefault(),e.stopPropagation()},onMouseMove:function(e){e.preventDefault(),e.stopPropagation()},ref:function(e){e&&setTimeout(function(){document.querySelector("#contactsCurInput").scrollIntoView({block:"center",inline:"center"})},150)}},u.a.createElement(A.a,{autoFocus:!0,defaultValue:e.inputValue,placeholder:"\u8f93\u5165\u5b8c\u6bd5\u8bf7\u6309\u56de\u8f66\u952e...",onBlur:b,onPressEnter:b})):r?S:u.a.createElement(C.a,{visible:c===d,placement:"rightTop",content:y},S)),t.node.expanded||(t.node.expanded=s.includes(d)),Se({onClick:function(){e.onSelect([d],{node:Se({},t,{props:{eventKey:d}})})},listIndex:t.treeIndex},t)},getNodeKey:function(e){return e.node[p]},rowHeight:32,scaffoldBlockPxWidth:24,slideRegionSize:50,isVirtualized:!1,onDragStateChanged:function(t){t.isDragging&&(e.backUpTreeData=i)},onMoveNode:function(t){var r=t.treeData,o=t.node,i=t.nextParentNode,s=t.nextPath;if(!i.loaded&&a)return G.b.info(xe?"Please first click the load \u3010".concat(i.label,"\u3011 subset point"):"\u8bf7\u5148\u70b9\u51fb\u4e00\u4e0b\u3010".concat(i.label,"\u3011\u8282\u70b9\u4ee5\u52a0\u8f7d\u5b50\u96c6\u70b9"),4),void e.setState({gData:j()(e.backUpTreeData)});if(s.length<=1)return G.b.info(xe?"Cannot be the same as the root node":"\u4e0d\u80fd\u4e0e\u6839\u8282\u70b9\u540c\u7ea7",3),void e.setState({gData:j()(e.backUpTreeData)});var c=null,l=null;!function e(t){if(t&&t.length)for(var n=0;n<t.length;n++){var a=t[n];if(a.value===o.value){if(t.length>1)if(n>0){var r=t[n-1],i=t[n+1];r&&(c=r.value),i&&(l=i.value)}else l=t[n+1].value;return}a.children&&a.children.length&&e(a.children)}}(r);var u={departmentParent:i.value,departmentToMove:o.value,departmentAfter:l,departmentBefore:c};n("moveUpdateSysDepartment",u).then(function(t){var n=t.success,a=(t.code,t.message);t.data;n||G.b.error(a,1.2,function(){e.loadTree()})})}}))),u.a.createElement(k.a.Content,{className:de.a.container},function(){var t={sysDepartmentList:[e.initSimpleData(e.gData)[e.endKey]],userType:"1",userStatus:"1"};t.sysDepartmentList&&(t.sysDepartmentList=function e(t){if(t)return t.filter(function(e){return e}).map(function(t){return Se({},t,{title:"",children:t.children&&t.children.length?e(t.children):t.children})})}(t.sysDepartmentList));var n=u.a.createElement(ke,K()({},e.props,{setMyQnnTable:e.setMyQnnTable,handle:e.handle,initialValues:t,endKey:e.endKey,gData:i}));return i&&i.length?n:u.a.createElement("div",null,u.a.createElement(E.a,{image:E.a.PRESENTED_IMAGE_SIMPLE}))}()))}}]),t}(l.Component),ke=function(e){function t(){var e,n,a,r;W()(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(r=te()(this,(e=ae()(t)).call.apply(e,[this].concat(i)))).qnnTable=void 0,r.rowKey=null===(n=window.contactsPage)||void 0===n?void 0:null===(a=n.antd)||void 0===a?void 0:a.rowKey,r.tableFirstRender=!0,r}return oe()(t,e),$()(t,[{key:"getConfig",value:function(e){var t=this,n={isInForm:!1,table:{width:70,dataIndex:"sort",title:"\u987a\u5e8f",fixed:"left",render:function(e,n){var a=n[t.rowKey];return u.a.createElement("div",{id:a,draggable:!0,onDragStart:function(e){return t.onDragStart(e,a)},onDrop:function(e){return t.onDrop(e,a)},onDragOver:function(e){e.preventDefault(),t.onDragOver(e,a)},onDragEnter:function(e){return t.onDragEnter(e,a)},onDragLeave:function(e){return t.onDragLeave(e,a)},onDragEnd:function(e){return t.onDropEnd(e)},className:de.a.drawBtn},u.a.createElement("span",{className:"undraggable"},u.a.createElement(le.a,null)))}}},a=this.props.loginAndLogoutInfo.loginInfo.userInfo.curCompany,r=(void 0===a?{}:a).departmentId,o={};r&&(o.topId=r);var i=function(e){return e.map(function(e){var t,n=e.table,a=void 0===n?{}:n,r=e.form,i=void 0===r?{}:r,s=a.dataIndex,c=i.treeSelectOption,l=void 0===c?{}:c,u={};"sysDepartmentShowList"===s&&(u.form=Se({},i,{treeSelectOption:Se({},l,{fetchConfig:Se({},null===l||void 0===l?void 0:l.fetchConfig,{params:Se({},null===l||void 0===l?void 0:null===(t=l.fetchConfig)||void 0===t?void 0:t.params,{},o)})})}));return Se({},e,{},u)})};return e.canDragSort?Se({},e,{formConfig:i([n].concat(j()(e.formConfig)))}):Se({},e,{formConfig:i(e.formConfig)})}},{key:"render",value:function(){var e=this,t=this.props.gData;return u.a.createElement("div",{className:de.a.nestedTable},u.a.createElement(ge.default,K()({drawerShowToggle:function(t){var n=t.drawerIsShow,a=t.state;if(n){var r=a.clickCb.rowInfo;if("add"===(void 0===r?{}:r).field){var o=e.props.initialValues.sysDepartmentList;setTimeout(function(){e.qnnTable.qnnForm.setValues({sysDepartmentList:o})},600)}}},fetch:this.props.myFetch,upload:this.props.myUpload,method:{listOtherParams:function(){var n,a,r={departmentId:e.props.endKey,rootId:null===t||void 0===t?void 0:null===(n=t[0])||void 0===n?void 0:n.value};e.tableFirstRender&&(r.departmentId=null===t||void 0===t?void 0:null===(a=t[0])||void 0===a?void 0:a.value);return e.tableFirstRender=!1,r},addOtherParams:function(){return{}},gender:function(e){switch(e){case"1":return"\u7537";case"2":return"\u5973";default:return e}},delByDiy:function(t){var n=t.selectedRows,a=e.props.myFetch,r=n,o=n.map(function(t){return t[e.rowKey]});if(o.length){var i=j()(o),s=i.map(function(e){for(var t="",n=0;n<r.length;n++){var a=r[n];if(a.userKey===e){t=a.realName;break}}return t}).join("\u3001");Ie({title:xe?"Are you sure you want to delete the following?":"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u4ee5\u4e0b\u4eba\u5458\u4e48?",content:xe?"".concat(s," total of ").concat(i.length):"".concat(s,"\uff0c\u5171\u8ba1").concat(i.length,"\u4eba"),okText:Ee.confirm,cancelText:Ee.cancel,onOk:function(){!function t(n){n.length?a("deleteSysUserInfoByBg",{userKey:n.pop()}).then(function(a){var r=a.success,o=(a.code,a.message);a.data,r?(t(n),n.length||e.qnnTable.qnnSetState({selectedRows:[]},e.qnnTable.refresh)):G.b.error(o,1.2)}):G.b.success(xe?"Deleted":"\u5220\u9664\u5b8c\u6bd5\uff01",1.2,function(){e.qnnTable.refresh()})}(i)}})}},sysDepartmentShowListRender:function(e){return e.join("<br />")},resetPwd:function(t){var n=t.selectedRows;if(n.length){var a=e.props.myFetch;Ie({title:"\u60a8\u786e\u5b9a\u8981\u91cd\u7f6e\u9009\u4e2d\u7684".concat(n.length,"\u4e2a\u8d26\u53f7\u7684\u5bc6\u7801\u5417?"),content:"",okText:"\u786e\u8ba4\u91cd\u7f6e",cancelText:"\u53d6\u6d88",onOk:function(){a("resetUserPwd",n.map(function(e){return{userKey:e.userKey}})).then(function(t){var n=t.success,a=t.message;n?(G.b.success(a),e.qnnTable.qnnSetState({selectedRows:[]})):G.b.error(a)})}})}else G.b.error("\u8bf7\u9009\u62e9\u9700\u8981\u91cd\u7f6e\u5bc6\u7801\u7684\u4eba\u5458\uff01")},unLock:function(t){var n=t.selectedRows,a=e.props.myFetch;Ie({title:xe?"You are sure to unlock the selected":"\u60a8\u786e\u5b9a\u8981\u89e3\u9501\u9009\u4e2d\u7684".concat(n.length,"\u4e2a\u8d26\u53f7\u5417?"),content:"",okText:Ee.confirm,cancelText:Ee.cancel,onOk:function(){e.setState({loading:!0}),a("unLock",n.map(function(e){return{userKey:e.userKey}})).then(function(t){var n=t.success,a=t.message;n?(G.b.success(a),e.qnnTable.qnnSetState({selectedRows:[]})):G.b.error(a)})}})}},wrappedComponentRef:function(t){t&&(e.props.setMyQnnTable(t),e.qnnTable=t)}},this.getConfig(Se({},window.contactsPage)))))}}]),t}(function(e){function t(){var e;W()(this,t);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return te()(this,(e=ae()(t)).call.apply(e,[this].concat(a)))}return oe()(t,e),$()(t,[{key:"addClass",value:function(e,t){var n,a,r=e.getAttribute("class");r="".concat(null===(n=r)||void 0===n?void 0:null===(a=n.replace)||void 0===a?void 0:a.call(n,t,"")," ").concat(t," "),e.setAttribute("class",r),e.className=r}},{key:"removeClass",value:function(e,t){var n,a,r=e.getAttribute("class");r=null===(n=r)||void 0===n?void 0:null===(a=n.replace)||void 0===a?void 0:a.call(n,new RegExp(t,"g"),""),e.setAttribute("class",r),e.className=r}},{key:"endEdSetStyle",value:function(e){var t=this,n=document.getElementById("".concat(this.dragDomId));this.removeClass(n,de.a.onDragStart),e&&(this.removeClass(e,de.a.beforeInsert),this.removeClass(e,de.a.afterInsert)),document.querySelectorAll(".".concat(de.a.onDragEnter)).forEach(function(e){return t.removeClass(e,de.a.onDragEnter)})}},{key:"onDragStart",value:function(e,t){e.stopPropagation(),e.dataTransfer.setData("rowId",t),this.addClass(e.target,de.a.onDragStart),this.dragDomId=t}},{key:"onDragOver",value:function(e){if(e.preventDefault(),e.stopPropagation(),e.target.id&&e.target.id!==this.dragDomId){this.addClass(e.target,de.a.onDragEnter);var t=e.target.offsetHeight,n=ye()(e.target).offset().top;this.startY||(this.startY=t/2+n),this.startY-e.clientY>0?(this.removeClass(e.target,de.a.afterInsert),this.addClass(e.target,de.a.beforeInsert),this.targetDir="before"):(this.removeClass(e.target,de.a.beforeInsert),this.addClass(e.target,de.a.afterInsert),this.targetDir="after")}}},{key:"onDragEnter",value:function(e){e.stopPropagation(),e.target.id&&e.target.id!==this.dragDomId&&this.addClass(e.target,de.a.onDragEnter)}},{key:"onDragLeave",value:function(e){e.stopPropagation(),this.removeClass(e.target,de.a.onDragEnter),this.startY=void 0,this.removeClass(e.target,de.a.beforeInsert),this.removeClass(e.target,de.a.afterInsert)}},{key:"onDrop",value:function(){var e=V()(U.a.mark(function e(t){var n,a,r,o,i,s,c,l,u,d,f,p,h,v,g,m,y,b,D,S,w=this;return U.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),t.stopPropagation(),this.endEdSetStyle(t.target),t.target.id===this.dragDomId){e.next=24;break}return c=(null===(n=this.qnnTable)||void 0===n?void 0:null===(a=n.state)||void 0===a?void 0:a.data)||[],l=null===c||void 0===c?void 0:c.length,u=this.dragDomId,d=t.target.id,f=this.targetDir,p=0,h=0,c.forEach(function(e,t){e[w.rowKey]===d&&(p=t),e[w.rowKey]===u&&(h=t)}),v=c[p]||{},c[h]||{},g={moveUserKey:u,afterUserKey:"before"===f?v[this.rowKey]:null===c||void 0===c?void 0:null===(r=c[p+1])||void 0===r?void 0:r[this.rowKey],beforeUserKey:"before"===f?p-1>=0?null===c||void 0===c?void 0:null===(o=c[p-1])||void 0===o?void 0:o[this.rowKey]:null:v[this.rowKey],firstUserKey:null===(i=c[0])||void 0===i?void 0:i[this.rowKey],lastUserKey:null===(s=c[l-1])||void 0===s?void 0:s[this.rowKey],departmentId:this.props.endKey},G.b.loading("loading...",0),e.next=18,this.props.myFetch("moveUpdateSysUser",g);case 18:m=e.sent,y=m.success,b=m.code,D=m.message,G.b.destroy(),y?null===(S=this.qnnTable)||void 0===S||S.refresh():"-1"===b?x.a.error({message:"\u7cfb\u7edf\u9047\u5230\u95ee\u9898\uff0c\u8bf7\u8054\u7cfb\u8fd0\u7ef4\u4eba\u5458",description:D,duration:3}):x.a.warn({message:"\u63d0\u793a",description:D,duration:3});case 24:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onDropEnd",value:function(e){this.endEdSetStyle(e.target)}}]),t}(l.Component)),Ce=Ke,Te=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return u.a.createElement(Ce,Object(a.a)({removeTreeNodeRightMenu:!0},this.props))}}]),t}(l.Component);t.default=Te},"fy/o":function(e,t,n){var a=n("SUQI"),r=n("8NlM"),o=n("Y/+/")("species");e.exports=function(e){var t;return r(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!r(t.prototype)||(t=void 0),a(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},gDZo:function(e,t,n){"use strict";var a=n("6NPa"),r=n("iZ+U");e.exports=n("YCk7")("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return a.def(r(this,"Set"),e=0===e?0:e,e)}},a)},i8BR:function(e,t,n){var a=n("fy/o");e.exports=function(e,t){return new(a(e))(t)}},"iZ+U":function(e,t,n){var a=n("SUQI");e.exports=function(e,t){if(!a(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},qyJ1:function(e,t,n){var a=n("FUgW"),r=n("3KqC");e.exports=function(e){return function(){if(a(this)!=e)throw TypeError(e+"#toJSON isn't generic");return r(this)}}},v0tr:function(e,t,n){var a=n("NhKq");a(a.P+a.R,"Set",{toJSON:n("qyJ1")("Set")})}}]);