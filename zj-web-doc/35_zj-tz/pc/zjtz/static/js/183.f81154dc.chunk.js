(window.webpackJsonp=window.webpackJsonp||[]).push([[183],{YlrR:function(e,n,t){"use strict";t.r(n);var a=t("fbSu"),r=t.n(a),d=t("5T12"),i=t.n(d),o=t("qHWA"),c=t.n(o),l=t("rx6U"),s=t.n(l),f=t("4tJN"),u=t.n(f),h=t("Qsbb"),p=t.n(h),b=(t("9U97"),t("kO4A"),t("+kFb"),t("FMw2"),t("S6uq"),t("Z5ek"),t("jnfO"),t("QifN"),t("Id6h"),t("Wv3C")),m=t.n(b),v=t("qQuN"),w=t.n(v),g=t("EByn"),I=t.n(g),C=t("isxb"),y=t.n(C),T=t("wJ7t"),D=t.n(T),k=t("rD0L"),F=t.n(k),x=t("bj0d"),R=t.n(x),N=t("i2ZC"),S=t.n(N),q=t("r0ML"),K=t.n(q),E=t("+Wf6");function P(e,n){var t=p()(e);if(u.a){var a=u()(e);n&&(a=a.filter(function(n){return s()(e,n).enumerable})),t.push.apply(t,a)}return t}function L(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?P(Object(t),!0).forEach(function(n){w()(e,n,t[n])}):c.a?i()(e,c()(t)):P(Object(t)).forEach(function(n){r()(e,n,s()(t,n))})}return e}var O=function(e){function n(){var e,t;y()(this,n);for(var a=arguments.length,r=new Array(a),d=0;d<a;d++)r[d]=arguments[d];return(t=F()(this,(e=R()(n)).call.apply(e,[this].concat(r)))).state={isNeedClassifyData:!1},t}return S()(n,e),D()(n,[{key:"render",value:function(){var e,n,t,a=window.configs.language,r=void 0===a?"zh_CN":a,d=this.props.loginAndLogoutInfo.loginInfo.userInfo.curCompany,i=(void 0===d?{}:d).departmentId;return K.a.createElement("div",null,K.a.createElement(E.default,m()({language:r,fetch:this.props.myFetch,method:{expandChild:function(e){if(e.qnnTableInstance){var n=(c=e.btnCallbackFn).getExpandedRowsKey(),t=c.fetchByCb,a=c.expandNode,r=c.msg,d=e.rowData,i=c.getVTableData(),o=d.departmentId;if(n.includes(o))return void a(o,"close");r.loading("loading..."),t("getSysDepartmentListByCondition",{departmentParentId:o},function(e){r.destroy();var n=e.success,t=e.data,d=e.message;if(t.length)if(n){i=function e(n){for(var a=0;a<n.length;a++)n[a].departmentId===o?n[a].children=t:n[a].children&&(n[a].children=e(n[a].children));return n}(i),c.setTableData(i),a(o,"expand")}else r.error(d);else r.info("\u8be5\u8282\u70b9\u6ca1\u6709\u5b50\u96c6\u6570\u636e")})}else{t=(c=e.btnCallbackFn).fetch;var c,l=c.setState,s=(r=c.msg,d=e.rowData,i=e.state.data,e.state.expandedRowKeys);o=d.departmentId;if(d.children&&d.children.length){if(s.includes(o)){var f=s.indexOf(o);s.splice(f,1),l({expandedRowKeys:[]},function(){l({expandedRowKeys:s})})}else s.push(o),l({expandedRowKeys:[]},function(){l({expandedRowKeys:s})});return}r.loading("loading..."),t("getSysDepartmentListByCondition",{departmentParentId:o},function(e){r.destroy();var n=e.success,t=e.data,a=e.message;if(t.length)if(n){i=function e(n){for(var a=0;a<n.length;a++)n[a].departmentId===o?n[a].children=t:n[a].children&&(n[a].children=e(n[a].children));return n}(i),s.includes(o)||s.push(o),l({expandedRowKeys:[],data:i},function(){l({expandedRowKeys:s})})}else r.error(a);else r.info("\u8be5\u8282\u70b9\u6ca1\u6709\u5b50\u96c6\u6570\u636e")})}},addChildCb:function(e){if(e.qnnTableInstance){var n=e.btnCallbackFn,t=e.rowData,a=n.getTableData(),r=n.getExpandedRowsKey(),d=t.departmentId;if(e.response.success)a=(i=function(n,t){for(var a=[],r=0;r<n.length;r++){var o=n[r];if(n[r].departmentId===d){n[r].children||(o.children=[]);var c=e.response.data;o.children.push(c)}else n[r].children&&(o.children=i(n[r].children,t+1));a.push(o)}return a})([].concat(I()(a)),1),r.includes(d)&&n.setTableData(a)}else{var i,o=(n=e.btnCallbackFn).setState,c=(t=e.rowData,a=[].concat(I()(e.state.data)),e.state.expandedRowKeys);d=t.departmentId;if(e.response.success)a=(i=function(n){for(var t=[],a=0;a<n.length;a++){var r=L({},n[a]);n[a].departmentId===d?(n[a].children||(r.children=[]),r.children.push(e.response.data)):n[a].children&&(r.children=i(n[a].children)),t.push(r)}return t})(I()(a)),c.includes(d)&&o({data:a})}},editChildCb:function(e){if(e.qnnTableInstance){var n=e.btnCallbackFn,t=e.rowData,a=n.getVTableData(),r=t.departmentId;if(e.response.success)a=(d=function(n){for(var t=[],a=0;a<n.length;a++){var i=n[a];if(n[a].departmentId===r){var o=e.response.data;for(var c in o)i[c]=o[c]}else n[a].children&&(i.children=d(n[a].children));t.push(i)}return t})(I()(a)),n.setTableData(a)}else{var d,i=(n=e.btnCallbackFn).setState;t=e.rowData,a=[].concat(I()(e.state.data)),r=t.departmentId;if(e.response.success)i({data:a=(d=function(n){for(var t=[],a=0;a<n.length;a++){var i=L({},n[a]);n[a].departmentId===r?i=L({},i,{},e.response.data,{children:i.children}):n[a].children&&(i.children=d(n[a].children)),t.push(i)}return t})(I()(a))})}},delCb:function(e){var n=e.btnCallbackFn,t=n.setState,a=e.selectedRows.map(function(e){return e.departmentId}),r=e.qnnTableInstance?n.getVTableData():[].concat(I()(e.state.data));if(e.response.success){r=function e(n){if(n){var t=I()(n).filter(function(e){return!a.includes(e.departmentId)});return t.forEach(function(n){n.children&&(n.children=e(n.children))}),t}return[]}(I()(r)),e.qnnTableInstance?n.setTableData(r):t({data:r})}},drawerShowToggle:function(e){e.drawerIsShow&&"add"!==e.state.clickCb.rowInfo.field?setTimeout(function(){var n=[].concat(I()(e.state.data)),t=e.state.clickCb.rowData,a={};!function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n&&n.forEach(function(n){if(n){if(n.departmentId===t.departmentId)return void(a=r);n.children&&e(n.children,n)}})}(I()(n)),e.btnCallbackFn.qnnForm.form.setFieldsValue({departmentParentId:a.departmentId,deparentParentName:a.departmentName,companyName:a.companyName})},500):e.drawerIsShow&&"add"===e.state.clickCb.rowInfo.field&&setTimeout(function(){e.btnCallbackFn.qnnForm.form.setFieldsValue({departmentParentId:"9999999999",deparentParentName:"\u9876\u5c42\u8282\u70b9"})},500)},operationDisabled:function(e,n){var t=e.btnCallbackFn,a=e.rowData,r=void 0===a?{}:a,d=n[0],i=n[1],o=n[2],c=t.msg,l=r[d]!==i&&r[d]!==o;return l||c.info("\u8be5\u8282\u70b9\u7c7b\u578b\u4e0d\u53ef\u8fdb\u884c\u64cd\u4f5c\uff01"),l}}},window.contactsTreeTable,{fetchConfig:L({},null===(e=window.contactsTreeTable)||void 0===e?void 0:e.fetchConfig,{otherParams:L({},null===(n=window.contactsTreeTable)||void 0===n?void 0:null===(t=n.fetchConfig)||void 0===t?void 0:t.otherParams,{topId:i})})})))}}]),n}(q.Component);n.default=O}}]);